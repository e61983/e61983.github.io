[{"content":"å‰è¨€ æœƒæœ‰é€™ä¸€ç¯‡çš„èª•ç”Ÿæ˜¯å› ç‚ºåŸæœ¬åœ¨å¯« gRPC çš„ç­†è¨˜æ™‚ç™¼ç¾ç¯‡å¹…å¤ªé•·ï¼Œæƒ³é‚„æ˜¯é–‹å¯«å¥½äº†ã€‚æ–¼æ˜¯ä¹é€™ä¸€ç¯‡å°±å‡ºç¾äº†ã€‚\næˆ‘å€‘æœƒå…ˆå° Protocol Buffer çš„èªæ³•é€²è¡Œç­è§£ï¼Œæ¥è‘—æ’°å¯«ã€ä¸¦è½‰è­¯ä¸€å€‹ç¯„ä¾‹ï¼Œæœ€å¾Œå¯¦éš›çš„è·‘ä¸€å€‹ç¯„ç¨‹å¼ã€‚\nä¸»è¦å…§å®¹ Protocol Buffersï¼ˆç°¡ç¨±ï¼šProtoBufï¼‰æ˜¯ä¸€ç¨®é–‹æºè·¨å¹³å°çš„åºåˆ—åŒ–è³‡æ–™çµæ§‹çš„å”å®šã€‚å…¶å°æ–¼å„²å­˜è³‡æ–™æˆ–åœ¨ç¶²è·¯ä¸Šé€²è¡Œé€šè¨Šçš„ç¨‹å¼æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚é€™å€‹æ–¹æ³•åŒ…å«ä¸€å€‹ä»‹é¢æè¿°èªè¨€ï¼Œæè¿°ä¸€äº›è³‡æ–™çµæ§‹ï¼Œä¸¦æä¾›ç¨‹å¼å·¥å…·æ ¹æ“šé€™äº›æè¿°ç”¢ç”Ÿç¨‹å¼ç¢¼ï¼Œé€™äº›ä»£ç¢¼å°‡ç”¨ä¾†ç”Ÿæˆæˆ–è§£æä»£è¡¨é€™äº›è³‡æ–™çµæ§‹çš„ä½å…ƒçµ„æµã€‚\nè³‡æ–™ä¾†æº: https://zh.wikipedia.org/zh-tw/Protocol_Buffers\nè³‡æ–™å‹æ…‹ int / int32 / int64\nuint / uint32 / uint64\nbool\nfloat\ndouble\nbytes\nstring\nenum ( Enumeration )\nfirst defined enum value, which must be 0.\nmap\nany\ntimestamp / duration\nå¯ä»¥åƒè€ƒé€™è£¡\nè³‡æ–™æ¬„ä¿®é£¾å­— oneof required\nè¡¨ç¤ºè©²è³‡æ–™æ¬„æ˜¯å¿…è¦çš„ã€‚ optional\næŒ‡è©²è³‡æ–™æ¬„æ˜¯å¯é¸çš„ (0ç­†æˆ–1ç­†)ã€‚ repeated\næŒ‡è©²è³‡æ–™æ¬„æ˜¯å¯ä»¥æœ‰å¤šç­†çš„ã€‚ reserved ç¯„ä¾‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 syntax = \u0026#34;proto3\u0026#34;; option go_package = \u0026#34;foo.example.idv/protobuf/example\u0026#34;; import \u0026#34;google/protobuf/timestamp.proto\u0026#34;; message Employee { string name = 1; google.protobuf.Timestamp Birthday = 2; }; message Company { string name = 1; repeated Employee employees = 2; }; å®‰è£ Protocol Buffer ç·¨è­¯å™¨ 1 2 brew install protobuf go install google.golang.org/protobuf/cmd/protoc-gen-go@latest ç”¢ç”Ÿç›¸æ‡‰çš„ Go ç¨‹å¼ç¢¼ 1 2 3 protoc --go_out=. \\ --go_opt=paths=source_relative \\ protobuf/example/foo.proto å¦‚æœå‡ºç¾\nprotoc-gen-go: program not found or is not executable\né€™å€‹éŒ¯èª¤ï¼Œè«‹åŒå­¸å…ˆç¢ºèªä¸€ä¸‹ ~/go/bin æ˜¯å¦æœ‰åœ¨ä½ çš„ $PATH ä¸­ã€‚\nå¦‚æœæ²’æœ‰å°±æŠŠå®ƒåŠ é€²å»å§ï¼\nä½ å¯ä»¥\nexport PATH=$HOME/go/bin:$PATH\nçµæœ 1 2 ls foo.pb.go foo.proto å¯¦éš›ç”¨çœ‹çœ‹ æˆ‘å€‘ä¾†æ’°å¯«ä¸€æ”¯ç¨‹å¼ï¼Œå¯¦éš›çš„ä½¿ç”¨å‰›å‰›ç”¢ç”Ÿçš„ç¨‹å¼ç¢¼ã€‚\nå®ƒæœƒå»ºç«‹ä¸€å€‹ä½¿ç”¨ protobuf çµæ§‹çš„åºåˆ—åŒ–æª”æ¡ˆ fooã€‚\nä¸¦ä¸”å†å°‡å®ƒè®€å›ä¸¦é¡¯ç¤ºå‡ºä¾†ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 com := \u0026amp;example.Company{ Name: \u0026#34;FooBarBar\u0026#34;, Employees: []*example.Employee{ {Name:\u0026#34;Alice\u0026#34;}, {Name:\u0026#34;Bonny\u0026#34;}, {Name:\u0026#34;Candy\u0026#34;}, }, } out, err := proto.Marshal(com) if err != nil { log.Fatalln(\u0026#34;Failed to encode address book:\u0026#34;, err) } if err := ioutil.WriteFile(\u0026#34;foo\u0026#34;, out, 0644); err != nil { log.Fatalln(\u0026#34;Failed to write company:\u0026#34;, err) } in, err := ioutil.ReadFile(\u0026#34;foo\u0026#34;) if err != nil { log.Fatalln(\u0026#34;Error reading file:\u0026#34;, err) } com2 := \u0026amp;example.Company {} if err := proto.Unmarshal(in, com2); err != nil { log.Fatalln(\u0026#34;Failed to parse company:\u0026#34;, err) } å¯¦éš›ä¾†ä¸€é 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 mkdir -p test/protobuf/example cd test cat \u0026lt;\u0026lt; EOF \u0026gt; protobuf/example/foo.proto syntax = \u0026#34;proto3\u0026#34;; option go_package = \u0026#34;foo.example.idv/protobuf/example\u0026#34;; import \u0026#34;google/protobuf/timestamp.proto\u0026#34;; message Employee { string name = 1; google.protobuf.Timestamp Birthday = 2; }; message Company { string name = 1; repeated Employee employees = 2; }; EOF cat \u0026lt;\u0026lt; EOF \u0026gt; main.go package main import ( \u0026#34;fmt\u0026#34; \u0026#34;io/ioutil\u0026#34; \u0026#34;log\u0026#34; \u0026#34;foo.example.idv/protobuf/example\u0026#34; \u0026#34;google.golang.org/protobuf/proto\u0026#34; ) func main(){ com := \u0026amp;example.Company{ Name: \u0026#34;FooBarBar\u0026#34;, Employees: []*example.Employee{ {Name:\u0026#34;Alice\u0026#34;}, {Name:\u0026#34;Bonny\u0026#34;}, {Name:\u0026#34;Candy\u0026#34;}, }, } fmt.Println(\u0026#34;original\u0026#34;) fmt.Println(com) fmt.Println(\u0026#34;==============================\u0026#34;) out, err := proto.Marshal(com) if err != nil { log.Fatalln(\u0026#34;Failed to encode address book:\u0026#34;, err) } if err := ioutil.WriteFile(\u0026#34;foo\u0026#34;, out, 0644); err != nil { log.Fatalln(\u0026#34;Failed to write company:\u0026#34;, err) } in, err := ioutil.ReadFile(\u0026#34;foo\u0026#34;) if err != nil { log.Fatalln(\u0026#34;Error reading file:\u0026#34;, err) } com2 := \u0026amp;example.Company {} if err := proto.Unmarshal(in, com2); err != nil { log.Fatalln(\u0026#34;Failed to parse company:\u0026#34;, err) } fmt.Println(\u0026#34;read from file\u0026#34;) fmt.Println(com2) } EOF go mod init foo.example.idv go get google.golang.org/protobuf/proto protoc --go_out=. --go_opt=paths=source_relative protobuf/example/foo.proto go mod tidy clear go run main.go çµæœ 1 2 3 4 5 original name:\u0026#34;FooBarBar\u0026#34; employees:{name:\u0026#34;Alice\u0026#34;} employees:{name:\u0026#34;Bonny\u0026#34;} employees:{name:\u0026#34;Candy\u0026#34;} ============================== read from file name:\u0026#34;FooBarBar\u0026#34; employees:{name:\u0026#34;Alice\u0026#34;} employees:{name:\u0026#34;Bonny\u0026#34;} employees:{name:\u0026#34;Candy\u0026#34;} å°çµ æœ¬æ–‡çš„ä»‹ç´¹ååˆ†çš„ç°¡ç´„ï¼Œå¦‚æœæƒ³è¦ç­è§£æ›´å¤šå¯ä»¥åƒè€ƒå®˜æ–¹ç¶²ç«™çš„èªªæ˜ã€‚\nå¦‚æœå° protobuf å¯¦éš›çš„è³‡æ–™çµæ§‹æœ‰èˆˆè¶£ä¸ä»¿å¯ä»¥å°è‘—å®˜æ–¹æ–‡ä»¶ç ”ç©¶ä¸€ä¸‹ å¯¦éš›ä¾†ä¸€é æ‰€ç”¢ç”Ÿçš„ foo æª”æ¡ˆã€‚\nåƒè€ƒé€£çµ Protocol Buffer Basics: Go Protocol Buffer - Scalar Value Types Go Generated Code ","description":"","id":0,"section":"posts","tags":["go","protobuf"],"title":"åœ¨ Go ä¸­èˆ‡ Protobuf å…±èˆ ï¼Ÿï¼","uri":"https://e61983.github.io/2022-08-09-go-and-protobuf/"},{"content":"å‰è¨€ å‰ä¸€é™£å­æ¯å¤©ä¸‹ç­å¾ŒèŠ± 2 å€‹å°æ™‚è®€æ›¸ï¼Œçµ‚æ–¼é€šéäº†å‘¨ä¸‰çš„è€ƒè©¦ã€‚æœ¬æ–‡ä¸»è¦æœƒç°¡è¿°å®ƒæ˜¯ä»€éº¼ä»¥åŠè¦å¦‚ä½•æº–å‚™å®ƒï¼\nä¸»è¦å…§å®¹ ç­†è€…å ±åçš„æ˜¯æ†é€¸é€£çºŒ 5 å¤©ï¼Œæ¯å¤© 8 å°æ™‚é è·æ•™å­¸ã€‚\nä¸€é–‹å§‹å¾ˆå¤©çœŸçš„æƒ³åœ¨ä¸Šå®Œèª²å¾Œç›´æ¥å ±åéš”é€±çš„è€ƒè©¦ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½åœ¨ 10 å¤©å…§å–å¾—å®ƒã€‚ (( å¹´è¼•äººçµ‚ç©¶æ˜¯å¹´è¼•äºº ~\nCertificated Ethical Hacker (CEH) Certificated Ethical Hacker ( é“å¾·é§­å®¢èªè­‰ )ï¼Œä¸»è¦æ˜¯åœ¨æ–¼æ•™å°ã€ä»‹ç´¹ä¸€äº›é§­å®¢å¸¸ç”¨çš„å·¥å…·å’Œæ–¹æ³•ã€‚æ‰€è¬‚çŸ¥å·±çŸ¥å½¼ ç™¾æˆ°ä¸æ®†ï¼Œè—‰ç”±ç­è§£æ”»æ“Šæ–¹å¼ä»¥åŠåŸç†é€²è€Œé€²è¡Œç³»çµ±é˜²è­·ã€‚\nèª²ç¨‹ç¯„åœ Introduction to Ethical Hacking (ä»‹ç´¹ä½•è¬‚é“å¾·å…¥ä¾µ) Footprinting and Reconnaissance (è’é›†è››çµ²é¦¬è·¡èˆ‡ç¶²è·¯å‹˜æŸ¥) Scanning Networks (ç¶²è·¯æœå‹™èˆ‡å¼±é»æƒæ) Enumeration (åˆ—èˆ‰ç³»çµ±è³‡è¨Š) Vulnerability Analysis (å¼±é»åˆ†æ) System Hacking (å…¥ä¾µé›»è…¦ç³»çµ±) Malware Threats (æƒ¡æ„ç¨‹å¼å¨è„…) Sniffers (ç¶²è·¯ç›£è½èˆ‡æ”»æ“Š) Social Engineering (ç¤¾äº¤å·¥ç¨‹) Denial-of-Service (é˜»æ–·æœå‹™æ”»æ“Šèˆ‡å‚€å„¡ç¶²è·¯) Session Hijacking (é€£ç·šåŠ«æŒ) Evading IDS, Firewalls and Honeypots (è¦é¿å…¥ä¾µåµæ¸¬/é˜²ç«ç‰†èˆ‡èª˜æ•ç³»çµ±) Hacking Webservers (å…¥ä¾µç¶²ç«™) Hacking Web Application (å…¥ä¾µç¶²ç«™ç¨‹å¼) SQL Injection (è³‡æ–™éš±ç¢¼æ”»æ“Š) Hacking Wireless Network (å…¥ä¾µç„¡ç·šç¶²è·¯) Hacking Mobile Platforms (å…¥ä¾µè¡Œå‹•å¹³å°) IoT and OT Hacking(å…¥ä¾µç‰©è¯ç¶²èˆ‡å·¥æ§) Cloud Computing (é›²ç«¯é‹ç®—) Cryptography (å¯†ç¢¼å­¸) è€ƒè©¦é¡Œç›®çš„é¡å‹ 150 é“é¸æ“‡é¡Œä¸Šæ©Ÿè€ƒã€‚ é¡Œç›®å¤§å¤šæ˜¯è€ƒ:\næ”»æ“Šé¡å‹ / åŸç† / æ–¹å¼\nä¾‹:\nWhile performing online banking using a Web browser, a user receives an email that contains a link to an interesting Web site. When the user clicks on the link, another Web browser session starts and displays a video of cats playing a piano. The next business day, the user receives what looks like an email from his bank, indicating that his bank account has been accessed from a foreign country. The email asks the user to call his bank and verify the authorization of a funds transfer that took place. What Web browser-based security vulnerability was exploited to compromise the user?\nA. Clickjacking\nB. Cross-Site Request Forgery\nC. Cross-Site Scripting\nD. Web form input validation\né˜²ç¯„æ–¹å¼ / æ–¹æ³•\nä¾‹:\nSome clients of TPNQM SA were redirected to a malicious site when they tried to access the TPNQM main site. Bob, a system administrator at TPNQM SA, found that they were victims of DNS Cache Poisoning.\nWhat should Bob recommend to deal with such a threat?\nA. The use of security agents in clients\u0026rsquo; computers\nB. The use of double-factor authentication\nC. Client awareness\nD. The use of DNSSEC\nå·¥å…·è»Ÿé«”èˆ‡ä½¿ç”¨æ–¹å¼\nä¾‹:\nIf you want to only scan fewer ports than the default scan using Nmap tool, which option would you use?\nA. -n\nB. -F\nC. -O\nD. -sT\né€šè¨Šå”å®šèˆ‡å…¶å®ƒèƒŒç§‘\nä¾‹:\nIdentify the UDP port that Network Time Protocol (NTP) uses as its primary means of communication?\nA. 131\nB. 3389\nC. 123\nD. 160\nå ±åè€ƒå¼ ç­†è€…åœ¨ä¸Šå®Œèª²ä¹‹å¾Œï¼Œç«‹é¦¬è©¢å•äº†è¦å¦‚ä½•å ±åè€ƒè©¦ã€‚æ‰çŸ¥é“è€ƒè©¦éœ€è¦æå‰ 5 å¤©é€²è¡Œã€‚æ‰€ä»¥å ±åäº†å¾Œé¢çš„æ¢¯æ¬¡ã€‚\nè€ƒè©¦å ±åé€£çµ\nExam è·Ÿ ASPEN çš„ä¿¡ç®±ä¸ä¸€æ¨£ ï¼Ÿï¼ ä¸Šèª²çš„æ™‚å€™æœƒåœ¨ ASPEN ä¸Šå»ºç«‹å¸³è™Ÿä¾†å–å¾—é›»å­æ•™æã€‚\nè€ƒè©¦çš„æ™‚å€™æœƒæ˜¯åœ¨ EC Council - Exam Center é€²è¡Œè€ƒè©¦ã€‚\nç•¶è€ƒè©¦å®Œé€šéä¹‹å¾Œè¦å–å¾—é›»å­è­‰æ›¸æ™‚ï¼Œé€™å…©å€‹å¹³å°æ˜¯èªæ³¨å†Šæ™‚çš„é›»å­ä¿¡ç®±çš„ã€‚\nå¦‚æœé€™å…©å€‹å¹³å°ä½¿ç”¨çš„ æ˜¯ä¸åŒä¿¡ç®±ï¼Œåœ¨ç™¼è­‰æ™‚æœƒè‡ªå‹•ç”¨ä½  Exam Center çš„ä¿¡ç®±å¹«ä½ åœ¨ ASPEN å»ºç«‹å¸³è™Ÿã€‚\nå¾ŒçºŒå°±å¯ä»¥ç”¨å¿˜è¨˜å¯†ç¢¼çš„æµç¨‹ä¾†è¨­å®šå¯†ç¢¼ã€‚\nä¸Šèª²æ™‚çš„å¸³è™Ÿ\nè€ƒéå¾Œè‡ªå‹•ç”¢ç”Ÿçš„å¸³è™Ÿ\nç§€ Time ä¸å…ä¿—çš„é‚„æ˜¯è¦ä¾†ç§€ä¸€ä¸‹è­‰æ›¸\nCEH è­‰æ›¸\nåœ¨å®˜æ–¹æä¾›çš„è­‰æ›¸é©—è­‰é é¢ä¾†è¼¸å…¥å§“åèˆ‡è­‰è™Ÿä¾†é©—è­‰å®ƒå¦æ˜¯ç‚ºæœ‰æ•ˆçš„è­‰æ›¸ã€‚\nå°çµ ç­†è€…æ˜¯åƒåŠ  06/06 ç‚ºæœŸ 5 å¤©çš„èª²ç¨‹ï¼Œä¸¦æ¯å¤©ä¸‹ç­å¾Œåˆ©ç”¨ 0.5 ~ 2 å°æ™‚é€²è¡Œæº–å‚™ã€‚\nä¸€é–‹å§‹ä¸»è¦æ˜¯ä»¥è¤‡ç¿’é›»å­æ•™æã€åœ¨ç·šä¸Š Lab ç’°å¢ƒä¸­é€²è¡Œæ•™æå…§çš„å¯¦é©—ã€‚\nåˆ°äº†å¾ŒæœŸæ”¹ä½¿ç”¨ç¶²è·¯ä¸Šå¯ç”¨çš„è€ƒå¤é¡Œè³‡æºï¼Œé€²è¡Œè€ƒé¡Œæº–å‚™ã€‚\nåœ¨ 07/09 åƒåŠ äº†ç¬¬ä¸€æ¬¡è€ƒè©¦ï¼Œçµæœæ²’æœ‰é€šéæ¸¬é©—ã€‚\næœ‰äº†å‰ä¸€æ¬¡è€ƒè©¦çš„ç¶“é©—ï¼Œå¤§è‡´ä¸Šæœ‰æ‰¾åˆ°æº–å‚™çš„æ–¹å‘ã€‚\næ–¼æ˜¯åœ¨ 08/03 åƒåŠ äº†ç¬¬äºŒæ¬¡è€ƒè©¦ï¼Œå–å¾—äº†é€™å¼µè­‰ç…§ã€‚\nå¦‚æœæœªä¾†æœ‰åŒå­¸ä¹Ÿæƒ³å–å¾—é€™å¼µè­‰ç…§çš„è©±ï¼Œæˆ–è¨±åœ¨ä¸Šå®Œèª²ä¹‹å¾Œå¯ä»¥å°ˆå¿ƒçš„åˆ·è€ƒå¤é¡Œã€‚\nå¹«åŠ©è »å¤§çš„ã€‚\nåƒè€ƒé€£çµ å®˜æ–¹ç¶²ç«™ EC Council - Exam Center ECCouncil 312-50v11 Exam ","description":"","id":1,"section":"posts","tags":["ceh","hacker"],"title":"Certificated Ethical Hacker (CEH) è€ƒè©¦å°è¨˜","uri":"https://e61983.github.io/2022-08-06-ceh-exam-v11/"},{"content":"å‰è¨€ æœ€è¿‘ç™¼ç¾å®¶ä¸­çš„ NAS é€Ÿåº¦ \u0026ldquo;å¥½åƒ\u0026rdquo; æ²’æœ‰é”åˆ°ç­†è€…çš„é æœŸã€‚æ‰€ä»¥æƒ³ä¾†å¯¦éš›æ¸¬çœ‹çœ‹å¯ä»¥ç›®å‰çš„ç¶²è·¯ç’°å¢ƒå¯ä»¥è·‘åˆ°ä»€éº¼ç¨‹åº¦ã€‚æ–¼ä¼¼ä¹é€™ä¸€ç¯‡å°±èª•ç”Ÿäº†ã€‚\nä¸»è¦å…§å®¹ æ¸¬è©¦çš„ NAS å‹è™Ÿç‚º: DS214ã€‚\nåœ¨ Synology NAS é‹è¡Œ iperf æœå‹™ å®‰è£ iperf3 1 2 3 4 ssh synology-nas sudo -i synogear install synogear list # æª¢è¦– iperf åŸ·è¡Œ 1 iperf3 -s è¼¸å‡º 1 2 3 4 (synogear) root@synology-nas:~# iperf3 -s ----------------------------------------------------------- Server listening on 5201 ----------------------------------------------------------- åœ¨ç›®æ¨™æ©Ÿå™¨ä¸ŠåŸ·è¡Œ iperf ç”¨æˆ¶ç«¯ç¨‹å¼ ç”±æ–¼ç­†è€…è¦æ¸¬çš„æ©Ÿå™¨æ˜¯ Macbook ï¼Œæ‰€ä»¥ä¸‹é¢å°±æ˜¯ä»¥å®ƒç‚ºä¸»ï¼\nå®‰è£ 1 brew install iperf3 åŸ·è¡Œ 1 iperf3 -c synology-nas è¼¸å‡º 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 iperf3 -c synology-nas 1 â†µ Connecting to host synology-nas, port 5201 [ 7] local 192.168.0.100 port 59650 connected to 192.168.0.101 port 5201 [ ID] Interval Transfer Bitrate [ 7] 0.00-1.00 sec 19.9 MBytes 167 Mbits/sec [ 7] 1.00-2.00 sec 29.1 MBytes 244 Mbits/sec [ 7] 2.00-3.00 sec 29.1 MBytes 244 Mbits/sec [ 7] 3.00-4.00 sec 28.3 MBytes 238 Mbits/sec [ 7] 4.00-5.00 sec 19.9 MBytes 167 Mbits/sec [ 7] 5.00-6.00 sec 22.0 MBytes 184 Mbits/sec [ 7] 6.00-7.00 sec 22.6 MBytes 189 Mbits/sec [ 7] 7.00-8.00 sec 20.0 MBytes 168 Mbits/sec [ 7] 8.00-9.00 sec 20.3 MBytes 171 Mbits/sec [ 7] 9.00-10.00 sec 20.8 MBytes 174 Mbits/sec - - - - - - - - - - - - - - - - - - - - - - - - - [ ID] Interval Transfer Bitrate [ 7] 0.00-10.00 sec 232 MBytes 195 Mbits/sec sender [ 7] 0.00-10.00 sec 232 MBytes 195 Mbits/sec receiver iperf Done. å°çµ å¥½çš„ã€‚æœç„¶æ²’æœ‰é”åˆ°é æœŸçš„é€Ÿåº¦ã€‚\nã¤ã¥ã\nåƒè€ƒé€£çµ Synology synogear å·¥å…·ç®± ","description":"","id":2,"section":"posts","tags":["synology","nas","iperf"],"title":"åœ¨ Synology NAS é–‹å•Ÿ iperf ä¼ºæœå™¨","uri":"https://e61983.github.io/2022-08-02-use-iperf-on-synology-nas/"},{"content":"å‰è¨€ æœ€è¿‘çµ‚æ–¼æœ‰æ™‚é–“æ•´è£¡ç­†è€…å®¶ä¸­çš„ NAS ã€‚å…ˆå‰ç­†è€…å·²ç¶“æ¶è¨­å¥½äº† Giteaï¼Œä½†ä¸€ç›´æ²’æœ‰æ™‚é–“æŠŠæ•´å€‹é–‹ç™¼ç’°å¢ƒä¸²èµ·ä¾†ã€‚é€™ç¯‡æ–‡ç« è¨˜éŒ„äº†å¦‚ä½•åœ¨ go ä¸­ä½¿ç”¨è‡ªæ¶çš„ Git Repositoryã€‚\nä¸»è¦å…§å®¹ ç”±æ–¼ç­†è€…æ‰€æ¶è¨­çš„ Gitea ä¸¦ä¸æ˜¯ä½¿ç”¨ http/https åŸ ä½œç‚ºç¶²ç«™æ‰€ä½¿ç”¨çš„åŸ ã€‚æ‰€ä»¥ç•¶åŸ·è¡Œ go get æ™‚æœƒç„¡æ³•æ­£å¸¸çš„å‹•ä½œã€‚\næ‰€ä»¥æœ¬æ–‡ä¸»è¦æƒ³è§£æ±ºçš„å•é¡Œæœ‰:\nè®“ go å¯ä»¥ä½¿ç”¨ç§æœ‰çš„ Git repository è®“ go å¯ä»¥å¾éæ¨™æº–çš„ http/https åŸ ä¸‹è¼‰ç¨‹å¼ç¢¼ã€‚ go get çš„é‹ä½œåŸç† å¾ [1] æˆ‘å€‘å¯ä»¥çŸ¥é“ï¼Œgo get åœ¨ä¸‹è¼‰ç¨‹å¼ç¢¼æ™‚æœ‰ä¸‰ç¨®åŒ¹é…æ–¹å¼ï¼Œä¾†æ±ºå®šè¦ä½¿ç”¨ä»€éº¼å·¥å…·ä¾†æŠ“å–ç¨‹å¼ç¢¼ã€‚\nprefix matching\nç›´æ¥æ¯”å°ç¶²å€ä½¿ç”¨å®šå¥½çš„å”å®šã€‚\nregular expression matching\næ¯”å°ç¶²å€çµå°¾æ˜¯å¦ç‚ºå·²çŸ¥çš„ç‰ˆæ§å”å®šã€‚\ndynamic matching\næœƒé€å‡º http/https è«‹æ±‚ï¼Œä¸¦åœ¨è¿”å›çš„ http ä¸­çš„ meta æ¨™ç°½é¸å®šè¦ç”¨çš„å”å®šã€‚\né™¤æ­¤ä¹‹å¤–\ngo get å®ƒé è¨­æœƒä½¿ç”¨ GOPROXY ä¾†åŠ å¿«ä¸‹è¼‰çš„é€Ÿåº¦ã€‚\næˆ‘å€‘å¯ä»¥é€éè¨­å®š GOPRIVATE ä¾†é¿å… go ä½¿ç”¨ proxy é€²è¡Œç¨‹å¼ç¢¼ä¸‹è¼‰ã€‚\n1 go env -w GOPRIVATE=\u0026#34;foo.example.idv/*\u0026#34; ç­–ç•¥ åœ¨å·²ç¶“çŸ¥é“ go get ä¸‹è¼‰ç¨‹å¼ç¢¼çš„æ–¹å¼å¾Œï¼Œç­†è€…æ±ºå®šå¾ regular expression matching ä¸‹æ‰‹ã€‚\nè®“æ¨¡çµ„åç¨±ä»¥ .git ä½œç‚ºçµå°¾ã€‚\ngit ä½¿ç”¨ insteadOf æ”¹å¯« url æˆ‘å€‘å¯ä»¥å° git é€²è¡Œè¨­å®šï¼Œä½¿å…¶æ”¹å¯«æˆ‘å€‘æŒ‡å®šçš„ urlã€‚\n1 git config --global url.\u0026#34;http://foo.example.idv:8080\u0026#34;.insteadof \u0026#34;http://foo.example.idv\u0026#34; æˆ–æ˜¯\n1 git config --global url.\u0026#34;ssh://foo.example.idv:\u0026#34;.insteadof \u0026#34;http://foo.example.idv\u0026#34; ç­–ç•¥ go get åº•å±¤ä¹Ÿæ˜¯ä½¿ç”¨ git é€²è¡Œä¾†å°ä½¿ç”¨ git é€²è¡Œç‰ˆæ§çš„ç¨‹å¼ç¢¼é€²è¡Œæ‡†ä½œã€‚\næ‰€ä»¥æˆ‘å€‘å°±å¯ä»¥å°å®ƒå‹•é»æ‰‹è…³ï¼Œä½¿å®ƒå¯ä»¥æŠ“å–é http/https åŸ çš„ç¨‹å¼ã€‚\næŒ‡å®š ssh æ‰€ä½¿ç”¨çš„ key å…¶å¯¦åˆ°äº†ä¸Šä¸€æ­¥æˆ‘å€‘å°±å·²ç¶“å¯ä»¥å¾æˆ‘å€‘çš„git repository æŠ“å–ç¨‹å¼ç¢¼äº†ã€‚\nä½†ç­†è€…æ¯”è¼ƒç¿’æ…£ä½¿ç”¨ ssh çš„å”å®šï¼Œæ‰€ä»¥æ‰æœƒæœ‰é€™ä¸€å€‹ç« ç¯€ã€‚\ngit ä½¿ç”¨ ssh å”å®šæŠ“å–ç¨‹å¼ç¢¼ï¼Œèµ°çš„æ˜¯ ssh å”å®š (( å»¢è©± ~~\næ‰€ä»¥æˆ‘å€‘å¯ä»¥ä½¿ç”¨ ssh config ä¾†é€²è¡Œè¨­å®šã€‚\n~/.ssh/config:\n1 2 3 4 5 6 Host foo.example.idv Hostname foo.example.idv Port 22 User git IdentitiesOnly yes IdentityFile ~/.ssh/id_rsa.pub æ»²åœ¨ä¸€èµ·åšæ’’å°¿ç‰›ä¸¸ 1 go env -w GOPRIVATE=\u0026#34;foo.example.idv/*\u0026#34; ~/.gitconfig\n1 2 [url \u0026#34;ssh://foo.example.idv:\u0026#34;] insteadOf = https://foo.example.idv ~/.ssh/config\n1 2 3 4 5 6 Host foo.example.idv Hostname foo.example.idv #192.168.1.100 Port 2234 User git IdentitiesOnly yes IdentityFile ~/.ssh/id_rsa.pub é–‹å§‹æ–°å°ˆæ¡ˆæ™‚\n1 go mod init foo.example.idv/foo.git å°çµ é›–ç„¶åœ¨å°ˆæ¡ˆä¸­éƒ½è¦ä»¥ .git ä½œç‚ºçµå°¾ï¼Œä½†é™¤äº†é€™é»ç›®å‰é‚„æ²’æœ‰é‡åˆ°å…¶å®ƒä¸æ–¹ä¾¿çš„åœ°æ–¹ã€‚\nå¦‚æœæœªä¾†æœ‰æ‰¾åˆ°æ›´å¥½çš„æ–¹æ³•ï¼Œä¹Ÿæœƒè·Ÿå¤§å®¶èªªçš„ï¼\nåƒè€ƒé€£çµ ç§æœ‰åŒ–ä»“åº“çš„ GO æ¨¡å—ä½¿ç”¨å®è·µ Go Moduleï¼šç§æœ‰ä¸åˆè§„åº“æ€ä¹ˆè§£å†³å¼•ç”¨é—®é¢˜ Go Modules è™•ç†ç§æœ‰ GIT Repository æµç¨‹ ","description":"","id":3,"section":"posts","tags":["go","git","ssh"],"title":"Go èªè¨€ä½¿ç”¨ç§æœ‰ Git Repository","uri":"https://e61983.github.io/2022-07-30-go-module-using-private-repository/"},{"content":"å‰è¨€ æœ€è¿‘å¯« Go æ™‚æƒ³å˜—è©¦ä½¿ç”¨å‹•æ…‹é€£çµå‡½å¼åº«ã€‚æ–¼æ˜¯ä¹é€™ä¸€ç¯‡å°±èª”ç”Ÿäº†ã€‚\næœ¬æ–‡æœƒè©¦è‘—ä½¿ç”¨ Go ç·¨å‡ºä¸€å€‹å‹•æ…‹é€£çµå‡½å¼åº«ï¼Œä¸¦ä½¿ç”¨ C èªè¨€ç¨‹å¼ä»¥åŠ Go èªè¨€ç¨‹å¼å‘¼å«å®ƒã€‚\nä¸»è¦å…§å®¹ å‹•æ…‹é€£çµå‡½å¼åº« å®˜æ–¹æ–‡ä»¶ä¸­æœ‰æåˆ°ï¼Œå¯ä»¥è¢«å‘¼å«çš„å‡½å¼è¦ä½¿ç”¨ export è¨»è§£ ä¾†æç¤º cgoã€‚\n-buildmode=c-shared\nBuild the listed main package, plus all packages it imports,\ninto a C shared library. The only callable symbols will\nbe those functions exported using a cgo //export comment.\nRequires exactly one main package to be listed.\nç¨‹å¼ç¢¼ (hello.go) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 package main import \u0026#34;C\u0026#34; //export hello func hello() { println(\u0026#34;Hello, world! Library\u0026#34;) } /* We need the main function to make possible cgo compiler to compile the package as c shared library. */ func main() {} ç·¨è­¯ 1 go build -buildmode=c-shared -o libhello.so hello.go çµæœ 1 libhello.h libhello.so C èªè¨€ç¨‹å¼ main.c\n1 2 3 4 5 6 7 8 #import \u0026lt;stdio.h\u0026gt; #import \u0026#34;libhello.h\u0026#34; int main(int argc, char *argv[]) { printf(\u0026#34;Hello world C !\\n\u0026#34;); hello(); return 0; } ç·¨è­¯ 1 gcc -o main_c.out -L. -I. -lhello main.c çµæœ 1 2 3 ./main_c.out Hello world C ! Hello, world! Library Go èªè¨€ç¨‹å¼ v1 main.go\n1 2 3 4 5 6 7 8 9 10 11 package main // #cgo LDFLAGS: -lhello -L. // #include \u0026lt;libhello.h\u0026gt; import \u0026#34;C\u0026#34; import \u0026#34;fmt\u0026#34; func main() { fmt.Println(\u0026#34;Hello world Go!\u0026#34;) C.hello() } ç·¨è­¯ 1 go build -o main_go.out main.go Go èªè¨€ç¨‹å¼ v2 main_dl.go\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 package main // #cgo LDFLAGS: -ldl // #include \u0026lt;dlfcn.h\u0026gt; import \u0026#34;C\u0026#34; import ( \u0026#34;fmt\u0026#34; \u0026#34;unsafe\u0026#34; ) // load dynamic library func load(path string) (unsafe.Pointer, error) { handle, err := C.dlopen(C.CString(path), C.RTLD_LAZY) if err != nil { return nil, err } return handle, nil } // get symbol func findSym(lib unsafe.Pointer, sym string) (unsafe.Pointer, error) { pc := C.dlsym(lib, C.CString(sym)) if pc == nil { return nil, fmt.Errorf(\u0026#34;find symbol %s failed\u0026#34;, sym) } return pc, nil } // unload dynamic library func unload(lib unsafe.Pointer) error { if C.dlclose(lib) != 0 { return fmt.Errorf(\u0026#34;unload library failed\u0026#34;) } return nil } // entry point function func main() { println(\u0026#34;Hello World\u0026#34;) lib, err := load(\u0026#34;./libhello.so\u0026#34;) if err != nil { panic(err) } defer unload(lib) addr, err := findSym(lib, \u0026#34;hello\u0026#34;) if err != nil { panic(err) } var hello func() p := \u0026amp;addr hello = *(*func())(unsafe.Pointer(\u0026amp;p)) hello() } ç·¨è­¯ 1 go build -o main_go_dl.out main_dl.go å°çµ åŸæœ¬ä¹Ÿæƒ³è©¦è©¦ Node.js çš„ä½¿ç”¨å‹•æ…‹é€£çµå‡½å¼åº«çš„éƒ¨ä»½ã€‚ä½†æ˜¯ç›¸é—œçš„å‡½å¼åº« ffi ä¸€ç›´ç„¡æ³•æ­£å¸¸çš„å®‰è£ï¼Œæœ€å¾Œå°±æ²’æœ‰å¾€ä¸‹æ¸¬äº†ã€‚\nåƒè€ƒé€£çµ go build mode Golangç”Ÿæˆå…±äº«åº«(shared library)ä»¥åŠGolangç”ŸæˆCå¯èª¿ç”¨çš„å‹•æ…‹åº«.soå’Œéœæ…‹åº«.a vladimirvivien/go-cshared-examples ","description":"","id":4,"section":"posts","tags":["go","c","library"],"title":"Goèªè¨€ã€å‹•æ…‹é€£çµå‡½å¼åº«èˆ‡å®ƒå€‘çš„ç”¢åœ°","uri":"https://e61983.github.io/2022-07-21-golang-with-shared-library/"},{"content":"å‰è¨€ æœ€è¿‘å‰›å¥½æœ‰æ©Ÿæœƒè¦å¯«æœ‰åœ–å½¢åŒ–ä»‹é¢çš„ç¨‹å¼ã€‚æƒ³ä¾†æƒ³å»æ„Ÿè¦ºå¯ä»¥å¯«å¯«çœ‹ Electronï¼æ–¼æ˜¯ä¹æœ¬ç¯‡å°±é€™æ¨£èª•ç”Ÿäº†ã€‚\nä¸»è¦å…§å®¹ å»ºç«‹ Vue å°ˆæ¡ˆ 1 2 3 4 yarn create vite test-001 --template vue cd test-001 yarn yarn dev åŠ å…¥è·¯å¾‘åˆ¥å æŠŠå°ˆæ¡ˆä¸­çš„ src åŠ ä¸Šåˆ¥å @ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 mv vite.config.js vite.config.cjs.bk cat \u0026lt;\u0026lt; EOF \u0026gt; vite.config.cjs import { defineConfig } from \u0026#39;vite\u0026#39; import Vue from \u0026#39;@vitejs/plugin-vue\u0026#39; import path from \u0026#39;path\u0026#39; // https://vitejs.dev/config/ export default defineConfig({ plugins: [ Vue(), ], resolve: { alias: { \u0026#39;@\u0026#39;: path.resolve(__dirname, \u0026#39;./src\u0026#39;), }, }, }) EOF å®‰è£åŠè¨­å®š Tailwindcss 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 yarn add -D tailwindcss postcss autoprefixer cat \u0026lt;\u0026lt; EOF \u0026gt; postcss.config.cjs module.exports = { plugins: { tailwindcss: {}, autoprefixer: {}, } } EOF cat \u0026lt;\u0026lt; EOF \u0026gt; tailwind.config.cjs module.exports = { content: [ \u0026#34;./index.html\u0026#34;, \u0026#34;./src/**/*.{vue,js,ts,jsx,tsx}\u0026#34;, ], theme: { extend: {}, }, plugins: [], } EOF mkdir -p src/styles cat \u0026lt;\u0026lt; EOF \u0026gt; src/styles/base.css @layer base { html, body, #app { @apply h-full w-full; } body, #app { @apply bg-[#333333]; @apply font-light; } } EOF cat \u0026lt;\u0026lt; EOF \u0026gt; src/styles/components.css @layer components { * { @apply outline outline-1 outline-red-500; } } EOF cat \u0026lt;\u0026lt;EOF \u0026gt; src/styles/index.css @import \u0026#34;tailwindcss/base\u0026#34;; @import \u0026#34;base.css\u0026#34;; @import \u0026#34;tailwindcss/components\u0026#34;; @import \u0026#34;components.css\u0026#34;; @import \u0026#34;tailwindcss/utilities\u0026#34;; EOF sed -i \u0026#34;3iimport \u0026#39;@/styles/index.css\u0026#39;\u0026#34; src/main.js sed -i \u0026#39;/\u0026lt;\\/template\u0026gt;/i \\ \\ \\\u0026lt;h1\\ class=\\\u0026#34;text-red-200\\\u0026#34;\\\u0026gt;Hello\\ world\\\u0026lt;\\/h1\\\u0026gt;\u0026#39; src/App.vue åŠ å…¥ Unplugin Icons 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 yarn add --dev unplugin-vue-components unplugin-icons @iconify/json mkdir -p src/components sed -i \u0026#34;4iimport Components from \u0026#39;unplugin-vue-components/vite\u0026#39;\u0026#34; vite.config.cjs sed -i \u0026#34;4iimport IconsResolver from \u0026#39;unplugin-icons/resolver\u0026#39;\u0026#34; vite.config.cjs sed -i \u0026#34;4iimport Icons from \u0026#39;unplugin-icons/vite\u0026#39;\u0026#34; vite.config.cjs sed -i \u0026#39;/plugins:/a \\ \\ \\ \\ \\ Components({\\ dirs: [\u0026#34;src/components\u0026#34;],\\ resolvers: [\\ IconsResolver({\\ prefix: false,\\ enabledCollections: [\u0026#34;mdi\u0026#34;],\\ })\\ ],\\ }),\\ Icons(),\u0026#39; vite.config.cjs sed -i \u0026#39;/\u0026lt;\\/template\u0026gt;/i \\ \\ \\\u0026lt;mdi-account-heart\\ \\/\\\u0026gt;\u0026#39; src/App.vue åŠ å…¥ Vue Router å’Œ vite-plugin-pages 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 yarn add vue-router@4 yarn add --dev vite-plugin-pages mkdir -p src/router cat \u0026lt;\u0026lt; EOF \u0026gt; src/router/index.js import { createRouter, createWebHistory, createWebHashHistory } from \u0026#34;vue-router\u0026#34;; import routes from \u0026#34;~pages\u0026#34;; const router = createRouter({ // refer to: https://nklayman.github.io/vue-cli-plugin-electron-builder/guide/commonIssues.html history: import.meta.env.PROD ? createWebHashHistory() : createWebHistory(import.meta.env.BASE_URL), routes, }); export default router; EOF mkdir -p src/pages sed -i \u0026#34;4iimport Pages from \u0026#39;vite-plugin-pages\u0026#39;\u0026#34; vite.config.cjs sed -i \u0026#39;/plugins:/a \\ \\ \\ \\ \\ Pages({\\ dirs: [\\ { dir: \u0026#34;src/pages\u0026#34;, baseRoute: \u0026#34;\u0026#34; },\\ ],\\ }),\u0026#39; vite.config.cjs sed -i \u0026#34;3iimport Router from \u0026#39;./router\u0026#39;\u0026#34; src/main.js sed -i \u0026#39;s/createApp(App)/createApp(App).use(Router)/\u0026#39; src/main.js cat \u0026lt;\u0026lt; EOF \u0026gt; src/App.vue \u0026lt;template\u0026gt; \u0026lt;div class=\u0026#34;w-full h-full p-1\u0026#34;\u0026gt; \u0026lt;RouterView\u0026gt;\u0026lt;/RouterView\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; EOF cat \u0026lt;\u0026lt; EOF \u0026gt; src/pages/index.vue \u0026lt;template\u0026gt; \u0026lt;div class=\u0026#34;flex w-full h-full rounded overflow-hidden\u0026#34;\u0026gt; \u0026lt;div :class=\u0026#34;[ \u0026#39;transition-all duration-500 ease-out\u0026#39;, \u0026#39;h-full w-0 lg:block lg:w-2/12 flex-shrink-0\u0026#39;, \u0026#39;max-w-xs\u0026#39; ]\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;flex h-full w-full\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;@/assets/vue.svg\u0026#34; class=\u0026#34;w-1/4\u0026#34; alt=\u0026#34;Vue logo\u0026#34; /\u0026gt; \u0026lt;div class=\u0026#34;flex flex-col\u0026#34;\u0026gt; \u0026lt;HelloWorld /\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/template\u0026gt; EOF å®‰è£åŠé…ç½® Electron 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 yarn add --dev electron concurrently wait-on cross-env electron-builder mkdir -p electron cat \u0026lt;\u0026lt; EOF \u0026gt; electron/main.cjs const { app, BrowserWindow } = require(\u0026#39;electron\u0026#39;) const path = require(\u0026#39;path\u0026#39;) const NODE_ENV = process.env.NODE_ENV function createWindow() { const mainWindow = new BrowserWindow({ width: 800, height: 600, show: false, autoHideMenuBar: true, webPreferences: { preload: path.join(__dirname, \u0026#39;preload.cjs\u0026#39;) } }) mainWindow.once(\u0026#39;ready-to-show\u0026#39;, () =\u0026gt; { mainWindow.show() }) mainWindow.loadURL( NODE_ENV === \u0026#39;development\u0026#39; ? \u0026#39;http://localhost:5173\u0026#39; : \\`file://\\${path.join(__dirname, \u0026#39;../dist/index.html\u0026#39;)}\\` ); if (NODE_ENV === \u0026#34;development\u0026#34;) { mainWindow.webContents.openDevTools() } } app.whenReady().then(() =\u0026gt; { createWindow() app.on(\u0026#39;activate\u0026#39;, function () { if (BrowserWindow.getAllWindows().length === 0) createWindow() }) }) app.on(\u0026#39;window-all-closed\u0026#39;, function () { if (process.platform !== \u0026#39;darwin\u0026#39;) app.quit() }) EOF cat \u0026lt;\u0026lt; EOF \u0026gt; electron/preload.cjs window.addEventListener(\u0026#39;DOMContentLoaded\u0026#39;, () =\u0026gt; { const replaceText = (selector, text) =\u0026gt; { const element = document.getElementById(selector) if (element) element.innerText = text } for (const dependency of [\u0026#39;chrome\u0026#39;, \u0026#39;node\u0026#39;, \u0026#39;electron\u0026#39;]) { replaceText(\\`\\${dependency}-version\\`, process.versions[dependency]) } }) EOF sed -i \u0026#39;/export default/a \\ \\ \\ \\ base: \u0026#34;./\u0026#34;,\u0026#39; vite.config.cjs sed -i \u0026#39;/version/a \u0026#34;main\u0026#34;: \u0026#34;electron/main.cjs\u0026#34;,\u0026#39; package.json sed -i \u0026#39;/\u0026#34;build/a \u0026#34;electron\u0026#34;: \u0026#34;wait-on tcp:5173 \u0026amp;\u0026amp; cross-env NODE_ENV=development electron .\u0026#34;,\u0026#39; package.json sed -i \u0026#39;/\u0026#34;build\u0026#34;:/a \u0026#34;electron:serve\u0026#34;: \u0026#34;concurrently -k \\\\\\\u0026#34;yarn dev\\\\\\\u0026#34; \\\\\\\u0026#34;yarn electron\\\\\\\u0026#34;\\\u0026#34;,\u0026#39; package.json sed -i \u0026#39;/\u0026#34;build\u0026#34;:/a \u0026#34;electron:build\u0026#34;: \u0026#34;vite build \u0026amp;\u0026amp; electron-builder\u0026#34;,\u0026#39; package.json sed -i \u0026#39;$d\u0026#39; package.json \u0026amp;\u0026amp; sed -i \u0026#39;$d\u0026#39; package.json \u0026amp;\u0026amp; cat \u0026lt;\u0026lt; EOF \u0026gt;\u0026gt; package.json }, \u0026#34;build\u0026#34;: { \u0026#34;appId\u0026#34;: \u0026#34;com.my-website.my-app\u0026#34;, \u0026#34;productName\u0026#34;: \u0026#34;MyApp\u0026#34;, \u0026#34;copyright\u0026#34;: \u0026#34;Copyright Â© 2022 Yuan\u0026#34;, \u0026#34;mac\u0026#34;: { \u0026#34;category\u0026#34;: \u0026#34;public.app-category.utilities\u0026#34; }, \u0026#34;nsis\u0026#34;: { \u0026#34;oneClick\u0026#34;: false, \u0026#34;allowToChangeInstallationDirectory\u0026#34;: true }, \u0026#34;files\u0026#34;: [ \u0026#34;dist/**/*\u0026#34;, \u0026#34;electron/**/*\u0026#34; ], \u0026#34;directories\u0026#34;: { \u0026#34;buildResources\u0026#34;: \u0026#34;assets\u0026#34;, \u0026#34;output\u0026#34;: \u0026#34;dist_electron\u0026#34; } } } EOF yarn electron:serve ä¿®æ­£å®‰å…¨æç¤ºä¸­çš„ 1 sed -i \u0026#39;/\u0026lt;meta name/a \\ \\ \\ \\ \\\u0026lt;meta http-equiv=\u0026#34;Content-Security-Policy\u0026#34; content=\u0026#34;script-src \u0026#39;\\\u0026#39;\u0026#39;self\u0026#39;\\\u0026#39;\u0026#39;\u0026#34; /\\\u0026gt;\u0026#39; index.html Add Makefile ç‚ºäº†ä¸ç”¨æ¯æ¬¡ç·¨è­¯æ™‚è¦ä¸‹ä»€éº¼æŒ‡ä»¤ï¼Œæ‰€ä»¥å¯«å€‹ Makefile çœå¿ƒ ~\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 TAB=\u0026#34;$(printf \u0026#39;\\t\u0026#39;)\u0026#34; cat \u0026lt;\u0026lt; EOF \u0026gt; Makefile all: run build: ${TAB}yarn electron:build .PHONY: web web: ${TAB}yarn dev .PHONY: run run: ${TAB}yarn electron:serve .PHONY: clean clean: ${TAB}\\$(RM) -r dist dist_electron EOF é¡å¤–è¨˜ä¸‹ä¾†çš„ é †æ‰‹è¨˜ä¸‹é€™æ¬¡æœ‰ç”¨åˆ°çš„ä¸€äº›æ±è¥¿ã€‚\nä½¿ç”¨ Axios 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 yarn add axios mkdir -p src/composables echo \u0026lt;\u0026lt; EOF \u0026gt; src/composables/useApi.js import axios from \u0026#39;axios\u0026#39;; const instance = axios.create({ baseURL: \u0026#39;http://localhost:8088/\u0026#39;, timeout: 1000, headers: { \u0026#34;Content-Type\u0026#34;: \u0026#34;application/json\u0026#34;, } }); const useAxios = ({url, method, arg}) =\u0026gt; { return instance[method](url, arg) } export default useAxios; EOF Electron å»ºç«‹è¦–çª—å¾Œåœ¨èƒŒæ™¯åšé»äº‹ 1 2 3 4 5 6 7 app.on(\u0026#39;ready\u0026#39;, async () =\u0026gt; { const { execFile } = require(\u0026#39;child_process\u0026#39;) execFile(\u0026#39;./resources/server/CCSNoteServer.exe\u0026#39;) createWindow() }) const { ipcRenderer } = require(\u0026#39;electron\u0026#39;) å°çµ ç­†éƒ½åœ¨é€™ä¸€ç¯‡å¿«è¦å®Œæˆçš„æ™‚å€™æ›´æ–°äº† vite çš„ç‰ˆæœ¬ï¼Œå¾ vite 2.99 æ›´æ–°åˆ° 3.0.0ã€‚\næ¥ä¸‹ä¾†ä¸–ç•Œå°±è®Šäº† ğŸ¤£\nmigrate to ESM\nvite é è¨­ä½¿ç”¨çš„ Port å¾ 3000 æ”¹åˆ°äº† 5173ã€‚\ndev port\nä¿®æ­£å¾ŒåŸºæœ¬ä¸Šåªè¦æŠŠä¸Šé¢çš„æŒ‡ä»¤ç›´æ¥è²¼åœ¨çµ‚ç«¯æ©Ÿä¸­å°±å¯ä»¥äº†ã€‚\næœ€å¾Œé™„ä¸ŠåŸ·è¡Œçµæœï¼\n1 make screenshot\nåƒè€ƒé€£çµ Vite+Electronå¿«é€Ÿæ„å»ºä¸€ä¸ªVUE3æ¡Œé¢åº”ç”¨(ä¸€) [ä¸ªäººé¡¹ç›®] ç”¨ Electron + Vue3 + Golang åšä¸ªä¸€ä¸ªæ¡Œé¢ Markdown ç¬”è®°è½¯ä»¶ electron12èµ·ï¼Œå¦‚ä½•è§£å†³require is not definedçš„é—®é¢˜ï¼Ÿ cawa-93/vite-electron-builder ","description":"","id":5,"section":"posts","tags":["go","vue","electron"],"title":"ä½¿ç”¨ Vueã€Electron ä»¥åŠ Go å»ºç«‹ä¸€å€‹å°å·¥å…·","uri":"https://e61983.github.io/2022-07-15-how-to-use-vue-electron-and-go-to-build-an-app/"},{"content":"å‰è¨€ ç­†è€…å·²ç¶“ç¿’æ…£ vim çš„è¼¸å…¥æ¨¡å¼ã€‚æ‰€ä»¥åœ¨ä½¿ç”¨ VS Code æ™‚ï¼Œæœƒå®‰è£ vim è¼¸å…¥æ¨¡å¼çš„å¤–æ›ã€‚åœ¨éµç›¤æŒ‰éµæ¥ä½æ™‚ï¼ŒVS Code å»ä¸æœƒé€£çºŒè¼¸å…¥ã€‚æœ¬æ–‡ä¸»è¦å°±æ˜¯è¦ä¾†è§£æ±ºé€™å€‹å•é¡Œã€‚\nä¸»è¦å…§å®¹ è§£æ±ºæ–¹å¼ 1 defaults write com.microsoft.VSCode ApplePressAndHoldEnabled -bool false å¦‚æœè¦å¾©åŸçš„è©±ï¼Œå‰‡åªè¦æ”¹æˆ true å°±å¯ä»¥äº†ã€‚\ndefaults write com.microsoft.VSCode ApplePressAndHoldEnabled -bool true åƒè€ƒé€£çµ macOS é•¿æŒ‰è¿ç»­è¾“å…¥çš„ç®€å•è®¾ç½®æ–¹æ³• ","description":"","id":6,"section":"posts","tags":["VSCode","MacOS"],"title":"å¦‚ä½•è§£æ±ºåœ¨ MacOS VS Code æŒ‰éµç„¡æ³•é€£çºŒè¼¸å…¥çš„å•é¡Œ","uri":"https://e61983.github.io/2022-06-22-macos-hold-a-key-and-repeat-it-in-vscode/"},{"content":"å‰è¨€ ä¸€é–‹å§‹ç‚ºäº†æ”¶é›†ã€åˆ†æè³‡æ–™ï¼Œç­†è€…æŠŠæ‰€æœ‰çš„è¨˜éŒ„éƒ½ä¿å­˜èµ·ä¾†ã€‚éš¨è‘—å°ˆæ¡ˆçš„é€²è¡Œæˆ‘å€‘åªéœ€è¦ä¿ç•™ç‰¹å®šæ¢ä»¶çš„è¨˜éŒ„ã€‚æƒ³èªªå°±è¶è‘—é€™æ¬¡é †æ‰‹è¨˜éŒ„èµ·ä¾†å§ã€‚\nä¸»è¦å…§å®¹ ç™»å…¥è³‡æ–™åº« 1 psql -h myhost -d mydb -U myuser [-W] åˆ—å‡ºæ‰€æœ‰è³‡æ–™è¡¨ 1 postgres=# \\dt or\n1 2 3 4 5 SELECT * FROM pg_catalog.pg_tables WHERE 1 = 1 AND schemaname != \u0026#39;pg_catalog\u0026#39; AND schemaname != \u0026#39;information_schema\u0026#39;; é€éå»ºç«‹è‡¨æ™‚è¡¨ä¾†åˆªé™¤å¤§é‡è³‡æ–™ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 BEGIN; SET LOCAL temp_buffers = \u0026#39;1000MB\u0026#39;; -- copy surviving rows into temporary table CREATE TEMP TABLE tmp AS SELECT u.* FROM users u WHERE u.id IS NULL; -- empty table TRUNCATE users; -- insert back surviving rows INSERT INTO users TABLE tmp; COMMIT; å¦‚æœé€”ä¸­æœ‰å‡ºç¾éŒ¯èª¤ï¼Œå‰‡è¦ä½¿ç”¨ END; é€²è¡Œé€€å› (Rollback)ã€‚ åƒè€ƒé€£çµ Postgresql show tables Best way to delete millions of rows by id ","description":"","id":7,"section":"posts","tags":["postgresql"],"title":"å¦‚ä½•åœ¨ Postgresql è³‡æ–™åº«ä¸­çš„åˆªé™¤å¤§é‡è³‡æ–™","uri":"https://e61983.github.io/2022-06-20-postgresql-delete-large-data/"},{"content":"å‰è¨€ æœ€è¿‘å…¥æ‰‹äº†æ–°çš„ Unifi APï¼Œè¶é€™ä¸€æ¬¡è¨­å®šå°±é †æ‰‹è¨˜éŒ„èµ·ä¾†å§ã€‚\nä¸»è¦å…§å®¹ åŠ å…¥ Unifi æ§åˆ¶å™¨ ç™»å…¥ Unifi AP ssh -l ubnt ${UNIFI_AP_ADDRESS}\t# password: ubnt åœ¨ Unifi AP æ²’æœ‰å¾ DHCP å–å¾— IP ä¹‹å‰ï¼Œå®ƒçš„é è¨­ IP ç‚º 192.168.1.20ã€‚ æŒ‡å®šè¦åŠ å…¥çš„ Unifi æ§åˆ¶å™¨ set-inform http://${UNIFI_CONTROLLER_ADDRESS}:8080/inform åœ¨æ§åˆ¶å™¨ä¸­é»æ“Š [ Adpot ] å³å¯ã€‚\nè®Šæ›´ Unifi æ§åˆ¶å™¨ åœ¨ Unfi å®˜æ–¹çš„æ–‡ä»¶ä¸­æåˆ°ï¼Œæˆ‘å€‘å¯ä»¥é€é Unfi Network ä¾†å°‡ AP é‡ç½®ç‚ºå‡ºå» è¨­å®šã€‚\nAll UniFi devices can be restored via their respective web or mobile applications. This is located in the â€œManageâ€ section of a deviceâ€™s settings. Depending on the application, this may be referred to as â€œForgetâ€(UniFi Network) or â€œUnmanageâ€ (UniFi Protect).\næ¥è‘—å°±å¯ä»¥ç™»å…¥ä¸¦åŠ å…¥ Unifi æ§åˆ¶å™¨ [3] äº†ã€‚\nè£œå…… - æ¶è¨­ Unfi Controller æˆ‘å€‘å¯ä»¥ä½¿ç”¨ Docker è·Ÿ docker-compose ä¾†æ¶è¨­ Unfi Controllerã€‚\nversion: \u0026#34;2.1\u0026#34; services: unifi-controller: image: lscr.io/linuxserver/unifi-controller:version-7.1.66 container_name: unifi-controller environment: - PUID=1000 - PGID=1000 - MEM_LIMIT=1024 #optional - MEM_STARTUP=1024 #optional volumes: - ./config:/config ports: - 8443:8443 # Unifi web Admin port - 3478:3478/udp # Unifi STUN port - 10001:10001/udp # AP discovery - 8080:8080 # device communication - 1900:1900/udp #optional - 8843:8843 #optional - 8880:8880 #optional - 6789:6789 #optional - 5514:5514/udp #optional restart: unless-stopped åƒè€ƒé€£çµ UniFi - Problems with Device Adoption UniFi - How to Reset Devices to Factory Defaults linuxserver/unifi-controller ","description":"","id":8,"section":"posts","tags":["unifi"],"title":"å¦‚ä½•è¨­å®š Unifi AP","uri":"https://e61983.github.io/2022-05-29-how-to-setup-unifi-ap/"},{"content":"å‰è¨€ æœ€è¿‘åˆè¦é–‹å§‹æ¥è§¸åˆ°ç¶²é çš„æ±è¥¿äº†!\nä¹…æ²’æœ‰ç¢°è¦å†èŠ±ä¸€é»æ™‚é–“å›æƒ³ã€‚æƒ³èªªå°±è¶è‘—é€™æ¬¡é †æ‰‹è¨˜éŒ„èµ·ä¾†å§ã€‚\nä¸»è¦å…§å®¹ å¯«åœ¨å‰é¢ æœ¬ç¯‡æˆ‘å€‘æœƒé€é gin æ¡†æ¶å»ºç«‹ API ä¼ºæœå™¨ã€‚ä¸€é–‹å§‹æœƒå…ˆå»ºç«‹ä¸€å€‹æ¸¬è©¦ç”¨çš„ APIï¼Œæ¥è‘—åœ¨è©¦è‘—æä¾›ç¶²é æœå‹™å¾Œï¼›æˆ‘å€‘æœƒé–‹å§‹å»ºç«‹ç™»å…¥åŠŸèƒ½æ‰€éœ€çš„ API login ä»¥åŠ authã€‚\nlogin æœƒæª¢æŸ¥ç™»å…¥æ‰€ä½¿ç”¨çš„å¸³æˆ¶å¯†ç¢¼ï¼Œåœ¨é©—è­‰æ­£ç¢ºå¾Œæœƒçµ¦äºˆ Token æ–¼ Cookie ä¸­ã€‚ auth æœƒæª¢æŸ¥ Cookie æ˜¯å¦æœ‰åˆæ³•çš„ Token ã€‚ ç”±æ–¼æœ¬ç¯‡ä¸»è¦æ˜¯å°ˆæ³¨åœ¨ç¶²é å¾Œç«¯ã€Œå¦‚ä½•ä½¿ç”¨ gin æ¡†æ¶ã€ï¼Œæ‰€ä»¥æœ‰é—œ HTMLã€ JavaScript ã€CSS ä¸¦ä¸æœƒè‘—å¢¨å¤ªå¤šã€‚\nå»ºç«‹å°ˆæ¡ˆ 1 2 go mod init github.com/e61983/test-gin-login go get -u github.com/gin-gonic/gin èµ·æ‰‹å¼ å»ºç«‹æ¸¬è©¦ç”¨çš„ API - ping 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 cat \u0026lt;\u0026lt; EOF \u0026gt; main.go package main import ( \u0026#34;net/http\u0026#34; \u0026#34;github.com/gin-gonic/gin\u0026#34; ) func main() { r := gin.Default() r.GET(\u0026#34;/ping\u0026#34;, func(c *gin.Context) { c.JSON(http.StatusOK, gin.H{ \u0026#34;message\u0026#34;: \u0026#34;pong\u0026#34;, }) }) r.Run() } EOF ç¾åœ¨è®“æˆ‘å€‘å…ˆè·‘èµ·ä¾†çœ‹çœ‹!\n1 go run main.go ä¸¦åœ¨å¦ä¸€å€‹çµ‚ç«¯æ©Ÿä¸Šè©¦è‘—å­˜å–æˆ‘å€‘å»ºç«‹çš„ API ping\n1 2 3 4 curl -X GET http://localhost:8080/ping # Output: {\u0026#34;message\u0026#34;:\u0026#34;pong\u0026#34;}% æä¾›ç¶²é æœå‹™ ç°¡å–®çš„å»ºç«‹æ¸¬è©¦ç”¨çš„é é¢ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 mkdir -p webroot cat \u0026lt;\u0026lt; EOF \u0026gt; webroot/index.html \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta http-equiv=\u0026#34;X-UA-Compatible\u0026#34; content=\u0026#34;IE=edge\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Home Page\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;Home Page\u0026lt;/h1\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; EOF æ¥ä¸‹ä¾†é€éæä¾› LoadHTMLGlob() è¼‰å…¥æ–‡ä»¶å¤¾ä¸­çš„éœæ…‹é é¢ã€‚\n1 2 3 4 r.LoadHTMLGlob(\u0026#34;webroot/*\u0026#34;) r.GET(\u0026#34;/\u0026#34;, func(c *gin.Context) { c.HTML(http.StatusOK, \u0026#34;index.html\u0026#34;, gin.H{}) }) é‡æ–°é‹è¡Œå¾Œï¼Œä½¿ç”¨ç€è¦½å™¨è§€çœ‹åŸ·è¡Œçµæœ\næˆ‘å€‘çš„ç¬¬ä¸€å€‹ç•«é¢\nç™»å…¥ ( Login ) API åœ¨ä½¿ç”¨ gin çš„ç¶å®š (binding) åŠŸèƒ½æ™‚ï¼Œæˆ‘å€‘è¦åœ¨æƒ³è¦ç¶å®šçš„æ¬„ä½å¾Œé¢ï¼Œä¾ç…§æƒ³è¦ç¶å®šçš„æ–¹æ³•åŠ ä¸Š Struct Tagsã€‚\nä¹‹æˆ‘å€‘å°±å¯ä»¥ä½¿ç”¨ gin.Bind() æˆ–æ˜¯ gin.ShouldBind() ä¾†å–å¾—ç¶²é å‰ç«¯æ‰€å‚³è¼¸çš„è³‡æ–™ã€‚\næœ¬ç¯‡æ˜¯ç”¨ç›´æ¥æ¯”å°å¸³è™Ÿå¯†ç¢¼çš„æ–¹å¼å¯¦ä½œï¼ŒåŒå­¸åœ¨å¯¦å‹™ä¸Šä¸è¦é€™æ¨£å­¸å–”!\nåœ¨æª¢é©—å®Œä¹‹å¾Œï¼Œå°‡ Token è¨˜éŒ„æ–¼ Cookie ã€‚\nä¸éï¼Œç›®å‰å¸¸è¦‹é©—è­‰æ˜¯æ¡ JWT çš„é©—è­‰æ–¹å¼ï¼Œæ‰€ä»¥åŒå­¸ä¹Ÿè‡ªå·±ä¾†è©¦è‘—æ”¹å¯«çœ‹çœ‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 type User struct { Account string `json:\u0026#34;account\u0026#34; form:\u0026#34;account\u0026#34;` Password string `json:\u0026#34;password\u0026#34; form:\u0026#34;password\u0026#34;` } r.POST(\u0026#34;/login\u0026#34;, func(c *gin.Context) { /* ç¶å®šè³‡æ–™ */ u := \u0026amp;User{} if c.ShouldBind(\u0026amp;u) != nil { c.JSON(http.StatusOK, gin.H{\u0026#34;err\u0026#34;: 1}) return } /* æª¢æŸ¥å¸³è™Ÿå¯†ç¢¼ */ if u.Account != TEST_ACCOUNT || u.Password != TEST_PASSWORD { c.JSON(http.StatusOK, gin.H{\u0026#34;err\u0026#34;: 2}) return } /* å°‡ Token è¨˜éŒ„æ–¼ Cookie ä¸­ */ c.SetCookie(TOKEN_KEY, TEST_TOKEN, 3600, \u0026#34;/\u0026#34;, HOST, false, false) c.JSON(http.StatusOK, gin.H{}) }) é©—è­‰ ( Auth ) API æˆ‘å€‘å¯ä»¥å¾ç€è¦½å™¨ç™¼é€çš„è«‹æ±‚ä¸­å–å‡ºæˆ‘å€‘å…ˆå‰è¨˜éŒ„æ–¼ Cookie çš„ Token ã€‚\nä¸¦ä¸”æ¯”å°å®ƒæ˜¯å¦åˆæ³•ã€‚\n1 2 3 4 5 6 7 8 9 10 r.POST(\u0026#34;/auth\u0026#34;, func(c *gin.Context) { /* å¾ Cookie å–å‡º Token */ if token, err := c.Cookie(TOKEN_KEY); err != nil { if TEST_TOKEN != token { c.JSON(http.StatusOK, gin.H{\u0026#34;err\u0026#34;: 2}) return } } c.JSON(http.StatusOK, gin.H{\u0026#34;err\u0026#34;: nil}) }) å»ºç«‹ç™»å…¥è¡¨å–®èˆ‡ç™»å…¥å¾Œé¡¯ç¤ºç•«é¢ å»ºç«‹ç™»å…¥é é¢ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 cat \u0026lt;\u0026lt; EOF \u0026gt; webroot/login.html \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta http-equiv=\u0026#34;X-UA-Compatible\u0026#34; content=\u0026#34;IE=edge\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;assets/core.css\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Login Page\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;Login Page\u0026lt;/h1\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;form\u0026gt; \u0026lt;div class=\u0026#34;input-wrapper\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;title\u0026#34;\u0026gt;Login\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;label\u0026#34; for=\u0026#34;account\u0026#34;\u0026gt;Account:\u0026lt;/div\u0026gt; \u0026lt;input type=\u0026#34;text\u0026#34; id=\u0026#34;account\u0026#34; name=\u0026#34;account\u0026#34; value=\u0026#34;tester\u0026#34; /\u0026gt; \u0026lt;div class=\u0026#34;label\u0026#34; for=\u0026#34;password\u0026#34;\u0026gt;Password:\u0026lt;/div\u0026gt; \u0026lt;input type=\u0026#34;password\u0026#34; id=\u0026#34;password\u0026#34; name=\u0026#34;password\u0026#34; value=\u0026#34;test123\u0026#34; /\u0026gt; \u0026lt;button id=\u0026#34;btn\u0026#34; type=\u0026#34;button\u0026#34;\u0026gt; Submit \u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;script type=\u0026#34;module\u0026#34; \u0026gt; import {getData, postData, getCookie, deleteCookie} from \u0026#39;/javascript/core.js\u0026#39;; function login() { let account = document.getElementById(\u0026#34;account\u0026#34;).value; let password = document.getElementById(\u0026#34;password\u0026#34;).value; postData(\u0026#34;http://localhost:8080/login\u0026#34;, {\u0026#34;account\u0026#34;: account, \u0026#34;password\u0026#34;: password}) .then(data=\u0026gt;{ console.log(data.err) if (data.err !== null){ window.location.replace(\u0026#34;/\u0026#34;) }else{ window.location.replace(\u0026#34;/admin/\u0026#34;) } }); } function check(token) { postData(\u0026#34;http://localhost:8080/auth\u0026#34;, {\u0026#34;token\u0026#34;: token}) .then(data=\u0026gt;{ if (data.err === null){ window.location.replace(\u0026#34;/admin/\u0026#34;) } }); } check(getCookie(\u0026#34;token\u0026#34;)) window.onload = function(){ document.getElementById(\u0026#34;btn\u0026#34;).addEventListener(\u0026#34;click\u0026#34;, login); } \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; EOF æ”¹å¯«æ­¡è¿ç•«é¢\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 cat \u0026lt;\u0026lt; EOF \u0026gt; webroot/index.html \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;UTF-8\u0026#34;\u0026gt; \u0026lt;meta http-equiv=\u0026#34;X-UA-Compatible\u0026#34; content=\u0026#34;IE=edge\u0026#34;\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/assets/core.css\u0026#34;\u0026gt; \u0026lt;title\u0026gt;Home Page\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;h1\u0026gt;Home Page\u0026lt;/h1\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;input-wrapper\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;title\u0026#34;\u0026gt;Hello word\u0026lt;/div\u0026gt; \u0026lt;button id=\u0026#34;btn\u0026#34; type=\u0026#34;button\u0026#34;\u0026gt; Logout \u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;script type=\u0026#34;module\u0026#34; \u0026gt; import {getData, postData, getCookie, deleteCookie} from \u0026#39;/javascript/core.js\u0026#39;; function logout() { deleteCookie(\u0026#34;token\u0026#34;, \u0026#34;/\u0026#34;, \u0026#34;localhost\u0026#34;) window.location.replace(\u0026#34;/\u0026#34;) } window.onload = function(){ document.getElementById(\u0026#34;btn\u0026#34;).addEventListener(\u0026#39;click\u0026#39;, logout); } \u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; EOF ç•«å­˜å–æ¸…ç•Œç·š æˆ‘å€‘å‰é¢å»ºç«‹äº†å°‡è¦é¡¯ç¤ºçš„é é¢ï¼Œç¾åœ¨æˆ‘å€‘è¦ä¾†è¨­å®šå­˜å–çš„è·¯å¾‘ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 /* ç™»å…¥é é¢ */ r.GET(\u0026#34;/\u0026#34;, func(c *gin.Context) { c.HTML(http.StatusOK, \u0026#34;login.html\u0026#34;, nil) }) /* éœ€è¦ç™»å…¥æ‰èƒ½å­˜å–çš„é é¢ */ admin := r.Group(\u0026#34;/admin\u0026#34;) admin.GET(\u0026#34;/\u0026#34;, func(c *gin.Context) { if currentUser, ok := c.Get(\u0026#34;User\u0026#34;); ok { log.Printf(\u0026#34;User [ %s ] Accessed\u0026#34;, currentUser) } c.HTML(http.StatusOK, \u0026#34;index.html\u0026#34;, nil) }) å»ºç«‹ä¸­é–“å±¤ é›–ç„¶æˆ‘å€‘å·²ç¶“å»ºç«‹äº† /login èˆ‡ /admin/ é€™ 2 å€‹è·¯å¾‘ï¼Œä½†å¦‚æœæˆ‘å€‘ç›´æ¥åœ¨åŠ‰è¦½å™¨ä¸­è¼¸å…¥ http://localhost:8080/admin/ã€‚æœƒç™¼ç¾é‚„æ˜¯å¯ä»¥å­˜å–çš„ã€‚\nç‚ºäº†é¿å…é€™æ¨£çš„äº‹æƒ…ç™¼ç”Ÿï¼Œæˆ‘å€‘å¯ä»¥å»ºç«‹ä¸­é–“å±¤ä¾†æª¢æŸ¥æ˜¯å¦å·²ç™»å…¥ã€‚\nå¦‚æœç™¼ç¾å°šæœªç™»å…¥çš„å­˜å–è«‹æ±‚ï¼Œæˆ‘å€‘å°±å°‡å…¶è½‰è‡³ç™»å…¥ç•«é¢ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 func AuthMiddleware() gin.HandlerFunc { return func(c *gin.Context) { cookieToken, err := c.Cookie(TOKEN_KEY) if err != nil \u0026amp;\u0026amp; cookieToken != TEST_TOKEN { c.Redirect(http.StatusTemporaryRedirect, BASEURL) c.AbortWithStatus(http.StatusTemporaryRedirect) return } else { c.Set(\u0026#34;User\u0026#34;, TEST_ACCOUNT) c.Next() } } } ä½¿ç”¨ä¸­é–“å±¤ åœ¨æˆ‘å€‘å»ºç«‹å¥½çš„ admin è·¯ç”±ç¾¤çµ„ä¸­ï¼Œä½¿ç”¨æˆ‘å€‘å»ºç«‹å¥½çš„ä¸­é–“å±¤ã€‚å¦‚æ­¤ä¸€ä¾†ï¼Œè¦å­˜å–æ­¤è·¯ç”±ç¾¤çµ„çš„è«‹æ±‚å°±æœƒæª¢æŸ¥æ˜¯å¦å·²ç™»å…¥äº†ã€‚\n1 admin.Use(AuthMiddleware()) ç™»å…¥è¡¨å–®\nç™»å…¥å¾Œæ­¡è¿ç•«é¢\nå°çµ æœ¬ç¯‡çœç•¥äº†å¾ˆå¤šå¯¦ä½œä¸Šçš„ç´°ç¯€ï¼Œå°è¢«çœç•¥çš„éƒ¨ä»½æœ‰èˆˆè¶£çš„åŒå­¸å¯ä»¥åƒè€ƒé€™è£¡ã€‚\nåƒè€ƒé€£çµ gin-gonic/gin ","description":"","id":9,"section":"posts","tags":["go","gin","web backend","cookie"],"title":"ä½¿ç”¨ Gin æ¡†æ¶å¯¦ä½œç™»å…¥åŠŸèƒ½","uri":"https://e61983.github.io/2021-09-14-go-gin-web-backend/"},{"content":"å‰è¨€ ç‚ºäº†åœ¨ä¹‹å¾Œé–‹ç™¼éç¨‹ä¸­ä¸ç”¨åè¦†ç‡’å¯« eMMC èˆ‡ SD å¡ï¼Œæœ¬ç¯‡æœƒè¨­å®š U-Boot è¼‰å…¥ Rootfs ä»¥é”åˆ°æˆ‘å€‘çš„ç›®çš„ã€‚\nä¸»è¦å…§å®¹ å¯«åœ¨å‰é¢ æˆ‘å€‘é€™æ¬¡çš„ç›®æ¨™æ˜¯å¾ NFS ä¼ºæœå™¨ä¸­è¼‰å…¥ Rootfsã€‚æ‰€ä»¥æˆ‘å€‘åœ¨é–‹æ©Ÿæ™‚ï¼ŒU-Boot è¼‰å…¥çš„ Kernel èˆ‡è£ç½®æ¨¹ ( Devicetree ) ä»æ˜¯ eMMC/SD å¡å…§çš„ã€‚\nåœ¨é–‹æ©Ÿçš„éç¨‹ä¸­ï¼Œé¦–å…ˆæœƒè¦æŠŠè¦åŸ·è¡Œçš„æ±è¥¿è¼‰å…¥åˆ°è¨˜æ†¶é«”ä¸­åŸ·è¡Œã€‚\næ‰€ä»¥æˆ‘å€‘å¯ä»¥é æœŸï¼Œå¾…æœƒæˆ‘å€‘æœƒéœ€è¦è¼‰å…¥ Kernel èˆ‡ è£ç½®æ¨¹ã€‚\næœ€å¾Œæ‰æŠŠä¸»æ§æ¬Šäº¤çµ¦ Kernelã€‚\næˆ‘å€‘è¦åšçš„å°±æ˜¯åœ¨åŸ·è¡Œæ™‚æœŸï¼Œä¿®æ”¹ U-Boot å‚³çµ¦ Kernel çš„é–‹æ©Ÿåƒæ•¸ã€‚\né…ç½® NFS ä¼ºæœå™¨ é€™ä¸€å€‹éƒ¨ä»½å…ˆå‰æœ‰ç­†è¨˜éäº†ï¼Œå¦‚æœé‚„æ²’æœ‰çœ‹éçš„åŒå­¸è«‹åƒè€ƒé€™è£¡ã€‚\nåˆ†æ Kernel èˆ‡ Devicetree çš„è¼‰å…¥å‘½ä»¤ U-Boot é è¨­é–‹æ©Ÿåœ¨åŸºæœ¬çš„åˆå§‹åŒ–å®Œæˆå¾Œï¼Œä¸¦ä¸”åœ¨æŒ‡å®šçš„ç§’æ•¸å…§æ²’æœ‰éƒ½æ”¶åˆ°ä½¿ç”¨è€…çš„è¼¸å…¥ï¼Œä¾¿æœƒé–‹å§‹åŸ·è¡Œ bootcmd ä¸­çš„å…§å®¹ã€‚\næˆ‘å€‘å¯ä»¥è—‰ç”±åˆ†æå®ƒï¼Œä¾†åˆæ­¥çš„çŸ¥é“ç³»çµ±çš„é–‹æ©Ÿæµç¨‹ã€‚\n1 2 3 4 print bootcmd # Output: bootcmd=mmc dev ${mmcdev}; if mmc rescan; then if run loadbootscript; then run bootscript; else if test ${sec_boot} = yes; then if run loadcntr; then run mmcboot; else run netboot; fi; else if run loadimage; then run mmcboot; else run netboot; fi; fi; fi; else booti ${loadaddr} - ${fdt_addr}; fi æ•´ç†éå¾Œ, æˆ‘å€‘å¯ä»¥è§€å¯Ÿåˆ°å®ƒçœŸæ­£æœƒåŸ·è¡Œåˆ°çš„æŒ‡ä»¤ç‚º run loadimage ï¼Œæ¥è‘—æœƒæ˜¯ run mmcboot 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 bootcmd= mmc dev ${mmcdev}; if mmc rescan; then if run loadbootscript; then run bootscript; else if test ${sec_boot} = yes; then if run loadcntr; then run mmcboot; else run netboot; fi; else if run loadimage; then run mmcboot; else run netboot; fi; fi; fi; else booti ${loadaddr} - ${fdt_addr}; fi å¾ eMMC ä¸­æŠŠ Kernel è¼‰åˆ°è¨˜æ†¶é«”è£¡é¢\n1 loadimage=fatload mmc ${mmcdev}:${mmcpart} ${loadaddr} ${image} ç¹¼çºŒå±•é–‹ mmcboot\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 mmcboot= echo Booting from mmc ...; run mmcargs; if test ${sec_boot} = yes; then if run auth_os; then run boot_os; else echo ERR: failed to authenticate; fi; else if test ${boot_fdt} = yes || test ${boot_fdt} = try; then if run loadfdt; then run boot_os; else echo WARN: Cannot load the DT; fi; else echo wait for boot; fi; fi; å¾ eMMC ä¸­æŠŠ è£ç½®æ¨¹ ( Devicetree ) è¼‰åˆ°è¨˜æ†¶é«”è£¡é¢\n1 loadfdt=fatload mmc ${mmcdev}:${mmcpart} ${fdt_addr} ${fdt_file} é–‹å§‹è¼‰å…¥ Kernel ï¼Œä¹‹å¾Œå°±æœƒæŠŠæ§åˆ¶æ¬Šäº¤çµ¦ Kernel äº†ã€‚\n1 boot_os=booti ${loadaddr} - ${fdt_addr}; æˆ‘å€‘å¯ä»¥ä½¿ç”¨ echo $? ä¾†çœ‹è¿”å›å€¼ã€‚ è¨­å®š U-Boot ç’°å¢ƒè®Šæ•¸ å¾å…ˆå‰çš„åˆ†æä¾†çœ‹ï¼Œæ¯”è¼ƒé‡è¦çš„æŒ‡ä»¤æœ‰:\nloadfdt loadimage boot_os æ‰€ä»¥æˆ‘å€‘åªè¦é€²è¡Œä¸‹åˆ—ä¿®æ”¹ï¼Œå³å¯ã€‚\n1 2 3 4 5 6 7 8 9 10 setenv serverip \u0026#34;NFS_SERVER_IP\u0026#34; setenv rootfs_dir \u0026#34;/srv/rootfs\u0026#34; setenv ethaddr \u0026#34;01:02:03:04:05:06\u0026#34; setenv image Image setenv fdt_file imx8qxp-mek-rpmsg.dtb setenv rootfsinfo \u0026#39;setenv bootargs ${bootargs} root=/dev/nfs ip=dhcp nfsroot=${serverip}:${rootfs_dir},v3,tcp\u0026#39; setenv bootcmd \u0026#39;run rootfsinfo; run loadfdt; run loadimage; run boot_os\u0026#39; saveenv å¦‚æˆ‘å€‘æƒ³é‚„åŸå›é è¨­å€¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ—æŒ‡ä»¤\n1 2 env default -a saveenv çµæœ æˆ‘å€‘å¯ä»¥é‡æ–°å•Ÿå‹•ç³»çµ±ï¼Œæˆ–æ˜¯ç›´æ¥åŸ·è¡Œ boot å°±å¯ä»¥çœ‹åˆ° U-Boot æ­£åœ¨é–‹å§‹åŸ·è¡Œæˆ‘å€‘å‰›æ‰æ‰€æ’°å¯«çš„æŒ‡ä»¤äº†ã€‚\næœƒç™¼ç¾ï¼Œé–‹æ©Ÿçš„æ™‚å€™æœ‰ç¨å¾®è®Šé•·äº†ï¼Œä¸¦ä¸”åœ¨éç¨‹ä¸­å¯ä»¥çœ‹åˆ° NFS ç›¸é—œçš„å­—æ¨£ã€‚\né–‹æ©Ÿå®Œæˆå¾Œï¼Œæˆ‘å€‘å¯ä»¥åœ¨ /proc/cmdline çœ‹åˆ°æˆ‘å€‘å…ˆå‰æŒ‡å®šçš„é–‹æ©Ÿåƒæ•¸(bootarg)ã€‚\nå¾ NFS ä¼ºæœå™¨ä¸­è¼‰å…¥ rootfs\nå¯«åœ¨æœ€å¾Œ åœ¨ U-Boot ä¸­çœ‹åˆ°çš„åƒæ•¸ï¼Œåœ¨æœ¬ç¯‡ä¸¦æ²’æœ‰å¤šå»æ¢ç©¶ã€‚ä¸éä¹Ÿåˆ¥å¤ªéå‚·å¿ƒï¼Œä»¥å¾Œæˆ‘å€‘æœƒå°ˆé–€è£½ä½œä¸€ç¯‡ç‚ºå¤§å®¶è¬›è§£ã€‚\n1 2 3 4 loadaddr=0x80280000 fdt_addr=0x83000000 image=Image fdt_file=imx8qxp-mek-rpmsg.dtb å°çµ é€™æ¬¡åœ¨æ’°å¯«æœ¬ç¯‡æ™‚ï¼Œå…¶å¯¦æ˜¯æƒ³æŠŠ Kernel èˆ‡è£ç½®æ¨¹éƒ½å¾ç¶²è·¯è¼‰ä¸‹ä¾†çš„ã€‚\nä½†ç¤™æ–¼ç­†è€…çš„ç¶²è·¯ç’°å¢ƒæ¯”è¼ƒè¤‡é›œï¼Œä¸€ç›´ç„¡æ³•æˆåŠŸçš„è—‰ç”± TFTP å‚³è¼¸è³‡æ–™ã€‚\næ‰€ä»¥ä¹Ÿå°±æš«æ™‚ä½œç½·ã€‚\næœªä¾†å¦‚æœæœ‰å®Œæˆé€™å€‹éƒ¨ä»½å†ä¾†æ›´æ–°å§ã€‚\n( é™„ä¸Šç•¶æ™‚çš„ç­†è¨˜ )\né…ç½® TFTP ä¼ºæœå™¨ å®‰è£ TFTP 1 sudo aptitude install -y tftpd-hpa é…ç½®åˆ†äº«è·¯å¾‘ 1 2 3 4 5 6 7 sudo cp /etc/default/tftpd-hpa{,.bk} sudo sed -i \u0026#39;s#TFTP_DIRECTORY.*#TFTP_DIRECTORY=\u0026#34;/srv/tftp_shared\u0026#34;#g\u0026#39; /etc/default/tftpd-hpa sudo sed -i \u0026#39;s#TFTP_ADDRESS.*#TFTP_ADDRESS=\u0026#34;:69\u0026#34;#g\u0026#39; /etc/default/tftpd-hpa sudo sed -i \u0026#39;s#TFTP_OPTIONS.*#TFTP_OPTIONS=\u0026#34;--secure --create\u0026#34;#g\u0026#39; /etc/default/tftpd-hpa sudo systemctl enable tftpd-hpa sudo systemctl restart tftpd-hpa /etc/default/tftpd-hpa:\n1 2 3 4 5 # /etc/default/tftpd-hpa TFTP_USERNAME=\u0026#34;tftp\u0026#34; TFTP_DIRECTORY=\u0026#34;/srv/tftp_shared/\u0026#34; TFTP_ADDRESS=\u0026#34;:69\u0026#34; TFTP_OPTIONS=\u0026#34;--secure --create\u0026#34; é…ç½®é˜²ç«ç‰† 1 2 3 4 sudo firewall-cmd \\ --add-rich-rule=\u0026#34;rule family=\u0026#39;ipv4\u0026#39; source address=\u0026#39;192.168.1.2\u0026#39; service name=\u0026#39;tftp\u0026#39; accept\u0026#34; \\ --permanent sudo firewall-cmd --reload é™¤éŒ¯ 1 2 sudo netstat -nlp sudo journalctl -fu tftpd-hpa.service ç”¨æˆ¶ç«¯æ¸¬è©¦ åœ¨ä¼ºæœå™¨ä¸­å»ºç«‹æ¸¬è©¦ç”¨çš„è³‡æ–™\necho \u0026#34;Hello word\u0026#34; \u0026gt; /srv/tftp_shared/hello åœ¨ç”¨æˆ¶ç«¯é€²è¡Œä¸Šã€ä¸‹è¼‰æ¸¬è©¦\n1 2 3 4 5 echo \u0026#34;I am Groot~~~~~\u0026#34; \u0026gt; groot.txt tftp SERVER_IP tftp get hello tftp put groot.txt åƒè€ƒé€£çµ i.MX LinuxÂ® User\u0026rsquo;s Guide ","description":"","id":10,"section":"posts","tags":["i.mx8qxp","u-boot","yocto","linux","nfs","tftp"],"title":"åœ¨ i.MX 8QuadXPlus ä¸Šä½¿ç”¨ Yocto å»ºç½® Linux ç³»çµ± 4","uri":"https://e61983.github.io/2021-09-13-yocto-with-imx8qxp-4/"},{"content":"å‰è¨€ ç›®å‰æœ‰äº†åœ¨å¤–é¢å­˜å– NAS è³‡æ–™çš„éœ€æ±‚ï¼Œç›´æ¥è£¸å¥”å¯¦åœ¨ä¸æ˜¯å€‹æ˜æ™ºçš„æƒ³æ³•ã€‚é‚„æ˜¯æ”¾åœ¨é˜²ç«ç‰†å¾Œé¢ï¼Œæ¶å€‹ VPN æœå‹™å¥½äº†ã€‚\næƒ³èªªæ—¢ç„¶è¦æ¶ VPN ä¼ºæœå™¨ã€‚è¶é€™æ¬¡æ©Ÿæœƒä¹Ÿä¸€ä½µæ›å¥—é˜²ç«ç‰†è»Ÿé«”è©¦è©¦ã€‚\nä¸»è¦å…§å®¹ ä¸‹è¼‰æ˜ åƒæª” é¸æ“‡å¥½æƒ³ä½¿ç”¨çš„æ˜ åƒæª”å¾Œå°±å¯ä»¥ç›´æ¥ä¸‹è¼‰ä¸‹ä¾†ï¼Œæº–å‚™è£½ä½œå®‰è£éš¨èº«ç¢Ÿã€‚\nä¸‹è¼‰é é¢\n1 2 3 4 # Image Type: vga # Mirror: Nantou County Education Network center wget https://mirror.ntct.edu.tw/opnsense/releases/21.7/OPNsense-21.7.1-OpenSSL-vga-amd64.img.bz2 è£½ä½œå®‰è£éš¨èº«ç¢Ÿ åœ¨é€™è£¡æˆ‘å€‘ä½¿ç”¨ dd ä¾†è£½ä½œå®‰è£éš¨èº«ç¢Ÿã€‚å¦‚æœæ˜¯ä½¿ç”¨ Windows ç³»çµ±çš„åŒå­¸å‰‡å˜—è©¦ä½¿ç”¨ Rufs ä¾†è£½ä½œã€‚\n1 bzcat OPNsense-21.7.1-OpenSSL-vga-amd64.img.bz2|sudo dd of=/dev/${DISK} bs=10m å®‰è£ Opnsense (åƒè€ƒå½±ç‰‡) ä½¿ç”¨æˆ‘å€‘å‰›è£½ä½œå®Œæˆçš„ Opnsense å®‰è£éš¨èº«ç¢Ÿé–‹æ©Ÿå¾Œä½¿ç”¨ installer/opnsense å¸³æˆ¶ç™»å…¥ï¼Œä¾¿å¯ä»¥é–‹ä½¿é€²è¡Œå®‰è£ã€‚\nä¸‹åˆ—æ•´ç†äº†å®‰è£çš„æ­¥é©Ÿ\nå®‰è£ Opnsense ç³»çµ± é…ç½® WAN é…ç½® LAN é…ç½®æˆ‘å€‘æ‰€éœ€è¦çš„é˜²ç«ç‰†è¦å‰‡ è¨­å®š OpenVPN (åƒè€ƒå½±ç‰‡) ä¸‹åˆ—æ•´ç†äº†è¦æ¶è¨­ OpenVPN çš„æ­¥é©Ÿ\nå»ºç«‹ Root CA å»ºç«‹ VPN ä¼ºæœå™¨æ‰€è¦ä½¿ç”¨çš„æ†‘è­‰ ( Server-Cert ) å»ºç«‹æœ¬æ©Ÿç”¨æˆ¶æ‰€è¦ä½¿ç”¨çš„æ†‘è­‰ ( User-Cert ) å»ºç«‹ OpenVPN Serverï¼Œä¸¦æ·»åŠ é˜²ç«ç‰†è¦å‰‡ åŒ¯å‡º OpenVPN ä½¿ç”¨è€…ç«¯çš„è¨­å®šæª” æœ€å¾Œï¼Œåœ¨çµ‚ç«¯è¨­å‚™å®‰è£ OpenVPN ä½¿ç”¨è€…ç¨‹å¼ä¸¦åŒ¯å…¥è¨­å®šæª”(*.ovpn)ã€‚ å°çµ åŸæœ¬ç­†è€…æ˜¯ä½¿ç”¨ pfSense é€™å¥—é˜²ç«ç‰†ï¼Œæ‰€ä»¥åœ¨é…ç½®ä¸Šå…¶å¯¦ Opnsense èˆ‡ pfSense å·®ç•°æ²’æœ‰å¾ˆå¤§ã€‚\nä¸éå¤–è§€ç¢ºå¯¦è®Šå¾—æ¯”è¼ƒæ¼‚äº®äº†ğŸ¤£ã€‚\nåƒè€ƒé€£çµ å®˜æ–¹ç¶²ç«™ å®˜æ–¹æ–‡ä»¶ ","description":"","id":11,"section":"posts","tags":["vpn","openvpn","pfsense","opnsense"],"title":"å®‰è£ Opnsense ä¸¦è¨­å®š OpenVPN","uri":"https://e61983.github.io/2021-09-09-install-opnsense-and-openvpn/"},{"content":"å‰è¨€ UUU å…¨åç‚º Universal Update Utilityã€‚å° NXP i.MX ç³»åˆ—ç†Ÿæ‚‰çš„ä½¿ç”¨è€…å° MFGTools ä¸€å®šä¸æœƒæ„Ÿåˆ°é™Œç”Ÿï¼ŒUUU å°±æ˜¯å¾ MFGTools æ¼”é€²è€Œä¾†çš„ï¼Œä¹Ÿç¨±ç‚º MFGTools v3ã€‚å®ƒæ˜¯ç”¨ä¾†é€²è¡Œ Freescale/NXP æ™¶ç‰‡çš„æ˜ åƒæª”ç‡’éŒ„ã€‚\næœ¬ç¯‡å°‡ä½¿ç”¨ UUU å°‡\u0008æˆ‘å€‘å…ˆå‰å»ºç«‹çš„æ˜ åƒæª”ç‡’å¯«è‡³ eMMC ä¸­ã€‚\nä¸»è¦å…§å®¹ å¯«åœ¨å‰é¢ ç‚ºäº†è¦ç‡’å¯« bootloader ä»¥åŠæˆ‘å€‘çš„ç³»çµ±è‡³ eMMCï¼Œæˆ‘å€‘åƒè€ƒ IMX_LINUX_USERS_GUIDE.pdf 4.2.2 Using UUU\nFollow these instructions to use the UUU for i.MX 6, i.MX 7, i.MX 8:\nConnect a USB cable from a computer to the USB OTG/TYPE C port on the board. Connect a USB cable from the OTG-to-UART port to the computer for console output. Open a Terminal emulator program. See Section \u0026ldquo;Basic Terminal Setup\u0026rdquo; in this document. Set the boot pin to serial download mode mode. See Section \u0026ldquo;Serial download mode for the Manufacturing Tool\u0026rdquo; in this document. ç‡’å¯«å‰çš„æº–å‚™ ä¿®æ”¹ä¸»æ¿çš„ Boot é…ç½® å°‡ boot mode é…ç½®ç‚º Serial Download Mode (1000)\nåˆ‡æ›ç‚º Serial Download\né€£æ¥ USB Type C é€£æ¥å¥½ USB Type C ç·šåˆ° Host ä¸Šã€‚\nUSB Type C\né€£æ¥å¥½ USB Type C ç·šä¹‹å¾Œï¼Œæˆ‘å€‘å¯ä»¥è¼¸å…¥ä¸‹åˆ—æŒ‡ä»¤ä¾†ç¢ºèªæ˜¯å¦æœ‰é€£æ¥ä¸Šã€‚\n1 2 3 4 5 6 7 8 9 10 ./uuu_mac -lsusb # Output # uuu (Universal Update Utility) for nxp imx chips -- libuuu_1.4.139-0-g1a8f760 # # Connected Known USB Devices #\tPath\tChip\tPro\tVid\tPid\tBcdVersion #\t================================================== #\t20:2\tMX8QXP\tSDPS:\t0x1FC9\t0x012F 0x0004 ä¸‹è¼‰ UUU ç­†è€…æ˜¯ä½¿ç”¨ MacOSï¼Œæ‰€ä»¥ä¸‹è¼‰æ™‚æ˜¯ä¸‹è¼‰ mac çš„ç‰ˆæœ¬ã€‚\n1 2 3 wget https://github.com/NXPmicro/mfgtools/releases/download/uuu_1.4.139/uuu_mac chmod o+x uuu_mac ./uuu_mac dyld: Library not loaded: /usr/local/opt/libzip/lib/libzip.5.dylib\nReferenced from: /tmp/uuu_mac\nReason: image not found\n[1] 5351 abort ./uuu_mac\nè§£æ±ºçš„æ–¹å¼ï¼Œå°±æ˜¯å®‰è£ç¼ºå°‘çš„å‡½å¼åº« libzip\n1 brew install libzip ç‡’å¯« Bootloader æˆ‘å€‘å°‡è¼¸å…¥ä¸‹åˆ—æŒ‡ä»¤ä¾†ä½¿ç”¨ UUU ä¾†å¯«å…¥ U-Boot åˆ° eMMC ä¸­ã€‚\n1 2 3 4 5 6 7 8 sudo ./uuu_mac -b emmc imx-boot-imx8qxpc0mek-sd.bin-flash_spl # Output # uuu (Universal Update Utility) for nxp imx chips -- libuuu_1.4.139-0-g1a8f760 # Success 1 Failure 0 # 20:433 7/ 7 [Done ] FB: Done å¦‚æœåŒå­¸ä¹Ÿé‡åˆ°äº†é€™å€‹å•é¡Œï¼Œå¯ä»¥å»ä½¿ç”¨æœ€æ–°çš„ libusb å‡½å¼åº«ã€‚\nuuu (Universal Update Utility) for nxp imx chips \u0026ndash; libuuu_1.4.139-0-g1a8f760\nSuccess 0 Failure 1\n20:2 1/ 2 [Failure claim interface ] SDPS: boot -f \u0026ldquo;./u-boot-imx8qxpc0mek.bin-sd\u0026rdquo;\n1 2 3 4 # åƒè€ƒ https://github.com/NXPmicro/mfgtools/issues/246#issuecomment-898894168 brew install --head libusb brew unlink libusb brew link --head libusb ç‡’å¯«æ•´å€‹ç³»çµ± æˆ‘å€‘é€éä¸‹åˆ—æŒ‡ä»¤ä¾†å¯«å…¥æ•´å€‹ç³»çµ±ã€‚\n1 2 3 4 5 6 7 8 sudo ./uuu_mac -b emmc_all imx-boot-imx8qxpc0mek-sd.bin-flash_spl \u0026#34;imx-image-core-imx8qxpc0mek.wic.bz2/*\u0026#34; # Output: # uuu (Universal Update Utility) for nxp imx chips -- libuuu_1.4.139-0-g1a8f760 # Success 1 Failure 0 # 20:433 8/ 8 [Done ] FB: done åœ¨è™›æ“¬å™¨ä¸­é€²è¡Œç‡’å¯« å¦‚æœåŒå­¸å€‘æ˜¯ä½¿ç”¨è™›æ“¬å™¨çš„ç’°å¢ƒï¼Œè¦ç‰¹åˆ¥æ³¨æ„ USB åŸ çš„åˆ†äº«è¨­å®šã€‚è¨˜å¾—å¦‚æœæœ‰å¤šå€‹çš„è©±éƒ½è¦é¸åˆ°å”·!\nè™›æ“¬å™¨çš„USB åŸ åˆ†äº«è¨­å®š\nçµæœ å°‡ boot mode é…ç½®ç‚º eMMC Mode (0100)ï¼Œä¸¦é‡æ–°é–‹æ©Ÿä¹‹å¾Œå³å¯çœ‹åˆ°èˆ‡å…ˆå‰ç›¸åŒçš„è¼¸å‡ºäº†ã€‚\nåˆ‡æ›ç‚º eMMC Mode\nå°çµ UUU æœ‰æ”¯æ´ Fastboot ç›¸é—œçš„æŒ‡ä»¤ï¼Œæœ¬ç¯‡ä¸¦æ²’æœ‰å¤ªå¤šçš„è‘—å¢¨ã€‚æœ‰èˆˆè¶£çš„åŒå­¸å¯ä»¥è‡ªè¡Œç©ç©çœ‹ã€‚\nåƒè€ƒé€£çµ NXPmicro/mfgtools ã€ATU Book-i.MX8ç³»åˆ—ã€‘ UUUï¼ˆUniversal Update Utilityï¼‰ imx8mq - Bootloader ç·¨è­¯éç¨‹ i.MX8 uuu ","description":"","id":12,"section":"posts","tags":["i.mx8qxp","yocto","linux"],"title":"åœ¨ i.MX 8QuadXPlus ä¸Šä½¿ç”¨ Yocto å»ºç½® Linux ç³»çµ± 3","uri":"https://e61983.github.io/2021-09-07-yocto-with-imx8qxp-3/"},{"content":"å‰è¨€ ç¹¼ä¸Šä¸€ç¯‡æˆ‘å€‘å»ºç«‹äº†å¯é–‹æ©Ÿçš„æ˜ åƒæª”å¾Œï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘è¦ä¾†ä¿®æ”¹ä¿®æ”¹é è¨­çš„é™¤éŒ¯åŸ ã€‚å¾ UART0 æ”¹è‡³ UART2ã€‚\nä¸»è¦å…§å®¹ å¯«åœ¨é–‹å§‹ä¹‹å‰ åœ¨ Yocto å°ˆæ¡ˆä¸­ï¼Œæœ‰é—œç¡¬é«”çš„é…ç½®éƒ½æœƒè¨˜éŒ„åœ¨ Machine Layerã€‚æ‰€ä»¥æˆ‘å€‘è¦å…ˆå¾ Machine é…ç½®æª”æ‰¾åˆ°ç›¸é—œçš„è³‡è¨Šï¼Œå†é–‹å§‹ä¿®æ”¹ã€‚\nåœ¨æ‰¾åˆ° u-boot ç›¸é—œçš„è³‡è¨Šå¾Œï¼Œæˆ‘å€‘å¯èƒ½è¦ä¿®æ”¹:\nè£ç½®æ¨¹ ( Devicetree ) GPIOåˆå§‹åŒ– (æ™‚åºã€iomux) é™¤éŒ¯åŸ ç›¸é—œè¨­å®š Kernel é–‹æ©Ÿåƒæ•¸ UART2 åœ¨å“ªè£¡ å¾ä¸»æ¿ä¸Šæˆ‘å€‘å¯ä»¥çœ‹åˆ°æœ‰ä¸€çµ„ DB9 çš„é€£æ¥åŸ ï¼Œä¸Šé¢å¯«è‘— RS232ã€‚ä½†æˆ‘å€‘è¦å¦‚ä½•çŸ¥é“å®ƒæ˜¯å“ªä¸€å€‹ UART åŸ å‘¢?\nä¸»æ¿ä¸Šçš„ UART2\næˆ‘å€‘å¯ä»¥å¾å®˜æ–¹æä¾›çš„é›»è·¯åœ–ä¾†çœ‹ï¼Œå…ˆæ‰¾åˆ° J37 (ä¸»æ¿ä¸Šæœ‰å¯«) çš„å…ƒä»¶ã€‚å†å¾æ­¤é–‹å§‹ä¸€è·¯çš„å¾€æºé ­æ‰¾ã€‚\nUART2 DB9\né›»è·¯åœ–\næœ€å¾Œæˆ‘å€‘å¯ä»¥çœ‹åˆ°å®ƒæ˜¯æ¥åœ¨ i.mx8qxp çš„ AD34 èˆ‡ AD35 ä¸Šã€‚\né›»è·¯åœ–\næˆ‘å€‘å¯ä»¥çœ‹åˆ° AD34 èˆ‡ AD35 å³æ˜¯ UART2_RX èˆ‡ UART2_TX ã€‚\ni.MX 8QuadXPlus and 8DualXPlus Automotive and Infotainment Applications Processors, P128\nä¹Ÿå¯ä»¥åœ¨åƒè€ƒæ‰‹å†Šæ‰¾åˆ° UART2 çš„æš«å­˜å™¨ä½ç½®ã€‚\ni.MX 8DualX/8DualXPlus/8QuadXPlus Applications Processor Reference Manual, P31\næ¸¬è©¦ UART2 æ˜¯å¦æ­£å¸¸ åœ¨é€™è£¡æˆ‘å€‘å¯ä»¥å…ˆå°‡ boot åˆ‡æ›è‡³ eMMC ä¸¦å¾æ–°é–‹æ©Ÿã€‚\né€£æ¥å¥½ i.mx8qxp å¾Œï¼Œæˆ‘å€‘å¯ä»¥åœ¨ Host ç«¯ä½¿ç”¨ç¿’æ…£çš„ RS232 å·¥å…·è»Ÿé«”é–‹å•Ÿ RS232 ä¸²åˆ—åŸ ã€‚\næ¥è‘—åœ¨ i.mx8qxp ä¸Šé…ç½®å¥½ UART2 çš„é®‘ç‡å¾Œï¼Œå°±å¯ä»¥é€²è¡Œæ¸¬è©¦äº†ã€‚\nå¦‚æœä¸»æ¿çš„ eMMC ä¸­ä¸¦æ²’æœ‰å¯ç”¨çš„ç³»çµ±ï¼Œé—œæ–¼é€™ä¸€é»ï¼Œä»¥å¾Œæˆ‘å€‘æœƒå°ˆé–€è£½ä½œä¸€ç¯‡ç‚ºå¤§å®¶è¬›è§£.ã€‚\nåœ¨ Host ç«¯:\n1 screen /dev/tty.XXXXX 115200 åœ¨ i.mx8qxp ç«¯:\n1 2 3 4 # ä¿®æ”¹ ttyLP2 æ‰€ä½¿ç”¨çš„é®‘ç‡ stty -F /dev/ttyLP2 115200 echo \u0026#34;Hello Word!\u0026#34; \u0026gt; /dev//dev/ttyLP2 ä¿®æ”¹ U-Boot ä¾†è‡ª Machine Layer çš„è¨Šæ¯ æˆ‘å€‘åœ¨ä¸Šä¸€ç¯‡æ˜¯æŒ‡å®š imx8qxpc0mek ç‚ºç›®æ¨™æ©Ÿå™¨ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥å…ˆæ‰¾åˆ°æ­¤é…ç½®æª”ã€‚\n1 2 3 4 5 cd imx-yocto-bsp/sources find . -iname \u0026#34;*imx8qxpc0mek*\u0026#34; # Output: # ./meta-imx/meta-bsp/conf/machine/imx8qxpc0mek.conf U-Boot ç›¸é—œé…ç½® åœ¨æ‰¾åˆ°ç›®æ¨™æ©Ÿå™¨çš„é…ç½®æª”å¾Œï¼Œæˆ‘å€‘å¯ä»¥æ‰¾è©¢æœ‰é—œ VIRTUAL/BOOTLOADER æˆ–æ˜¯ VIRTUAL/UBOOT ç›¸é—œçš„è¨­å®šã€‚\nå¦‚æœæ²’æœ‰çœ‹åˆ°ç›¸é—œè¨­å®šçš„è©±ï¼Œæˆ‘å€‘å¯ä»¥å†å¾€å®ƒçš„ require æˆ–æ˜¯ include æª”æŸ¥æ‰¾ã€‚\nåœ¨ imx8qxp-mek.conf æˆ‘å€‘çŸ¥é“äº† U-Boot çš„ defconfig æª”, æª”åç‚º imx8qxp_mek\nimx8qxp-mek.conf\nimx-yocto-bsp/sources/meta-imx/meta-bsp/conf/machine/imx8qxpc0mek.conf require imx-yocto-bsp/sources/meta-freescale/conf/machine/imx8qxp-mek.conf require imx-yocto-bsp/sources/meta-freescale/conf/machine/include/imx8x-mek.inc require imx-yocto-bsp/sources/meta-freescale/conf/machine/include/imx-base.inc ç¢ºèª U-Boot å¥—ä»¶è³‡è¨Š æˆ‘å€‘å¯ä»¥é€éæ‰¾å°‹ä¸‹åˆ—è®Šæ•¸ï¼Œä¾†æ‰¾åˆ°ä½¿ç”¨çš„ U-Boot Package åç¨±ã€‚\nPREFERRED_PROVIDER_u-boot PREFERRED_PROVIDER_virtual/bootloader åœ¨ç·¨è­¯éå¾Œï¼ŒåŸå§‹ç¢¼å¯ä»¥åœ¨ ${WORK_DIR} è³‡æ–™å¤¾ä¸­æ‰¾åˆ°ã€‚\n1 2 3 4 5 6 7 8 ls imx-yocto-bsp/first-build/tmp/work/imx8qxpc0mek-poky-linux/u-boot-imx/1_2021.04-r0/git # Output: # api config.mk dts include MAINTAINERS scripts # arch configs env Kbuild Makefile test # board disk examples Kconfig net tools # cmd doc fs lib post # common drivers imx8qxp_mek_defconfig Licenses README ä¸éæˆ‘å€‘å…¶å¯¦ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ devshell ï¼Œåœ¨ devshell ç’°å¢ƒé€²è¡Œä¿®æ”¹å°±å¯ä»¥äº†ã€‚\nç¢ºèª U-Boot é–‹æ©Ÿæ™‚ä½¿ç”¨çš„è£ç½®æ¨¹(Devicetree) é–‹æ©Ÿæ‰€ä½¿ç”¨çš„è£ç½®æ¨¹è³‡è¨Šï¼Œæœƒè¨˜éŒ„åœ¨ defconfig ä¸­ï¼Œæˆ‘å€‘å¯ä»¥åœ¨ configs ä¸­æ‰¾è©¢ imx8qxp_mek_defconfig é…ç½®æª”ã€‚å¾é…ç½®æª”ä¸­ï¼Œæˆ‘å€‘å¯ä»¥çœ‹åˆ°å®ƒæ˜¯ä½¿ç”¨ fsl-imx8qxp-mekã€‚\né€™å€‹æª”æ¡ˆæˆ‘å€‘å¯ä»¥åœ¨ /arch/arm/dts/ ä¸­çœ‹åˆ°ã€‚\nimx8qxp_mek_defconfig\nä¿®æ”¹ U-Boot è£ç½®æ¨¹(Devicetree) åœ¨æ‰¾å°‹çš„éç¨‹ä¸­ç™¼ç¾ fsl-imx8qxp-ai_ml.dts æ˜¯ä½¿ç”¨ UART2 ä½œç‚ºé è¨­çš„è¼¸å‡ºï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥åƒè€ƒå®ƒä¾†é€²è¡Œä¿®æ”¹ã€‚\nä¸‹åˆ—æ˜¯æˆ‘å€‘æœƒä¿®æ”¹åˆ°çš„æª”æ¡ˆ:\narch/arm/dts/fsl-imx8dx.dtsi arch/arm/dts/fsl-imx8qxp-mek-u-boot.dtsi arch/arm/dts/fsl-imx8qxp-mek.dts 1 bitbake -c devshell virtual/bootloader 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 diff --git a/arch/arm/dts/fsl-imx8dx.dtsi b/arch/arm/dts/fsl-imx8dx.dtsi index a36bf388c7..4d2606defe 100644 --- a/arch/arm/dts/fsl-imx8dx.dtsi +++ b/arch/arm/dts/fsl-imx8dx.dtsi @@ -975,25 +975,7 @@ reg = \u0026lt;SC_R_UART_2\u0026gt;; #power-domain-cells = \u0026lt;0\u0026gt;; power-domains = \u0026lt;\u0026amp;pd_dma\u0026gt;; - #address-cells = \u0026lt;1\u0026gt;; - #size-cells = \u0026lt;0\u0026gt;; wakeup-irq = \u0026lt;347\u0026gt;; - - pd_dma2_chan12: PD_UART2_RX { - reg = \u0026lt;SC_R_DMA_2_CH12\u0026gt;; - power-domains =\u0026lt;\u0026amp;pd_dma_lpuart2\u0026gt;; - #power-domain-cells = \u0026lt;0\u0026gt;; - #address-cells = \u0026lt;1\u0026gt;; - #size-cells = \u0026lt;0\u0026gt;; - - pd_dma2_chan13: PD_UART2_TX { - reg = \u0026lt;SC_R_DMA_2_CH13\u0026gt;; - power-domains =\u0026lt;\u0026amp;pd_dma2_chan12\u0026gt;; - #power-domain-cells = \u0026lt;0\u0026gt;; - #address-cells = \u0026lt;1\u0026gt;; - #size-cells = \u0026lt;0\u0026gt;; - }; - }; }; pd_dma_lpuart3: PD_DMA_UART3 { reg = \u0026lt;SC_R_UART_3\u0026gt;; @@ -2839,10 +2821,7 @@ clock-names = \u0026#34;per\u0026#34;, \u0026#34;ipg\u0026#34;; assigned-clocks = \u0026lt;\u0026amp;clk IMX8QXP_UART2_CLK\u0026gt;; assigned-clock-rates = \u0026lt;80000000\u0026gt;; - power-domains = \u0026lt;\u0026amp;pd_dma2_chan13\u0026gt;; - dma-names = \u0026#34;tx\u0026#34;,\u0026#34;rx\u0026#34;; - dmas = \u0026lt;\u0026amp;edma2 13 0 0\u0026gt;, - \u0026lt;\u0026amp;edma2 12 0 1\u0026gt;; + power-domains = \u0026lt;\u0026amp;pd_dma_lpuart2\u0026gt;; status = \u0026#34;disabled\u0026#34;; }; diff --git a/arch/arm/dts/fsl-imx8qxp-mek-u-boot.dtsi b/arch/arm/dts/fsl-imx8qxp-mek-u-boot.dtsi index 5327485bfa..7df4d1bb5e 100644 --- a/arch/arm/dts/fsl-imx8qxp-mek-u-boot.dtsi +++ b/arch/arm/dts/fsl-imx8qxp-mek-u-boot.dtsi @@ -68,6 +68,10 @@ u-boot,dm-spl; }; +\u0026amp;pinctrl_lpuart2 { +\tu-boot,dm-spl; +}; + \u0026amp;pinctrl_usdhc1 { u-boot,dm-spl; }; @@ -136,6 +140,10 @@ u-boot,dm-spl; }; +\u0026amp;pd_dma_lpuart2 { +\tu-boot,dm-spl; +}; + \u0026amp;pd_conn_usbotg0 { u-boot,dm-spl; }; @@ -208,6 +216,10 @@ u-boot,dm-spl; }; +\u0026amp;lpuart2 { +\tu-boot,dm-spl; +}; + \u0026amp;usbmisc1 { u-boot,dm-spl; }; diff --git a/arch/arm/dts/fsl-imx8qxp-mek.dts b/arch/arm/dts/fsl-imx8qxp-mek.dts index 86aa868479..a5a5c5e49d 100644 --- a/arch/arm/dts/fsl-imx8qxp-mek.dts +++ b/arch/arm/dts/fsl-imx8qxp-mek.dts @@ -21,8 +21,8 @@ }; chosen { -\tbootargs = \u0026#34;console=ttyLP0,115200 earlycon\u0026#34;; -\tstdout-path = \u0026amp;lpuart0; +\tbootargs = \u0026#34;console=ttyLP2,115200 earlycon\u0026#34;; +\tstdout-path = \u0026amp;lpuart2; }; regulators { @@ -126,6 +126,13 @@ \u0026gt;; }; +\tpinctrl_lpuart2: lpuart2grp { +\tfsl,pins = \u0026lt; +\tSC_P_UART2_RX_ADMA_UART2_R\t0x06000020 +\tSC_P_UART2_TX_ADMA_UART2_T\t0x06000020 +\t\u0026gt;; +\t}; + pinctrl_usdhc1: usdhc1grp { fsl,pins = \u0026lt; SC_P_EMMC0_CLK_CONN_EMMC0_CLK\t0x06000041 @@ -217,6 +224,12 @@ status = \u0026#34;okay\u0026#34;; }; +\u0026amp;lpuart2 { +\tpinctrl-names = \u0026#34;default\u0026#34;; +\tpinctrl-0 = \u0026lt;\u0026amp;pinctrl_lpuart2\u0026gt;; +\tstatus = \u0026#34;okay\u0026#34;; +}; + \u0026amp;gpio0 { status = \u0026#34;okay\u0026#34;; }; fsl-imx8qxp-mek.dts include fsl-imx8qxp.dtsi include fsl-imx8dxp.dtsi include fsl-imx8dx.dtsi include fsl-imx8-ca35.dtsi Device tree\nThe U-Boot device tree is filtered by the fdtgrep tools during the build\nprocess to generate a much smaller device tree used in SPL (spl/u-boot-spl.dtb)\nwith:\nthe mandatory nodes (/alias, /chosen, /config) the nodes with one pre-relocation property:\n\u0026lsquo;u-boot,dm-pre-reloc\u0026rsquo; or \u0026lsquo;u-boot,dm-spl\u0026rsquo; fdtgrep is also used to remove:\nthe properties defined in CONFIG_OF_SPL_REMOVE_PROPS all the pre-relocation properties\n(\u0026lsquo;u-boot,dm-pre-reloc\u0026rsquo;, \u0026lsquo;u-boot,dm-spl\u0026rsquo; and \u0026lsquo;u-boot,dm-tpl\u0026rsquo;) All the nodes remaining in the SPL devicetree are bound\n(see doc/driver-model/design.rst).\nä¿®æ”¹ U-Boot é–‹æ©Ÿé…ç½® ä¸‹åˆ—æ˜¯æˆ‘å€‘æœƒä¿®æ”¹åˆ°çš„æª”æ¡ˆ:\narch/arm/mach-imx/imx8/clock.c board/freescale/imx8qxp_mek/imx8qxp_mek.c include/configs/imx8qxp_mek.h 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 diff --git a/arch/arm/mach-imx/imx8/clock.c b/arch/arm/mach-imx/imx8/clock.c index 4eb22ce129..05343d901d 100644 --- a/arch/arm/mach-imx/imx8/clock.c +++ b/arch/arm/mach-imx/imx8/clock.c @@ -27,7 +27,7 @@ u32 mxc_get_clock(enum mxc_clock clk) switch (clk) { case MXC_UART_CLK: err = sc_pm_get_clock_rate(-1, -\tSC_R_UART_0, 2, \u0026amp;clkrate); +\tSC_R_UART_2, 2, \u0026amp;clkrate); if (err != SC_ERR_NONE) { printf(\u0026#34;sc get UART clk failed! err=%d\\n\u0026#34;, err); return 0; diff --git a/board/freescale/imx8qxp_mek/imx8qxp_mek.c b/board/freescale/imx8qxp_mek/imx8qxp_mek.c index a4f9fab986..71068b090d 100644 --- a/board/freescale/imx8qxp_mek/imx8qxp_mek.c +++ b/board/freescale/imx8qxp_mek/imx8qxp_mek.c @@ -42,14 +42,14 @@ DECLARE_GLOBAL_DATA_PTR; (SC_PAD_28FDSOI_DSE_DV_HIGH \u0026lt;\u0026lt; PADRING_DSE_SHIFT) | \\ (SC_PAD_28FDSOI_PS_PU \u0026lt;\u0026lt; PADRING_PULL_SHIFT)) -static iomux_cfg_t uart0_pads[] = { -\tSC_P_UART0_RX | MUX_PAD_CTRL(UART_PAD_CTRL), -\tSC_P_UART0_TX | MUX_PAD_CTRL(UART_PAD_CTRL), +static iomux_cfg_t uart2_pads[] = { +\tSC_P_UART2_RX | MUX_PAD_CTRL(UART_PAD_CTRL), +\tSC_P_UART2_TX | MUX_PAD_CTRL(UART_PAD_CTRL), }; static void setup_iomux_uart(void) { -\timx8_iomux_setup_multiple_pads(uart0_pads, ARRAY_SIZE(uart0_pads)); +\timx8_iomux_setup_multiple_pads(uart2_pads, ARRAY_SIZE(uart2_pads)); } int board_early_init_f(void) @@ -57,8 +57,8 @@ int board_early_init_f(void) sc_pm_clock_rate_t rate = SC_80MHZ; int ret; -\t/* Set UART0 clock root to 80 MHz */ -\tret = sc_pm_setup_uart(SC_R_UART_0, rate); +\t/* Set uart2 clock root to 80 MHz */ +\tret = sc_pm_setup_uart(SC_R_UART_2, rate); if (ret) return ret; @@ -348,7 +348,7 @@ int board_init(void) void board_quiesce_devices(void) { const char *power_on_devices[] = { - \u0026#34;dma_lpuart0\u0026#34;, + \u0026#34;dma_lpuart2\u0026#34;, /* HIFI DSP boot */ \u0026#34;audio_sai0\u0026#34;, diff --git a/include/configs/imx8qxp_mek.h b/include/configs/imx8qxp_mek.h index 8e5e48026e..124cbc715c 100644 --- a/include/configs/imx8qxp_mek.h +++ b/include/configs/imx8qxp_mek.h @@ -30,7 +30,7 @@ #define CONFIG_SPL_BSS_MAX_SIZE\t0x1000\t/* 4 KB */ #define CONFIG_SYS_SPL_MALLOC_START\t0x82200000 #define CONFIG_SYS_SPL_MALLOC_SIZE 0x80000\t/* 512 KB */ -#define CONFIG_SERIAL_LPUART_BASE\t0x5a060000 +#define CONFIG_SERIAL_LPUART_BASE\t0x5a080000 /* use UART2 */ #define CONFIG_MALLOC_F_ADDR\t0x00138000 #define CONFIG_SPL_RAW_IMAGE_ARM_TRUSTED_FIRMWARE @@ -125,7 +125,7 @@ \u0026#34;script=boot.scr\\0\u0026#34; \\ \u0026#34;image=Image\\0\u0026#34; \\ \u0026#34;splashimage=0x9e000000\\0\u0026#34; \\ -\t\u0026#34;console=ttyLP0\\0\u0026#34; \\ +\t\u0026#34;console=ttyLP2\\0\u0026#34; \\ \u0026#34;fdt_addr=0x83000000\\0\u0026#34;\t\\ \u0026#34;fdt_high=0xffffffffffffffff\\0\u0026#34;\t\\ \u0026#34;cntr_addr=0x98000000\\0\u0026#34;\t\\ å»ºç«‹ U-Boot çš„ Patch 1 2 git diff \u0026gt; ${BUILD_DIR}/0001-UART0-to-UART2-modification.patch bitbake -c clean virtual/bootloader ä¿®æ”¹ Kernel ä¿®æ”¹å®Œ Bootloader çš„é…ç½®ä¹‹å¾Œï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘è¦ä¿®æ”¹ Kernel çš„é…ç½®ã€‚\næˆ‘å€‘å¯ä»¥é€éæ‰¾å°‹ PREFERRED_PROVIDER_virtual/kernel è®Šæ•¸ï¼Œä¾†æ‰¾åˆ°ä½¿ç”¨çš„ Kernel Package åç¨± linux-fslc-imxã€‚\nç¢ºèª Kernel ç”¨çš„è£ç½®æ¨¹(Devicetree) æˆ‘å€‘å¯ä»¥çœ‹åˆ° machine/imx8qxpc0mek.conf ä¸­ï¼Œ KERNEL_DEVICETREE è®Šæ•¸è¨˜éŒ„äº†è¨±å¤šè£ç½®æ¨¹ã€‚\nä½†å¯¦éš›æœƒä½¿ç”¨å“ªä¸€å€‹ä¾†é–‹æ©Ÿï¼Œæœƒæ˜¯åœ¨ u-boot æ±ºå®šçš„ã€‚æ‰€ä»¥æˆ‘å€‘å¯ä»¥è§€å¯Ÿ u-bbot ä¸­çš„ç¨‹å¼ç¢¼ï¼Œæœ€å¾Œæœƒç™¼å®ƒæ˜¯ä½¿ç”¨ imx8qxp-mek.dtb ä¾†é–‹æ©Ÿçš„ã€‚\nimx8qxp_mek.c:412\nä¿®æ”¹ Kernel ç”¨çš„è£ç½®æ¨¹(Devicetree) 1 bitbake -c devshell virtual/kernel ä¸‹åˆ—æ˜¯æˆ‘å€‘æœƒä¿®æ”¹åˆ°çš„æª”æ¡ˆ:\narch/arm64/boot/dts/freescale/imx8x-mek.dtsi 1 2 3 4 5 6 7 8 9 10 11 12 13 14 --- diff --git a/arch/arm64/boot/dts/freescale/imx8x-mek.dtsi b/arch/arm64/boot/dts/freescale/imx8x-mek.dtsi index e7f348c2ad14..b08160c5832e 100644 --- a/arch/arm64/boot/dts/freescale/imx8x-mek.dtsi +++ b/arch/arm64/boot/dts/freescale/imx8x-mek.dtsi @@ -6,7 +6,7 @@ #include \u0026lt;dt-bindings/usb/pd.h\u0026gt; / { chosen { -\tstdout-path = \u0026amp;lpuart0; +\tstdout-path = \u0026amp;lpuart2; }; brcmfmac: brcmfmac { imx8x-mek.dts imx8x-mek.dtsi The chosen node\nThe chosen node does not represent a real device, but serves as a place\nfor passing data between firmware and the operating system, like boot\narguments. Data in the chosen node does not represent the hardware.\n(ç•¥)\nstdout-path\nDevice trees may specify the device to be used for boot console output\nwith a stdout-path property under /chosen, as described in the Devicetree\nSpecificationï¼Œ\u0008e.g.\n(ç•¥)\nå»ºç«‹ Kernel çš„ Patch 1 2 git diff \u0026gt; ${BUILD_DIR}/0001-Kernel-UART0-to-UART2-modification.patch bitbake -c clean virtual/kernel å»ºç«‹æ–°çš„ Layer ä¸¦åŠ å…¥ Patch 1 2 3 4 5 6 7 8 9 # å»ºç«‹æ–°çš„ Layer - meta-first bitbake-layers create-layer meta-first # ä½¿ç”¨ meta-first Layer bitbake-layers add-layer meta-first # å»ºç«‹æ–°çš„ recipe ç”¨ä¾†åŠ ä¸Šæˆ‘å€‘å‰é¢çš„ä¿®æ”¹ recipetool appendsrcfile ../meta-first virtual/bootloader ../0001-UART0-to-UART2-modification.patch recipetool appendsrcfile ../meta-rtc virtual/kernel ../0001-Kernel-UART0-to-UART2-modification.patch æˆ‘å€‘å¯ä»¥ä½¿ç”¨ bitbake-layers ä¾†æŸ¥çœ‹ bbappend æ˜¯å¦æœ‰ç™¼ç”Ÿä½œç”¨ã€‚\n1 2 bitbake-layers show-appends bitbake -e virtual/bootloader é‡æ–°ç·¨è­¯æ˜ åƒæª”ä¸¦ç‡’å¯«è‡³ SD å¡ 1 2 3 4 5 # é–‹å§‹ç·¨è­¯ bitbake imx-image-core # å°‡æ˜ åƒæª”å¯«å…¥ SD å¡ä¸­ bzcat \u0026lt;image_name\u0026gt;.wic.bz2 | sudo dd of=/dev/sd\u0026lt;partition\u0026gt; bs=1M conv=fsync çµæœ åœ¨æ¥ä¸Š Host èˆ‡ ä¸»æ¿ä¸Šçš„ UART2 ä¹‹å¾Œï¼Œæˆ‘å€‘é‡æ–°å•Ÿå‹•é›»æºã€‚\nå¾ UART2 çœ‹åˆ° U-Boot çš„è¼¸å‡ºè¨Šæ¯\nå¯ä»¥çœ‹åˆ°é–‹æ©Ÿçš„ç›¸é—œè³‡è¨Šå·²æ”¹å¾ UART2 è¼¸å‡ºäº†ã€‚\nå¾ UART2 çœ‹åˆ° U-Boot çš„è¼¸å‡ºè¨Šæ¯\nå¾ UART2 çœ‹åˆ° Kernel çš„è¼¸å‡ºè¨Šæ¯\nå°çµ é€™ä¸€ç¯‡éœ€è¦äº†è§£çš„æ±è¥¿æ¯”è¼ƒå¤šã€‚é™¤äº† Yocto æœ¬èº«ä¹‹å¤–ï¼Œé‚„è¦äº†è§£ U-Boot çš„é…ç½®ã€Kernel çš„é…ç½®ã€è£ç½®æ¨¹ä»¥åŠ Kernel çš„é–‹æ©Ÿæµç¨‹ã€‚\nYocto å¯ä»¥åƒè€ƒ Yocto åŸºç¤ä»‹ç´¹ å…¶ä»–çš„éƒ¨ä»½ï¼Œä»¥å¾Œæˆ‘å€‘æœƒå†ç‚ºå¤§å®¶é€²è¡Œèªªæ˜ã€‚\næœ¬ç¯‡æ‰€ä½¿ç”¨çš„ patch å°±æ”¾åœ¨é€™æä¾›çµ¦åŒå­¸åƒè€ƒäº†ã€‚\nåƒè€ƒé€£çµ var-MACHINEOVERRIDES [NXP i.MX æ‡‰ç”¨è™•ç†å™¨æ•™å®¤] åœ¨i.MX8QXP å¹³å°æ›´æ›åµéŒ¯çš„ UARTæ¥å£ ","description":"","id":13,"section":"posts","tags":["i.mx8qxp","device tree","yocto","linux"],"title":"åœ¨ i.MX 8QuadXPlus ä¸Šä½¿ç”¨ Yocto å»ºç½® Linux ç³»çµ± 2","uri":"https://e61983.github.io/2021-09-02-yocto-with-imx8qxp-2/"},{"content":"å‰è¨€ çªç„¶æœ‰äº†ç§»é™¤ PDF å¯†ç¢¼ä¿è­·çš„éœ€æ±‚ã€‚åœ¨æŸ¥æ‰¾ç›¸é—œçš„è³‡æ–™æ™‚ï¼Œé †æ‰‹è¨˜éŒ„ä¸‹ä¾†ã€‚\nä¸»è¦å…§å®¹ å®‰è£ ç­†è€…æ˜¯ä½¿ç”¨ MacBook ï¼Œæ‰€ä»¥æœ¬æ–‡åœ¨æ¸¬è©¦æ™‚æœƒæ˜¯åœ¨ MacOS ä¸‹é€²è¡Œã€‚\nåœ¨ MacOS ä¸­ï¼Œå¯ä»¥è¼¸å…¥ä¸‹åˆ—æŒ‡ä»¤ä¾†å®‰è£ qpdfã€‚\n1 brew install qpdf å¦‚æœæ˜¯ä½¿ç”¨ Ubuntu / Debian ç³»çµ±ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ—æŒ‡ä»¤é€²è¡Œå®‰è£\n1 sudo apt install -y qpdf åˆä½µæª”æ¡ˆ åœ¨é»ä½µæª”æ¡ˆçš„æ™‚å€™ï¼Œå¦‚æœæ²’æœ‰è¼¸å…¥é ç¢¼(ç¯„åœ)çš„è©±ï¼Œæœƒå°‡æ•´ä»½æ–‡ä»¶é€²è¡Œåˆä½µã€‚\n1 qpdf --empty --pages 1.pdf 2.pdf 3.pdf -- out.pdf æˆ‘å€‘å¯ä»¥åœ¨æª”åå¾Œé¢åŠ ä¸ŠæŒ‡å®šçš„é ç¢¼æˆ–æ˜¯ç¯„åœ\n1 qpdf --empty --pages doc1.pdf 1-2 doc2.pdf 1 doc1.pdf 3 -- out.pdf ç§»é™¤å¯†ç¢¼ ä½¿ç”¨ä¸‹åˆ—æŒ‡ä»¤ä¾†ç§»é™¤å¯†ç¢¼ä¿è­·ã€‚\n1 qpdf --decrypt crypt.pdf --password=${PASSWORD} decrypt.pdf çµ„åˆæŠ€ æˆ‘å€‘å¯ä»¥ä½¿ç”¨ä¸‹åˆ—çš„æŒ‡ä»¤ä»¥ doc1.pdf ç¬¬1é ã€crypt.pdfã€doc1.pdf ç¬¬2-3é è¼¸å‡ºç‚º out.pdfã€‚\n1 qpdf --empty --pages doc1.pdf 1 crypt.pdf --password=${PASSWORD} doc2.pdf -- out.pdf åƒè€ƒé€£çµ qpdf/qpdf Syntax for merging entire PDF files ","description":"","id":14,"section":"posts","tags":["cli","pdf"],"title":"ä½¿ç”¨ qpdf ä¾†åˆä½µ PDF èˆ‡ç§»é™¤å¯†ç¢¼ä¿è­·","uri":"https://e61983.github.io/2021-09-02-cli-remove-pdf-password/"},{"content":"å‰è¨€ æœ€è¿‘å‰›æ‹¿åˆ° NXP çš„ i.MAX8 é–‹ç™¼æ¿ã€‚åœ¨æ¸¬è©¦åŸºæœ¬åŠŸèƒ½ä¹‹é¤˜ï¼Œä¹Ÿé †æ‰‹æŠŠéç¨‹è¨˜éŒ„ä¸‹ä¾†ã€‚æœ¬æ–‡åƒ…å…ˆå»ºç½® Yocto çš„é–‹ç™¼ç’°å¢ƒä¸¦ç·¨è­¯å‡ºå¯é–‹æ©Ÿçš„æ˜ åƒæª”ï¼Œæœ€å¾Œé€é SD å¡é–‹æ©Ÿã€‚\nä¸»è¦å…§å®¹ é–‹ç™¼æ¿é…ç½® ä¸‹åˆ—æ˜¯ä¾†è‡ªå®˜æ–¹çš„åœ–ï¼Œæˆ‘å€‘ä¸»è¦æœƒæ˜¯ä»¥ SD Card é–‹æ©Ÿï¼Œæ‰€ä»¥ç›®å‰æˆ‘å€‘è¦å…ˆç¢ºèªä¸»æ¿çš„é–‹æ©Ÿé…ç½®\nhttps://www.nxp.com/design/development-boards/i-mx-evaluation-and-development-boards/i-mx-8quadxplus-multisensory-enablement-kit-mek:MCIMX8QXP-CPU\nç¢ºèª SW2 çš„é…ç½®èˆ‡ä¸‹åœ–ç›¸åŒ\nhttps://www.nxp.com/document/guide/get-started-with-the-mcimx8qxp-cpu:GS-MCIMX8QXP-CPU\né€£æ¥ J11 (Micro USB)ï¼Œæˆ‘å€‘å¯ä»¥åƒå…ˆå‰ä¸€æ¨£åœ¨é›»è…¦ä¸­çœ‹åˆ° tty è£ç½®ã€‚åœ¨å¾ŒçºŒçš„æµç¨‹ï¼Œæˆ‘å€‘å°±å¯ä»¥é€éå®ƒä¾†æ“ä½œç³»çµ±ã€‚\nmicro USB Debug Port\n1 screen /dev/tty.XXXXXX 115200 å®‰è£ç›¸ä¾å¥—ä»¶ 1 2 3 4 5 6 7 8 9 sudo apt install -y gawk wget git-core diffstat unzip texinfo gcc-multilib \\ build-essential chrpath socat cpio python python3 python3-pip python3-pexpect \\ xz-utils debianutils iputils-ping python3-git python3-jinja2 libegl1-mesa libsdl1.2-dev \\ pylint3 xterm rsync curl mkdir -p ~/bin curl https://storage.googleapis.com/git-repo-downloads/repo \u0026gt; ~/bin/repo chmod a+x ~/bin/repo export PATH=~/bin:$PATH å»ºç«‹ Yocto ç’°å¢ƒ 1 2 3 4 5 6 7 mkdir imx-yocto-bsp \u0026amp;\u0026amp; cd imx-yocto-bsp repo init -u https://source.codeaurora.org/external/imx/imx-manifest -b imx-linux-hardknott -m imx-5.10.35-2.0.0.xml # é€™ä¸€æ­¥æœƒèŠ±è »å¤šæ™‚é–“çš„ï¼Œæ‰€ä»¥å°±è®“å­å½ˆé£›ä¸€æœƒå…’å§~~ repo sync DISTRO=fsl-imx-xwayland MACHINE=imx8qxpc0mek source imx-setup-release.sh -b first-build ç¬¬ä¸€æ¬¡ç·¨è­¯ 1 2 3 4 5 6 7 8 # ç§»è‡³å°ˆæ¡ˆç›®éŒ„ä¸­ cd first-build # é–‹å§‹ç·¨è­¯ bitbake imx-image-core # å°‡æ˜ åƒæª”å¯«å…¥ SD å¡ä¸­ bzcat \u0026lt;image_name\u0026gt;.wic.bz2 | sudo dd of=/dev/sd\u0026lt;partition\u0026gt; bs=1M conv=fsync æ¸¬è©¦ UART https://community.nxp.com/t5/i-MX-Processors/How-to-check-rs232-port-in-imx8-8x-baseboard-in-imx8qxp-mek/m-p/1240789\nNFS Host ç«¯ åœ¨ Host ä¸Šå®‰è£ NFS Server ï¼Œä¸¦é€²è¡Œåˆ†äº«ç›®éŒ„èˆ‡é˜²ç«ç‰†è¨­å®šã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 # å®‰è£ NFS Server aptitude install -y nfs-kernel-server # å»ºç«‹åˆ†äº«ç›®éŒ„ mkdir -p /srv/nfs_shared # è¨­å®šåˆ†äº«ç›®éŒ„ echo \u0026#34;/srv/nfs_shared *(insecure,rw,sync,no_root_squash,subtree_check)\u0026#34; \u0026gt; /etc/export # è¨­å®šé˜²ç«ç‰† (å¦‚æœæœ‰çš„è©±) firewall-cmd --add-rich-rule=\u0026#34;rule family=\u0026#39;ipv4\u0026#39; source address=\u0026#39;192.168.0.10\u0026#39; service name=\u0026#39;nfs\u0026#39; accept\u0026#34; --permanent firewall-cmd --add-rich-rule=\u0026#34;rule family=\u0026#39;ipv4\u0026#39; source address=\u0026#39;192.168.0.10\u0026#39; service name=\u0026#39;mountd\u0026#39; accept\u0026#34; --permanent firewall-cmd --add-rich-rule=\u0026#34;rule family=\u0026#39;ipv4\u0026#39; source address=\u0026#39;192.168.0.10\u0026#39; service name=\u0026#39;rpc-bind accept\u0026#34; --permanent firewall-cmd --reload Client ç«¯ åœ¨ i.mx8 é–‹æ©Ÿå¾Œï¼Œå¾Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨ ip ä¾†æª¢è¦–ç›®å‰çš„ IP é…ç½®ç‹€æ³ã€‚\n1 2 3 4 ip -c addr # è¨­ç½®éœæ…‹ IP ip addr add 192.168.0.10/24 dev eth0 1 2 mkdir -p /tmp/nfs mount -t nfs 192.168.0.2:/srv/nfs_shared /tmp/nfs æˆ‘å€‘å°±å¯ä»¥å­˜å–åˆ° Host æ‰€åˆ†äº«çš„è³‡æ–™äº†ã€‚\nå°çµ åœ¨æ¿å­å¯ä»¥é–‹æ©Ÿä¹‹å¾Œï¼Œæ¥ä¸‹ä¾†å°±è¦ä¾†è©¦è‘—æ”¹æ”¹çœ‹é…ç½®å•¦!\nåƒè€ƒé€£çµ MCIMX8QXP-CPU é˜²ç«ç‰†èªªæ˜ä»‹ç´¹ ","description":"","id":15,"section":"posts","tags":["i.mx8qxp","yocto","linux"],"title":"åœ¨ i.MX 8QuadXPlus ä¸Šä½¿ç”¨ Yocto å»ºç½® Linux ç³»çµ±","uri":"https://e61983.github.io/2021-09-01-yocto-with-imx8qxp/"},{"content":"å‰è¨€ æœ€è¿‘å‰›å¥½åœ¨é‡æ–°å®‰è£å·¥ä½œç«™ï¼Œå°±é †æ‰‹è¨˜éŒ„èµ·ä¾†å›‰!\nä¸»è¦å…§å®¹ ä¸‹è¼‰æ˜ åƒæª” 1 wget https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/debian-11.0.0-amd64-netinst.iso è£½ä½œå®‰è£ç¢Ÿ 1 sudo dd if=debian-11.0.0-amd64-netinst.iso of=/dev/DISK bs=10M å®‰è£ å®‰è£æ­¥é©Ÿå¯ä»¥åƒè€ƒé€™é‚Šã€‚\nè¨­å®š IP ä½¿ç”¨ systemd-networkd è¨­å®š IP é€éé‡æ–°å‘½å /etc/network/interfaces çš„æ–¹å¼ï¼Œä¾†åœç”¨åŸæœ¬çš„ç¶²è·¯ä»‹é¢é…ç½®ã€‚ä¸¦å»ºç«‹ systemd-networkd çš„è¨­å®šæª”ã€‚\nå®Œæˆå¾Œï¼Œæˆ‘å€‘å°±å¯ä»¥å•Ÿç”¨ systemd-networkd äº†ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 # å–æ¶ˆ IPv6 echo \u0026#34;net.ipv6.conf.all.disable_ipv6 = 1\u0026#34; \u0026gt;\u0026gt; /etc/sysctl.conf mv /etc/network/interfaces{,.save} cat \u0026lt;\u0026lt; EOF \u0026gt;\u0026gt; /etc/systemd/network/lan.network [Match] Name=eth0 [Network] Address=192.168.0.2/24 Gateway=192.168.0.254 DNS=8.8.8.8 EOF systemctl enable systemd-networkd systemctl start systemd-networkd IP (å·²æ”¹ç”¨ systemd-networkd) ä¿®æ”¹ /etc/network/interfaces ä¾†è¨­å®šä¸»æ©Ÿçš„ IP\n1 2 3 4 5 6 7 allow-hotplug eth0 iface eth0 inet static address 192.168.0.2/24 gateway 192.168.0.254 # dns-* options are implemented by the resolvconf package, if installed dns-nameservers 8.8.8.8 dns-search happy.internal ä½¿ç”¨ä¸‹åˆ—æŒ‡ä»¤ä¾†é‡æ–°èµ·å‹•ç¶²è·¯\n1 /etc/init.d/networking restart 1 2 3 auto eth0 allow-hotplug eth0 iface eth0 inet dhcp æˆ‘å€‘å¯ä»¥ä½¿ç”¨ä¸‹åˆ—æŒ‡ä»¤ä¾†é€²è¡Œè‡¨æ™‚çš„è¨­å®š\n1 2 3 4 5 6 7 8 ip addr add 192.168.0.2/24 dev eth0 ip addr del 192.168.0.2/24 dev eth0 dhcp eth0 dhcp -r eth0 ip link set eth0 up ip link set eth0 down å®‰è£ç³»çµ±æ›´æ–°èˆ‡å¸¸ç”¨å·¥å…· 1 2 3 4 apt upgrade apt update apt install -y aptitude aptitude install -y silversearcher-ag vim htop è¨­å®šæ™‚é–“åŒæ­¥ 1 2 3 4 5 6 7 8 cat \u0026lt;\u0026lt; EOF \u0026gt; /etc/systemd/timesyncd.conf [Time] NTP=time.google.com clock.stdtime.gov.tw EOF systemctl restart systemd-timesyncd.service timedatectl status date è¨­å®šé˜²ç«ç‰†è¦å‰‡ Firewalld aptitude install -y firewalld firewall-cmd --add-port=22022/tcp --permanent firewall-cmd --reload firewall-cmd --list-all å¦‚æœæƒ³ç›´æ¥æ“ä½œ nftables çš„è©±ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ—æŒ‡ä»¤\n1 2 3 4 5 systemctl enable nftables systemctl start nftables nft add rule inet filter input tcp dport 22 accept nft list ruleset #nft list table inet filter ufw (å·²æ”¹ç”¨ firewalld) 1 2 3 ufw enable ufw default deny ufw allow from XXX.XXX.XXX.XXX to XXX.XXX.XXX.XXX port 2234 proto tcp ä¿®æ”¹ SSH Server è¨­å®šä¸¦ä¸Šå‚³é ç«¯å­˜å–å…¬é‘° 1 2 3 sed -i \u0026#39;s/^Port.*$/Port 2234/g\u0026#39; /etc/ssh/sshd_config systemctl restart ssh ssh-copy -i ~/.ssh/id_rsa XXX.XXX.XXX.XXX -p 2234 -l user å¦‚æœæƒ³è¦ç”Ÿæˆæ–°çš„é‡‘é‘°ï¼Œå¯ä»¥è¼¸å…¥ä¸‹åˆ—æŒ‡ä»¤\n1 ssh-keygen -t rsa -b 4096 -f ~/.ssh/new_key_rsa -C email@example.com é™å®šåªèƒ½ä½¿ç”¨é‡‘é‘°é€²è¡Œèªè­‰ 1 2 3 4 sed -i \u0026#39;s/^UsePAM.*$/UsePAM no/g\u0026#39; /etc/ssh/sshd_config sed -i \u0026#39;s/^PermitRootLogin.*$/PermitRootLogin no/g\u0026#39; /etc/ssh/sshd_config echo \u0026#39;PasswordAuthentication no\u0026#39; \u0026gt;\u0026gt; /etc/ssh/sshd_config systemctl restart ssh å¦‚æœæ˜¯ä½¿ç”¨ sudo çš„è©±ï¼Œå¯ä»¥ä½¿ç”¨ tee å°‡è¼¸å‡ºå°å‘æª”æ¡ˆ\n1 echo \u0026#39;PasswordAuthentication no\u0026#39; | sudo tee -a /etc/ssh/sshd_config æŸ¥çœ‹æœ‰èª°ç™»å…¥å¤±æ•—ä»¥åŠæœ‰èª°ç™»å…¥æˆåŠŸ\n1 2 cat /var/log/auth.log | ag \u0026#39;sshd.*Invalid\u0026#39; cat /var/log/auth.log | ag \u0026#39;sshd.*opened\u0026#39; æ“‹æ‰ç™»å…¥å¤±æ•—æ¬¡æ•¸éå¤šçš„é€£ç·š 1 2 3 aptitude install -y fail2ban sed -e \u0026#39;s/^enabled = false$/enabled = true/g\u0026#39; /etc/fail2ban/jail.conf \u0026gt; /etc/fail2ban/jail.local systemctl enable fail2ban æˆ‘å€‘å¯ä»¥ä½¿ç”¨ fail2ban-client ä¾†æŸ¥çœ‹ç›®å‰çš„é‹è¡Œç‹€æ³\n1 fail2ban-client status è‡ªå‹•å®‰è£æ›´æ–° 1 2 3 aptitude install -y unattended-upgrades dpkg-reconfigure -plow unattended-upgrades systemctl status unattended-upgrades.service logrotate 1 /etc/logrotate.conf å°çµ æœ¬æ–‡è¨˜éŒ„äº†ç³»çµ±åœ¨å‰›å®‰è£å®Œæˆæ™‚ï¼Œè¦å…ˆé€²è¡Œçš„é…ç½®ã€‚å¦‚: IPã€æ™‚é–“ã€é˜²ç«ç‰†ç­‰ã€‚\næœªä¾†è‹¥æœ‰å†æ–°å¢è¨­å®šï¼Œæœƒå†è£œå……èªªæ˜ã€‚\nåƒè€ƒé€£çµ Debian å®˜æ–¹ç¶²ç«™ systemd-networkd How to install and configure firewalld on debian ","description":"","id":16,"section":"posts","tags":["linux","debian","server"],"title":"ä½¿ç”¨ Debian ä¾†æ¶è¨­å·¥ä½œç«™","uri":"https://e61983.github.io/2021-08-31-install-debian-11/"},{"content":"å‰è¨€ å› ç‚ºå·¥ä½œä¸Šçš„éœ€æ±‚ï¼Œæœ€è¿‘æ¥è§¸åˆ°äº† GNSS æ¨¡çµ„ã€‚\nç¶­åŸºç™¾ç§‘æ˜¯é€™æ¨£èªªçš„ã€‚\nè¡›æ˜Ÿå°èˆªç³»çµ±ï¼ˆGlobal Navigation Satellite System, GNSSï¼‰æ˜¯è¦†è“‹å…¨çƒçš„è‡ªä¸»åœ°åˆ©ç©ºé–“å®šä½çš„è¡›æ˜Ÿç³»çµ±ï¼Œå…è¨±å°å·§çš„é›»å­æ¥æ”¶å™¨ç¢ºå®šå®ƒçš„æ‰€åœ¨ä½ç½®ï¼ˆç¶“åº¦ã€ç·¯åº¦å’Œé«˜åº¦ï¼‰ï¼Œä¸¦ä¸”ç¶“ç”±è¡›æ˜Ÿå»£æ’­æ²¿è‘—è¦–ç·šæ–¹å‘å‚³é€çš„æ™‚é–“ä¿¡è™Ÿç²¾ç¢ºåˆ°10ç±³çš„ç¯„åœå…§ã€‚æ¥æ”¶æ©Ÿè¨ˆç®—çš„ç²¾ç¢ºæ™‚é–“ä»¥åŠä½ç½®ï¼Œå¯ä»¥ä½œç‚ºç§‘å­¸å¯¦é©—çš„åƒè€ƒã€‚\nä¸»è¦å…§å®¹ NEO M8N GPSæ¨¡çµ„ https://www.ruten.com.tw/item/show?21550304728186\nNEO-M8 Datasheet Page 6\nNMEA-0183 GGA è¡¨ç¤ºè©²èªå¥ç‚º GlobalPositioning System Fix Data(GGA) GPSå®šä½ä¿¡æ¯\n\u0026lt;1\u0026gt; \u0026lt;2\u0026gt; \u0026lt;3\u0026gt; \u0026lt;4\u0026gt; \u0026lt;5\u0026gt; \u0026lt;6\u0026gt; \u0026lt;7\u0026gt; \u0026lt;8\u0026gt; \u0026lt;9\u0026gt; \u0026lt;10\u0026gt; \u0026lt;11\u0026gt; \u0026lt;12\u0026gt; UTCæ™‚é–“ ç·¯åº¦ ç·¯åº¦æ–¹å‘ ç¶“åº¦ ç¶“åº¦æ–¹å‘ GPSç‹€æ…‹æŒ‡ç¤º æ­£åœ¨ä½¿ç”¨çš„è¡›æ˜Ÿæ•¸é‡ HDOPæ°´å¹³ç²¾åº¦å› å­ æµ·å¹³é¢é«˜åº¦ åœ°çƒæ©¢çƒé¢ç›¸å°å¤§åœ°æ°´æº–é¢çš„é«˜åº¦ å·®åˆ†GPSä¿¡æ¯ å·®åˆ†ç«™IDè™Ÿ GLL è¡¨ç¤ºè©²èªå¥ç‚º Geographic Position(GLL) åœ°ç†å®šä½ä¿¡æ¯\n\u0026lt;1\u0026gt; \u0026lt;2\u0026gt; \u0026lt;3\u0026gt; \u0026lt;4\u0026gt; \u0026lt;5\u0026gt; \u0026lt;6\u0026gt; \u0026lt;7\u0026gt; ç·¯åº¦ ç·¯åº¦æ–¹å‘ ç¶“åº¦ ç¶“åº¦æ–¹å‘ UTCæ™‚é–“ å®šä½ç‹€æ…‹ æ ¡é©—å€¼ GSA è¡¨ç¤ºè©²èªå¥ç‚º GPSDOP and Active Satellites(GSA) ç•¶å‰è¡›æ˜Ÿä¿¡æ¯\n\u0026lt;1\u0026gt; \u0026lt;2\u0026gt; \u0026lt;3\u0026gt; \u0026lt;4\u0026gt; \u0026lt;5\u0026gt; \u0026lt;6\u0026gt; å®šä½æ¨¡å¼ ç•¶å‰ç‹€æ…‹ PRNè™Ÿ PDOPç¶œåˆä½ç½®ç²¾åº¦å› å­ HDOPæ°´å¹³ç²¾åº¦å› å­ VDOPå‚ç›´ç²¾åº¦å› å­ GSV è¡¨ç¤ºè©²èªå¥ç‚º GPSSatellites in View(GSV) å¯è¦‹è¡›æ˜Ÿä¿¡æ¯\n\u0026lt;1\u0026gt; \u0026lt;2\u0026gt; \u0026lt;3\u0026gt; \u0026lt;4\u0026gt; \u0026lt;5\u0026gt; \u0026lt;6\u0026gt; \u0026lt;7\u0026gt; GSVèªå¥çš„ç¸½æ•¸ç›® ç•¶å‰GSVèªå¥æ•¸ç›® é¡¯ç¤ºè¡›æ˜Ÿçš„ç¸½æ•¸ç›® è¡›æ˜Ÿçš„PRNè™Ÿæ˜Ÿè™Ÿ è¡›æ˜Ÿä»°è§’ è¡›æ˜Ÿé‡è§’ ä¿¡å™ªæ¯” MSS è¡¨ç¤ºè©²èªå¥ç‚º GPSSatellites in View(GSV) å¯è¦‹è¡›æ˜Ÿä¿¡æ¯\nRMC è¡¨ç¤ºè©²èªå¥ç‚º RecommendedMinimum Specific GPS/TRANSIT Data(RMC) æ¨è–¦æœ€å°å®šä½ä¿¡æ¯\n\u0026lt;1\u0026gt; \u0026lt;2\u0026gt; \u0026lt;3\u0026gt; \u0026lt;4\u0026gt; \u0026lt;5\u0026gt; \u0026lt;6\u0026gt; \u0026lt;7\u0026gt; \u0026lt;8\u0026gt; \u0026lt;9\u0026gt; \u0026lt;10\u0026gt; \u0026lt;11\u0026gt; å®šä½æ™‚UTCæ™‚é–“ ç‹€æ…‹ ç·¯åº¦ ç·¯åº¦æ–¹å‘ ç¶“åº¦ ç¶“åº¦æ–¹å‘ é€Ÿç‡,ç¯€ æ–¹ä½è§’ ç•¶å‰UTCæ—¥æœŸ ç£åè§’ ç£åè§’æ–¹å‘ VTG è¡¨ç¤ºè©²èªå¥ç‚ºTrackMade Good and Ground Speed(VTG) åœ°é¢é€Ÿåº¦ä¿¡æ¯\n\u0026lt;1\u0026gt; \u0026lt;2\u0026gt; \u0026lt;3\u0026gt; \u0026lt;4\u0026gt; çœŸå¯¦æ–¹å‘ ç›¸å°æ–¹å‘ æ­¥é•· Knots é€Ÿç‡ km/h GNGGAï¼ŒGPGGAï¼ŒBDGGA å‚»å‚»åˆ†ä¸æ¸…æ¥š å³â€œæ··åˆå®šä½â€ï¼ˆå¤šè¡›æ˜Ÿç³»çµ±ï¼‰ã€â€œGPSå®šä½â€ã€â€œåŒ—æ–—å®šä½â€\nBD,BDS: åŒ—æ–—äºŒä»£è¡›æ˜Ÿç³»çµ± GP: GPS GL: GLONASS GA: Galileo GN: GNSS, å…¨çƒå°èˆªè¡›æ˜Ÿç³»çµ± GPSæ¨¡çµ„è¼¸å‡º é€£æ¥æ–¹å¼ ä½¿ç”¨ micro USB ç·šé€²è¡Œé€£æ¥\næŒ‡ä»¤ ç­†è€…æ˜¯åœ¨ MacOS çš„ç’°å¢ƒä¸­é€²è¡Œæ¸¬è©¦çš„ï¼Œåªè¦æ‰“é–‹çµ‚ç«¯æ©Ÿé–‹å•Ÿæ­£ç¢ºçš„è£ç½®å³å¯ã€‚\n1 screen -L /dev/tty.XXXX 9600 ç¡¬é«”è­˜åˆ¥ åœ¨é–‹å§‹æ¥æ”¶ä¹‹å¾Œï¼Œä¸€é–‹å§‹æœƒé¡¯ç¤ºè©²æ¨¡çµ„çš„ç›¸é—œè³‡è¨Š:\nU-Blox çš„æ­¡è¿è¨Šæ¯ ç¡¬é«”ç‰ˆæœ¬ åœ¨ FLASH çš„éŸŒé«”ç‰ˆæœ¬ åœ¨ ROM çš„éŸŒé«”ç‰ˆæœ¬ å‹è™Ÿ é€šè¨Šå”å®šç‰ˆæœ¬ GNSS çš„é…ç½® ç›®å‰å¤©ç·šçš„é…ç½® ç›®å‰å¤©ç·šç‹€æ…‹ FLASH è³‡è¨Šçµæ§‹é€²å…¥é» U-Blox æ¥æ”¶å™¨é…ç½® 1 2 3 4 5 6 7 8 9 10 11 $GNTXT,01,01,02,u-blox AG - www.u-blox.com*4E // U-Blox çš„æ­¡è¿è¨Šæ¯ $GNTXT,01,01,02,HW UBX-M80xx 00080000 *43 // ç¡¬é«”ç‰ˆæœ¬ $GNTXT,01,01,02,EXT CORE 2.01 (75350) Oct 29 2013 16:15:41*5C // åœ¨ FLASH çš„éŸŒé«”ç‰ˆæœ¬ $GNTXT,01,01,02,ROM BASE 2.01 (75331) Oct 29 2013 13:28:17*44 // åœ¨ ROM çš„éŸŒé«”ç‰ˆæœ¬ $GNTXT,01,01,02,MOD NEO-M8N-0*7A // å‹è™Ÿ $GNTXT,01,01,02,PROTVER 15.00*01 // é€šè¨Šå”å®šç‰ˆæœ¬ $GNTXT,01,01,02,GNSS OTP: GPS GLO, SEL: GPS GLO*67 // GNSSé…ç½® $GNTXT,01,01,02,ANTSUPERV=AC SD PDoS SR*3E // ç›®å‰å¤©ç·šçš„é…ç½® $GNTXT,01,01,02,ANTSTATUS=OK*25 // ç›®å‰å¤©ç·šç‹€æ…‹ $GNTXT,01,01,02,FIS 0xEF4015 (79189) found*2D // FLASH è³‡è¨Šçµæ§‹é€²å…¥é» $GNTXT,01,01,02,LLC FFFFFFFF-FFFFFFED-FFFFFFFF-FFFFFFFF-FFFFFF69*3E // U-Blox æ¥æ”¶å™¨é…ç½® å®šä½è³‡æ–™ 1 2 3 4 5 6 7 8 9 10 11 12 $GNRMC,054539.00,A,2524.04132,N,12130.71568,E,0.059,,200821,,,A*67 $GNVTG,,T,,M,0.059,N,0.109,K,A*39 $GNGGA,054539.00,2524.04132,N,12130.71568,E,1,09,1.82,35.1,M,17.8,M,,*75 $GNGSA,A,3,05,20,29,30,02,13,,,,,,,2.93,1.82,2.29*19 $GNGSA,A,3,87,72,71,,,,,,,,,,2.93,1.82,2.29*1A $GPGSV,4,1,13,02,63,084,43,05,49,332,43,06,26,113,,07,05,051,43*7F $GPGSV,4,2,13,11,52,086,,12,06,223,,13,76,177,21,15,46,226,16*74 $GPGSV,4,3,13,20,45,025,43,24,00,195,,25,02,252,,29,33,309,44*75 $GPGSV,4,4,13,30,21,081,42*44 $GLGSV,2,1,06,65,27,246,,71,36,015,34,72,58,301,28,85,30,146,*6B $GLGSV,2,2,06,86,79,105,,87,28,336,35*62 $GNGLL,2524.04132,N,12130.71568,E,054539.00,A,A*7B åº§æ¨™è½‰æ› ç”±æ–¼æ¨¡çµ„çš„è¼¸å‡ºæ˜¯ $ddmm.mmmmm$ æ ¼å¼ï¼Œæ‰€ä»¥æˆ‘å€‘è¦å†è‡ªè¡Œè½‰æ›ç‚º $dd.dddddd$\nè½‰æ›æ–¹å¼: $ dd + \\dfrac {mm.mmmmm}{60} $\nä¾‹:\nå‡è¨­æˆ‘å€‘æ”¶åˆ°çš„è³‡æ–™ç‚º : 2524.04132N, 12130.71568E\nè½‰æ›çš„æ–¹å¼å‰‡ç‚º $25 + \\dfrac {24.04132}{60} $, $121 + \\dfrac {30.71568}{60}$\n$ =\u0026gt; 25.4006886667, 121.511928$\nå°çµ æœ¬æ–‡åƒ…å…ˆäº†è§£ GPS æ¨¡çµ„åŸºæœ¬è¼¸å‡ºï¼Œå°šæœªé€²è¡Œé€²ä¸€æ­¥çš„æ¸¬è©¦èˆ‡ç ”ç©¶ã€‚\næ­¤å¤–GPSæ¨¡çµ„è¼¸å‡º/å®šä½è³‡æ–™ç« ç¯€çš„å®šä½åº§æ¨™ä¸¦éå¯¦éš›è³‡æ–™ã€‚\nåƒè€ƒé€£çµ NEO M8N GPSæ¨¡çµ„ å®˜æ–¹ç¶²ç«™ NEO M8N è³‡æ–™æ‰‹å†Š é€™æ‡‰è©²æ˜¯é—œæ–¼GPSå®šä½å¯«å¾—æœ€è©³å¯¦æ¸…æ™°çš„æ–‡ç« ä¹‹ä¸€ ","description":"","id":17,"section":"posts","tags":["gps"],"title":"NEO M8N GPSæ¨¡çµ„","uri":"https://e61983.github.io/2021-08-20-gps-module/"},{"content":"å‰è¨€ æœ€è¿‘é–‹å§‹æ¥è§¸åˆ°è·Ÿ GPS æœ‰é—œçš„æ±è¥¿ï¼Œæƒ³èªªé †ä¾¿æŠŠåœ°ç†å®šä½ç›¸é—œçš„è³‡æ–™æ•´ç†èµ·ä¾†ã€‚æ‰€ä»¥é€™ä¸€ç¯‡å°±é€™æ¨£èª•ç”Ÿå•¦ã€‚\nä¸»è¦å…§å®¹ åœ°è¡¨ä¸Šä»»ä½•ä¸€å€‹åœ°ç†ä½ç½®éƒ½å¯ä»¥ç”¨å¤§åœ°åŸºæº– ( Datum ) + åº§æ¨™æ ¼å¼ ( Format ) ä¾†è¡¨ç¤ºã€‚\nåœ¨å°ç£æˆ‘å€‘å¸¸è½åˆ°çš„ TWD67ã€TWD97ã€WGS84 å°±æ˜¯å¤§åœ°åŸºæº–ã€‚è€Œå¤§åœ°åº§æ¨™ã€å…­åº¦åˆ†å¸¶(UTM)ã€äºŒåº¦åˆ†å¸¶(TM2) å°±æ˜¯åº§æ¨™æ ¼å¼ã€‚\nå¤§åœ°åŸºæº– TWD67\nå¹³é¢åŸºæº–ç‚º1967å¹´ä¹‹åƒè€ƒæ©¢çƒé«”(GRS67)ï¼Œä»¥å—æŠ•åŸ”é‡Œä¹‹è™å­å±±ç‚ºå¤§åœ°åŸºæº–ã€‚\næ©¢çƒåƒæ•¸:é•·è»¸ a = 6378160mï¼Œæ‰ç‡ $f = 298.25$ TWD97\nå¹³é¢åŸºæº–ç‚º1980å¹´ä¹‹åƒè€ƒæ©¢çƒé«”(GRS80)ï¼Œä»¥å…«å€‹è¡›æ˜Ÿè¿½è¹¤ç«™ç‚ºåŸºæº–ã€‚\næ©¢çƒåƒæ•¸:é•·è»¸ a = 6378137mï¼Œæ‰ç‡ $f = 298.257222101$ WGS84\nä¸–ç•Œå¤§åœ°æ¸¬é‡ç³»çµ±ï¼ˆè‹±èªï¼šWorld Geodetic System, WGSï¼‰ï¼Œ1984å¹´çš„ç‰ˆæœ¬ï¼Œä¹Ÿç¨±ç‚º EPSG:4326ã€‚é€ééå¸ƒä¸–ç•Œçš„è¡›æ˜Ÿè§€æ¸¬ç«™è§€æ¸¬åˆ°çš„åæ¨™å»ºç«‹ï¼Œå…¶ç²¾åº¦ç‚º1~ 2mã€‚\nåœ°çƒçš„è³ªé‡ä¸­å¿ƒç‚ºä¸­å¿ƒé»ï¼ŒåŠ ä¸Šä¸–ç•Œå„åœ°çš„1500å€‹åœ°ç†åº§æ¨™åƒè€ƒé»ã€‚\næ©¢çƒåƒæ•¸:é•·è»¸ a = 6378137mï¼Œæ‰ç‡ $f = 298.257223563$ åƒè€ƒæ©¢çƒé«”\n$ a: é•·è»¸ $\n$ b: çŸ­è»¸ $\n$ f: æ‰ç‡ = \\frac{a-b}{a} $\nåº§æ¨™æ ¼å¼ å¤§åœ°åº§æ¨™\nç¶“ã€ç·¯åº¦åº§æ¨™ã€‚ä»¥åº¦ã€åˆ†ã€ç§’è¡¨ç¤ºã€‚(åƒ…èƒ½è¡¨ç¤ºä½ç½®èˆ‡æ–¹å‘ï¼Œç„¡æ³•ç›´æ¥è¡¨ç¤ºè·é›¢)\nhttps://en.wikipedia.org/wiki/Local_tangent_plane_coordinates\nå¹³é¢åº§æ¨™ (å¯ä»¥è¡¨ç¤ºè·é›¢èˆ‡é¢ç¸¾)\nhttps://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system\nå…­åº¦åˆ†å¸¶ ( Universal Transverse Mercator, UTM)\næ©«éº¥å¡æ‰˜å…­åº¦åˆ†å¸¶\näºŒåº¦åˆ†å¸¶ (TM2)\næ©«éº¥å¡æ‰˜äºŒåº¦åˆ†å¸¶\nåº§æ¨™è½‰æ› TWD97 è½‰ TWD67 (å¹³é¢å››åƒæ•¸è½‰æ›:åƒ…é©ç”¨å°ç£æœ¬å³¶ï¼Œæœ€å¤§èª¤å·®ç´„2å…¬å°º) $X_{67} =X_{97} - 807.8 - AX_{97} - BY_{97}$\n$Y_{67} = Y_{97} + 248.6 - AY_{97} - BX_{97}$\n$A = 0.00001549$\n$B = 0.000006521$\nTWD67 è½‰ TWD97 (å¹³é¢å››åƒæ•¸è½‰æ›:åƒ…é©ç”¨å°ç£æœ¬å³¶ï¼Œæœ€å¤§èª¤å·®ç´„2å…¬å°º) $X_{97} = X_{67} + 807.8 + AX_{67} + BY_{67}$\n$Y_{97} =Y_{67} - 248.6 + AY_{67} + BX_{67}$\n$A = 0.00001549$\n$B = 0.000006521$\nå¯¦ä½œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 package main import ( \u0026#34;fmt\u0026#34; \u0026#34;math\u0026#34; ) const ( a float64 = 6378137.0 b float64 = 6356752.3142451 lon0 float64 = 121 * math.Pi / 180 k0 float64 = 0.9999 dx float64 = 250000 dy float64 = 0 ) var ( e float64 = 1 - math.Pow(b, 2)/math.Pow(a, 2) e2 float64 = (1 - math.Pow(b, 2)/math.Pow(a, 2)) / (math.Pow(b, 2) / math.Pow(a, 2)) ) func LonLat2TM2(lon, lat float64) (x, y float64) { lon = (lon - math.Floor((lon+180)/360)*360) * math.Pi / 180 lat = lat * math.Pi / 180 V := a / math.Sqrt(1-e*math.Pow(math.Sin(lat), 2)) T := math.Pow(math.Tan(lat), 2) C := e2 * math.Pow(math.Cos(lat), 2) A := math.Cos(lat) * (lon - lon0) M := a * ((1.0-e/4.0-3.0*math.Pow(e, 2)/64.0-5.0*math.Pow(e, 3)/256.0)*lat - (3.0*e/8.0+3.0*math.Pow(e, 2)/32.0+45.0*math.Pow(e, 3)/1024.0)* math.Sin(2.0*lat) + (15.0*math.Pow(e, 2)/256.0+45.0*math.Pow(e, 3)/1024.0)* math.Sin(4.0*lat) - (35.0*math.Pow(e, 3)/3072.0)*math.Sin(6.0*lat)) x = dx + k0*V*(A+(1-T+C)*math.Pow(A, 3)/6+ (5-18*T+math.Pow(T, 2)+72*C-58*e2)*math.Pow(A, 5)/120) y = dy + k0*(M+V*math.Tan(lat)*(math.Pow(A, 2)/2+(5-T+9*C+4*math.Pow(C, 2))*math.Pow(A, 4)/24+ (61-58*T+math.Pow(T, 2)+600*C-330*e2)*math.Pow(A, 6)/720)) return } func TM22LonLat(x, y float64) (lon, lat float64) { x -= dx y -= dy // Calculate the Meridional Arc M := y / k0 // Calculate Footprint Latitude mu := M / (a * (1.0 - e/4.0 - 3*math.Pow(e, 2)/64.0 - 5*math.Pow(e, 3)/256.0)) e1 := (1.0 - math.Sqrt(1.0-e)) / (1.0 + math.Sqrt(1.0-e)) J1 := (3*e1/2 - 27*math.Pow(e1, 3)/32.0) J2 := (21*math.Pow(e1, 2)/16 - 55*math.Pow(e1, 4)/32.0) J3 := (151 * math.Pow(e1, 3) / 96.0) J4 := (1097 * math.Pow(e1, 4) / 512.0) fp := mu + J1*math.Sin(2*mu) + J2*math.Sin(4*mu) + J3*math.Sin(6*mu) + J4*math.Sin(8*mu) // Calculate Latitude and Longitude C1 := e2 * math.Pow(math.Cos(fp), 2) T1 := math.Pow(math.Tan(fp), 2) R1 := a * (1 - e) / math.Pow((1-e*math.Pow(math.Sin(fp), 2)), (3.0/2.0)) N1 := a / math.Pow((1-e*math.Pow(math.Sin(fp), 2)), 0.5) D := x / (N1 * k0) // è¨ˆç®—ç·¯åº¦ Q1 := N1 * math.Tan(fp) / R1 Q2 := (math.Pow(D, 2) / 2.0) Q3 := (5 + 3*T1 + 10*C1 - 4*math.Pow(C1, 2) - 9*e2) * math.Pow(D, 4) / 24.0 Q4 := (61 + 90*T1 + 298*C1 + 45*math.Pow(T1, 2) - 3*math.Pow(C1, 2) - 252*e2) * math.Pow(D, 6) / 720.0 lat = fp - Q1*(Q2-Q3+Q4) // è¨ˆç®—ç¶“åº¦ Q5 := D Q6 := (1 + 2*T1 + C1) * math.Pow(D, 3) / 6 Q7 := (5 - 2*C1 + 28*T1 - 3*math.Pow(C1, 2) + 8*e2 + 24*math.Pow(T1, 2)) * math.Pow(D, 5) / 120.0 lon = lon0 + (Q5-Q6+Q7)/math.Cos(fp) lat = (lat * 180) / math.Pi //ç·¯ lon = (lon * 180) / math.Pi //ç¶“ return } func TWD672TWD97(x, y float64) (x_97, y_97 float64) { const A float64 = 0.00001549 const B float64 = 0.000006521 x_97 = x + 807.8 + A*x + B*y y_97 = y - 248.6 + A*y + B*x return } func TWD972TWD67(x, y float64) (x_67, y_67 float64) { const A float64 = 0.00001549 const B float64 = 0.000006521 x_67 = x - 807.8 - A*x - B*y y_67 = y + 248.6 - A*y - B*x return } // References: // https://www.sunriver.com.tw/taiwanmap/grid_tm2_convert.php func main() { const x_67 float64 = 247342 const y_67 float64 = 2652336 x_97, y_97 := TWD672TWD97(x_67, y_67) fmt.Printf(\u0026#34;TWD67:\\n\u0026#34;) fmt.Printf(\u0026#34;\\t%f, %f\\n\u0026#34;, x_67, y_67) fmt.Printf(\u0026#34;TWD97:\\n\u0026#34;) fmt.Printf(\u0026#34;\\t%f, %f\\n\u0026#34;, x_97, y_97) lon, lat := TM22LonLat(x_97, y_97) fmt.Printf(\u0026#34;LonLat:\\n\u0026#34;) fmt.Printf(\u0026#34;\\t%f, %f\\n\u0026#34;, lon, lat) } /* Output: TWD67: 247342.000000, 2652336.000000 TWD97: 248170.927211, 2652130.097602 LonLat: 120.982026, 23.973876 */ å°çµ å°ç£ä½¿ç”¨çš„åº§æ¨™è¡¨ç¤ºæ³•ï¼Œæƒ³ä¸åˆ°è£¡é¢æœ‰é€™éº¼å¤šæ­·å²å¯ä»¥æ¢ç©¶ã€‚ç­†è€…çœ‹å®Œè¨±å¤šè³‡æ–™å¾Œï¼Œæ¨è–¦æœ‰èˆˆè¶£çš„åŒå­¸å¯ä»¥çœ‹ä¸€çœ‹ Taiwan datums ï¼Œè£¡é¢å¹²è²¨æ»¿æ»¿ !!\nå¦å¤–ï¼Œæœ¬æœ€å¾Œçš„å¯¦ä½œä¸»è¦æ˜¯åƒè€ƒ å¤§èƒ–å­èˆ‡å°å€‹å­çš„éƒ¨è½æ ¼ çš„ç¨‹å¼ï¼Œä¸¦ä»¥ Go æ”¹å¯«ã€‚\næ„Ÿè¬å‰äººçš„æ•´ç†èˆ‡è²¢ç»!\nåƒè€ƒé€£çµ å¤§åœ°åº§æ¨™ç³»çµ±æ¼«è«‡ Taiwan datums å¤§èƒ–å­èˆ‡å°å€‹å­çš„éƒ¨è½æ ¼ åœ‹ç«‹æˆåŠŸå¤§å­¸æ°´å·¥è©¦é©—æ‰€ åæ¨™ç³»çµ± ","description":"","id":18,"section":"posts","tags":["geo","gps","go"],"title":"åœ¨å°ç£å¸¸è¦‹çš„åœ°ç†ä½ç½®è¡¨ç¤ºæ–¹å¼","uri":"https://e61983.github.io/2021-08-19-gps-format/"},{"content":"å‰è¨€ ç¹¼å…ˆå‰å»ºç«‹å¥½åŸºæ¥šçš„ç³»çµ±å¾Œï¼Œæˆ‘å€‘å·²ç¶“åŠ å…¥äº† bootlinlabs machineã€‚\næœ¬æ–‡æœƒæ¥çºŒä¹‹å‰å»ºç«‹çš„ç’°å¢ƒï¼Œé–‹å§‹åŠ å…¥è‡ªè¨‚çš„ Imageã€‚\nä¸»è¦å…§å®¹ Image Image å°±æ˜¯ root filesystemã€‚å®ƒæœƒæ”¾ç½®æ–¼ meta*/recipes*/images/*.bb ä¸­ã€‚\nPoky é è¨­çš„ Image core-image-base\nåªæä¾› Console çš„ç’°å¢ƒï¼Œä¸¦ä¸”æ”¯æ´æ‰€æœ‰ç¡¬é«”åŠŸèƒ½ã€‚ core-image-minimal\nåªæä¾› Console çš„ç’°å¢ƒï¼Œä¸¦ä¸”åªæ»¿è¶³é–‹æ©Ÿçš„é ˆæ±‚ã€‚ core-image-minimal-dev\nåŒ core-image-minimalï¼Œä½†åˆæ”¯æ´é¡å¤–çš„é–‹ç™¼ç”¨å·¥å…·ã€‚ core-image-x11\næä¾› X11 åœ–å½¢åŒ–ä»‹é¢ã€‚ core-iamge-rt\nåŒ core-image-minimal, ä½†é¡å¤–æä¾› Real Time ç›¸é—œå·¥å…·ã€‚ Image å¸¸è¦‹çš„é…ç½®é … IMAGE_BASENAME\nè¼¸å‡ºçš„æ˜ åƒæª”åç¨±ï¼Œé è¨­ç‚º ${PN} IMAGE_INSTALL\nè¦å®‰è£æ–¼æ­¤æ˜ åƒæª”çš„ Package / Package groups IMAGE_ROOTFS_SIZE\næœ€çµ‚çš„ Root filesystem å¤§å° IMAGE_FEATURES\næä¾›çš„ç‰¹æ€§æ¸…å–® IMAGE_FSTYPES\nè¦ç”¢ç”Ÿçš„æ˜ åƒæª”ç¨®é¡ï¼Œä¾‹: ext2, ext3, squashfs, cpio, jffs2, ubifs, \u0026hellip; ç­‰ã€‚\nå¯åƒè€ƒ meta/classes/image_types.bbclass IMAGE_LINGUAS\næ­¤æ˜ åƒæª”æ‰€æ”¯æ´çš„èªè¨€ IMAGE_PKGTYPE\næ­¤æ˜ åƒæª”æ‰€ä½¿ç”¨çš„å¥—ä»¶å®‰è£ç¨®é¡ï¼Œä¾‹: deb, rpm, ipk, tar IMAGE_POSTPROCESS_COMMAND\nåœ¨æœ€å¾Œæƒ³è¦åŸ·è¡Œçš„ shell æŒ‡ä»¤ WIC wic æ˜¯ä¸€å€‹ç”¨ä¾†å»ºç½®å¯ç‡’å¯«çš„æ˜ åƒæª”ã€‚å®ƒå¯ä»¥é€é .wks æˆ–æ˜¯ .wks.in ä¾†å»ºç«‹åˆ†éš”å€ã€æŒ‡å®šæª”æ¡ˆä½ç½®ã€‚\nç›¸é—œçš„é…ç½®å¦‚:\n1 2 WKS_FILE = \u0026#34;imx-uboot-custom.wks.in\u0026#34; IMAGE_FSTYPES = \u0026#34;wic.bmp wic\u0026#34; imx-uboot-custom.wks.in:\n1 2 3 4 5 6 part u-boot --source rawcopy --sourceparams=\u0026#34;file=imx-boot\u0026#34; --ondisk sda --no-table --align ${IMX_BOOT_SEEK} part /boot --source bootimg-partition --ondisk sda --fstype=vfat --label boot --active --align 8192 --size 64 part / --source rootfs --ondisk sda --fstype=ext4 --label root --exclude-path=home/ --exclude-path=opt/ --align 8192 part /home --source rootfs --rootfs-dir=${IMAGE_ROOTFS}/home --ondisk sda --fstype=ext4 --label home --align 8192 part /opt --source rootfs --rootfs-dir=${IMAGE_ROOTFS}/opt --ondisk sda --fstype=ext4 --label opt --align 8192 bootloader --ptable msdos Package Groups ç”¨ä¾†å°‡ Package ä¾å…¶åŠŸèƒ½é€²è¡Œåˆ†é¡ã€‚é€šå¸¸æˆ‘å€‘å¯ä»¥åœ¨ meta*/recipes-core/packagegroups/ æ‰¾åˆ°ï¼Œå®ƒå€‘æœƒæ˜¯ä»¥ packagegroup- åšç‚ºå‰ç¶´ä¾†å‘½åã€‚å¦‚: packagegroup-core-bootï¼Œpackagegroup-core-nfs-serverã€‚\nå¯¦éš›æ’°å¯«æ™‚ï¼Œåªè¦ç¹¼æ‰¿ packagegroup å³å¯ã€‚ä¾‹:\n1 2 3 4 5 6 7 SUMMARY = \u0026#34;Debugging tools\u0026#34; LICENSE = \u0026#34;MIT\u0026#34; inherit packagegroup RDEPENDS_${PN} = \u0026#34;\\ gdb \\ gdbserver \\ strace\u0026#34; å»ºç«‹ bootlinlabs-image-minimal 1 2 3 4 5 6 7 8 pushd ./meta-bootlinlabs mkdir -p recipes-image/images echo \u0026#39;IMAGE_INSTALL = \u0026#34;packagegroup-core-boot\u0026#34;\u0026#39; \u0026gt;\u0026gt; recipes-image/images/bootlinlabs-image-minimal.bb echo \u0026#39;inherit core-image\u0026#39; \u0026gt;\u0026gt; recipes-image/images/bootlinlabs-image-minimal.bb echo \u0026#39;\u0026#39; \u0026gt;\u0026gt; recipes-image/images/bootlinlabs-image-minimal.bb echo \u0026#39;IMAGE_INSTALL_append = \u0026#34; dropbear ninvaders\u0026#34;\u0026#39; \u0026gt;\u0026gt; recipes-image/images/bootlinlabs-image-minimal.bb popd bitbake bootlinlabs-image-minimal æ›´æ–° NFS åˆ†äº«ç›®éŒ„\nsudo tar xpf tmp/deploy/images/bootlinlabs/bootlinlabs-image-minimal-stm32mp1.tar.xz -C /nfs_shared/ é‡æ–°å•Ÿé‡ STM32MP1\nbootlinlabs-image-minimal\nå°çµ åƒè€ƒé€£çµ Customizing Images using Custom bb Files Bootlin/Yocto with STM32 Bootlin/Yocto with STM32 Lab ","description":"","id":19,"section":"posts","tags":["stm32mp1","yocto","linux"],"title":"åœ¨ STM32MP1 ä¸Šä½¿ç”¨ Yocto å»ºç½® Linux ç³»çµ± 4","uri":"https://e61983.github.io/2021-08-12-stm32mp-with-yocto-4/"},{"content":"å‰è¨€ ç¹¼å…ˆå‰å»ºç«‹å¥½åŸºæ¥šçš„ç³»çµ±å¾Œï¼Œæˆ‘å€‘å·²ç¶“åŠ å…¥äº† meta-bootlinlabs Layerã€‚\næœ¬æ–‡æœƒæ¥çºŒä¹‹å‰å»ºç«‹çš„ç’°å¢ƒï¼Œé–‹å§‹åŠ å…¥è‡ªè¨‚çš„ Machineã€‚\nä¸»è¦å…§å®¹ BSP Layer BSP Layer æ˜¯ Layer çš„ä¸€ç¨®ï¼Œå®ƒé€šå¸¸æœƒåŒ…å«ç›®æ¨™æ©Ÿå™¨çš„ç¡¬é«”é…ç½®ã€Bootloaderã€Kernelã€Display Supportã€‚å¸¸ä»¥ meta-\u0026lt;bsp-name\u0026gt; å‘½åï¼Œè£¡é¢æœƒæœ‰ machnes è³‡æ–™å¤¾ã€‚\nå¦‚æœæˆ‘å€‘æƒ³çŸ¥é“è©² BSP Layer å®ƒæ”¯æ´äº†å“ªäº›æ©Ÿå™¨ï¼Œæˆ‘å€‘å¯ä»¥åœ¨è©² Layer ä¸­ï¼Œè§€å¯Ÿå®ƒçš„ conf/machine/*.confã€‚\nç›®æ¨™æ©Ÿå™¨çš„é…ç½®æª”æœƒä»¥ MACHINE.conf å‘½åã€‚\nä½†æ›´å¥½çš„æ–¹å¼æ˜¯ï¼Œè©² BSP Layer æœ‰å®Œå–„çš„ READMEï¼Œè®“æˆ‘å€‘å¯ä»¥ç›´æ¥åƒè€ƒã€‚\nMachine å¸¸è¦‹çš„é…ç½®é … TARGET_ARCH\nè©²æ©Ÿå™¨çš„ç¡¬é«”æ¶æ§‹ï¼Œä¾‹: arm, aarch64 PREFERRED_PROVIDER_virtual/kernel\né è¨­ä½¿ç”¨çš„ Kernel MACHINE_FEATURES\næä¾›çš„ç¡¬é«”ç‰¹æ€§æ¸…å–®ï¼Œä¾‹: usbgadget, usbhost, screen, wifi, bluetooth SERIAL_CONSOLES\nè¦ä½¿ç”¨çš„åºåˆ—åŸ èˆ‡é€šè¨Šé€Ÿåº¦ï¼Œå®ƒæœƒè¢«å‚³çµ¦Kernel åšç‚º console çš„åƒæ•¸ã€‚ä¾‹: 115200;ttyS0 KERNEL_IMAGETYPE\nè¦ç·¨è­¯çš„æ˜ åƒæª”ç¨®é¡ï¼Œä¾‹: zImage, uImage Bootloader å¸¸è¦‹çš„é…ç½®é … SPL_BINARY\nå¦‚æœæœ‰ SPL (Secondary Program Loader)ï¼ŒæŒ‡å®šæ­¤ SPL çš„åç¨±ã€‚é è¨­æ˜¯ç©ºå­—ä¸²ã€‚ UBOOT_SUFFIX\nUBOOTçš„å¾Œç¶´ï¼Œä¾‹: imgã€‚é è¨­æ˜¯ binã€‚ UBOOT_MACHINE\nç›®å‰æ©Ÿå™¨æ‰€ä½¿ç”¨çš„é…ç½®æª”ã€‚ UBOOT_ENTRYPOINT\nBootloader çš„é€²å…¥é»ã€‚ä¾‹: 0xC0800000 UBOOT_LOADADDRESS\nBootloader è¼‰å…¥ä½ç½®ã€‚ UBOOT_MAKE_TARGET\nMakefile çš„ç›®æ¨™ï¼Œé è¨­æ˜¯ all Kernel å¸¸è¦‹çš„é…ç½®é … Kernel çš„é…ç½®ä¹Ÿæœƒæ’°å¯«åœ¨ \u0026lt;machine\u0026gt;.conf ä¸­\nPREFERRED_PROVIDER_virtual/kernel\næŒ‡å®šè¦ä½¿ç”¨çš„ Kerenl Package PREFERRED_VERSION_linux-yocto = \u0026ldquo;5.10%\u0026rdquo;\næŒ‡å®šè¦ä½¿ç”¨çš„ç‰ˆæœ¬ SRC_URL\nå¿…é ˆæä¾› Kernel é…ç½®æª”ï¼Œä¸¦å‘½åç‚º defconfigã€‚ SRC_URL += \u0026#34;file://defconfig\t\\ file://nand-support.cfg\t\\ file://ethernet-support.cfg \\ \u0026#34; Kernel Metadata å¸¸è¦‹çš„é…ç½®é … LINUX_KERNEL_TYPE standard (é è¨­) tiny preempt-rt KERNEL_FEATURES\næä¾›çš„ Kernel ç‰¹æ€§æ¸…å–® è³‡æ–™å¤¾çµæ§‹\nbsp/ cfg/ features/\nä¾‹: features/smp.scc\nKERNEL_FEATURES += \u0026ldquo;features/smp.scc\u0026rdquo; 1 2 3 define KFEATURE_DESCRIPTION \u0026#34;Enable SMP\u0026#34; kconf hardware smp.cfg patch smp-support.patch ktypes/ patches/ èª¿æ•´ Kernel é…ç½® èª¿æ•´ Kernel é…ç½®æ™‚ï¼Œæˆ‘å€‘å¯ä»¥ä»¥æä¾› defconfig çš„æ–¹å¼é€²è¡Œã€‚æˆ–æ˜¯æä¾› Configure Fragments é€²è¡Œèª¿æ•´ã€‚\næä¾› defconfig 1 2 3 4 5 6 7 8 9 10 # é…ç½® Kernel bitbake -c kernel_configme linux-yocto # æ‰‹å‹•èª¿æ•´ Kernel é¸é … bitbake -c menuconfig linux-yocto # ç”¢ç”Ÿ .config bitbake -c savedefconfig linux-yocto # æˆ‘å€‘å†è‡ªè¡Œå°‡ .confg å­˜ç‚º defconfig æä¾› Configure Fragments 1 2 3 4 5 6 7 8 9 10 11 # é…ç½® Kernel bitbake -c kernel_configme linux-yocto # æ‰‹å‹•èª¿æ•´ Kernel é¸é … bitbake -c menuconfig linux-yocto # ç”¢ç”Ÿ Configure Fragments bitbake -c diffconfig linux-yocto # ç¢ºèª Configure Fragments æ˜¯å¦æœ‰æ­£ç¢ºè¢«å¥—ç”¨ bitbake -c kernel_configcheck -f linux-yocto å»ºç«‹ bootlinlabs Machine æˆ‘å€‘å¯ä»¥åƒè€ƒ meta-st-stm32mp/conf/machine çš„é…ç½®é€²è¡Œ bootlinlabs Machine çš„å»ºç«‹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 pushd ../meta-bootlinlabs # å»ºç«‹ machine è³‡æ–™å¤¾ mkdir conf/machine # å»ºç«‹ bootlinlabs é…ç½®æª” echo \u0026#39;require conf/machine/include/st-machine-common-stm32mp.inc\u0026#39; \u0026gt;\u0026gt; conf/machine/bootlinlabs.conf echo \u0026#39;require conf/machine/include/st-machine-providers-stm32mp.inc\u0026#39; \u0026gt;\u0026gt; conf/machine/bootlinlabs.conf echo \u0026#39;\u0026#39; \u0026gt;\u0026gt; conf/machine/bootlinlabs.conf echo \u0026#39;DEFAULTTUNE = \u0026#34;cortexa7thf-neon-vfpv4\u0026#34;\u0026#39; \u0026gt;\u0026gt; conf/machine/bootlinlabs.conf echo \u0026#39;require conf/machine/include/tune-cortexa7.inc\u0026#39; \u0026gt;\u0026gt; conf/machine/bootlinlabs.conf echo \u0026#39;\u0026#39; \u0026gt;\u0026gt; conf/machine/bootlinlabs.conf echo \u0026#39;BOOTSCHEME_LABELS += \u0026#34;trusted\u0026#34;\u0026#39; \u0026gt;\u0026gt; conf/machine/bootlinlabs.conf echo \u0026#39;STM32MP_DT_FILES_DK += \u0026#34;stm32mp157f-dk2\u0026#34;\u0026#39; \u0026gt;\u0026gt; conf/machine/bootlinlabs.conf echo \u0026#39;FLASHLAYOUT_CONFIG_LABELS += \u0026#34;sdcard\u0026#34;\u0026#39; \u0026gt;\u0026gt; conf/machine/bootlinlabs.conf popd ä¿®æ”¹ conf/local.conf å…§çš„ MACHINEï¼Œä¸¦é‡æ–°ç·¨è­¯ã€‚\n1 2 sed -i \u0026#39;s/^MACHINE.*/MACHINE ?= \u0026#34;bootlinlabs\u0026#34;/g\u0026#39; conf/local.conf bitbake core-image-minimal æˆ‘å€‘å¯ä»¥åœ¨ ${BUILDDIR}/tmp/deploy/images/**bootlinlabs**/ çœ‹åˆ°æˆ‘å€‘æ‰€å»ºç«‹çš„æ–° Machineã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 $ ls tmp/deploy/images/bootlinlabs/ arm-trusted-firmware bootloader core-image-minimal-bootlinlabs-20210812144202_nand_4_256_multivolume.rootfs.ubi core-image-minimal-bootlinlabs-20210812144202_nand_4_256_multivolume.ubinize.cfg.ubi core-image-minimal-bootlinlabs-20210812144202_nand_4_256.rootfs.ubi core-image-minimal-bootlinlabs-20210812144202_nand_4_256.rootfs.ubifs core-image-minimal-bootlinlabs-20210812144202_nand_4_256.ubinize.cfg.ubi core-image-minimal-bootlinlabs-20210812144202.rootfs.ext4 core-image-minimal-bootlinlabs-20210812144202.rootfs.manifest core-image-minimal-bootlinlabs-20210812144202.rootfs.tar.xz core-image-minimal-bootlinlabs-20210812144202.testdata.json core-image-minimal-bootlinlabs.ext4 core-image-minimal-bootlinlabs.manifest core-image-minimal-bootlinlabs_nand_4_256_multivolume.ubi core-image-minimal-bootlinlabs_nand_4_256_multivolume.ubinize.cfg.ubi core-image-minimal-bootlinlabs_nand_4_256.ubi core-image-minimal-bootlinlabs_nand_4_256.ubifs core-image-minimal-bootlinlabs_nand_4_256.ubinize.cfg.ubi core-image-minimal-bootlinlabs.tar.xz core-image-minimal-bootlinlabs.testdata.json flashlayout_core-image-minimal kernel scripts Distro Layer é€šå¸¸ Distro Layer æœƒåŒ…å« Libcï¼Œinitialization script, splash screen, \u0026hellip; ç­‰, ç›¸é—œçš„é…ç½®æœƒè¨˜éŒ„åœ¨ conf/distro/\u0026lt;distro\u0026gt;.conf ä¸­ã€‚\nåœ¨ \u0026lt;distro\u0026gt;.conf ä¸­å¿…é ˆåŒ…å« DISTRO è®Šæ•¸ã€‚ä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 require conf/distro/poky.conf DISTRO = \u0026#34;distro\u0026#34; DISTRO_NAME = \u0026#34;distro description\u0026#34; DISTRO_VERSTION = \u0026#34;1.0\u0026#34; MAINTAINER = \u0026#34;...\u0026#34; # æä¾›çš„ç‰¹æ€§æ¸…å–® DISTRO_FEATURES = \u0026#34;...\u0026#34; # æä¾›çš„ç‰¹æ€§æ¸…å–®ï¼Œå®ƒåŒæ™‚æœƒä½œç”¨åœ¨ MACHINE_FEATURES COMBINED_FEATURES = \u0026#34;...\u0026#34; # Toolchain TCMODE = \u0026#34;...\u0026#34; å°çµ æœ¬æ¬¡å¯¦åšçš„éƒ¨ä»½æ¯”è¼ƒå°‘ï¼Œé‡å¿ƒä¸»è¦æ”¾åœ¨ç­è§£ machineï¼Œdistro çš„é…ç½®ã€‚\nåƒè€ƒé€£çµ Bootlin/Yocto with STM32 Bootlin/Yocto with STM32 Lab ","description":"","id":20,"section":"posts","tags":["stm32mp1","yocto","linux"],"title":"åœ¨ STM32MP1 ä¸Šä½¿ç”¨ Yocto å»ºç½® Linux ç³»çµ± 3","uri":"https://e61983.github.io/2021-08-12-stm32mp-with-yocto-3/"},{"content":"å‰è¨€ ç¹¼å…ˆå‰å»ºç«‹å¥½åŸºæ¥šçš„ç³»çµ±å¾Œï¼Œæˆ‘å€‘å·²ç¶“å¯ä»¥é †åˆ©é–‹æ©Ÿï¼Œä¸¦å¾ NFS è¼‰å…¥ rootf filesystemã€‚\næœ¬æ–‡æœƒæ¥çºŒä¹‹å‰å»ºç«‹çš„ç’°å¢ƒï¼Œé–‹å§‹åŠ å…¥è‡ªè£½çš„ç¨‹å¼ä»¥åŠè‡ªè¨‚çš„ Layerã€‚\nä¸»è¦å…§å®¹ Recipe Recipe æ˜¯ä»¥ \u0026lt;APPLICATION_NAME\u0026gt;_\u0026lt;VERSION\u0026gt;.bb çš„æ–¹å¼å‘½åã€‚è£¡é¢æœƒåŒ…å«é€™å€‹ Package è©²å¦‚ä½•ã€Œç©«å–æºå§‹ç¢¼ã€Patchã€ç·¨è­¯ã€å®‰è£ã€çš„æ–¹æ³•ã€å®ƒçš„æˆæ¬Šæ–¹å¼ä»¥åŠå®ƒçš„ç›¸ä¾å¥—ä»¶/Packageã€‚\nç‚ºäº†ç°¡åŒ– Recipe ä»¥åŠé¿å…éå¤šçš„é‡è¤‡ï¼Œæˆ‘å€‘å¯ä»¥å°‡å…±åŒçš„éƒ¨ä»½æ’°å¯«åœ¨ \u0026lt;APPLICATION\u0026gt;.inc ä¸¦åœ¨ Recipe ä¸­å¼•ç”¨ã€‚\nå¸¸è¦‹çš„é…ç½®é … DESCRIPTION\nèªªæ˜ã€ä»‹ç´¹æ­¤ Package\nHOMEPAGE\nå¦‚æœæ­¤ Package çš„å°ˆæ¡ˆæœ‰ä»‹ç´¹ç¶²ç«™çš„è©±ï¼Œå¯ä»¥å¯«åœ¨æ­¤\nPRIORITY\né è¨­æ˜¯: optional\nSECTION\né€™å€‹ Package çš„åˆ†é¡ã€‚ä¾‹: console/utils\nLICENSE\né€™å€‹ Package çš„æˆæ¬Šæ–¹å¼\nSRC_URL\né€™å€‹ Package æºå§‹ç¢¼ä½ç½®\nå®ƒçš„æ ¼å¼ç‚º: scheme://\u0026lt;ur\u0026gt;l;param1;param2\nscheme å¯ä»¥æ˜¯ https, git, svn, hg, ftp, file, \u0026hellip;\nSRC_URL[md5sum], SRC_URL[sha256sum]\næºå§‹ç¢¼çš„æª¢æŸ¥ç¢¼è¨­ç½®ã€‚\nä¾‹:\nSRC_URI = \u0026ldquo;http://example.com/src.tar.bz2;name=tarball\u0026quot;\nSRC_URI[tarball.md5sum] = \u0026ldquo;97b2c3fb082241ab5c56\u0026hellip;\u0026rdquo; git scheme:\ngit:\u0026lt;url\u0026gt;;protocol=\u0026lt;protocol\u0026gt;;branch=\u0026lt;branch\u0026gt; http,https,ftp:\nhttps://\u0026lt;url\u0026gt;\nä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€äº›è®Šæ•¸ä¾†è¨­ç½®ä½ç½®ï¼Œä¾‹: ${SOURCEFORGE_MIRROR}/\u0026lt;project-name\u0026gt;/${PN}-${PV}.tar.gz\nè©³ç´°è³‡è¨Šå¯ä»¥åƒè€ƒ meta/conf/bitbake.conf S\nç²å–å¾Œã€è§£å£“ç¸®å¾Œçš„æºå§‹ç¢¼è·¯ç›®éŒ„ã€‚é€šå¸¸æœƒé…ç½®ç‚º ${WORKDIR}\nå¦‚æœæ˜¯ä½¿ç”¨ git ä¾†ç²å–ç¨‹å¼ç¢¼ï¼Œå‰‡ä¸€å®šè¦è¨­ç½®æˆ ${WORKDIR}/git\nFILESPATH\næœ¬æ©Ÿæª”æ¡ˆçš„æœå°‹è·¯å¾‘ã€‚\n1 2 FILESPATH = \u0026#34;${@base_set_filespath([\u0026#34;${FILE_DIRNAME}/${BP}\u0026#34;, \u0026#34;${FILE_DIRNAME}/${BPN}\u0026#34;,\u0026#34;${FILE_DIRNAME}/files\u0026#34;], d)}\u0026#34; FILESOVERRIDES\næœ¬æ©Ÿæª”æ¡ˆçš„æœå°‹è·¯å¾‘ã€‚\n1 FILESOVERRIDES = \u0026#34;${TRANSLATED_TARGET_ARCH}:${MACHINEOVERRIDES}:${DISTROOVERRIDES}\u0026#34; LIC_FILES_CHKSUM\n1 2 3 LIC_FILES_CHKSUM = \u0026#34;file://gpl.txt;md5=393a5ca...\u0026#34; LIC_FILES_CHKSUM = \u0026#34;file://main.c;beginline=3;endline=21;md5=58e...\u0026#34; LIC_FILES_CHKSUM = \u0026#34;file://${COMMON_LICENSE_DIR}/MIT;md5=083...\u0026#34; DEPENDS\nåœ¨ç·¨è­¯æ™‚æœŸçš„ç›¸ä¾å¥—ä»¶/Packageã€‚\n1 2 DEPENDS = \u0026#34;recipe-b\u0026#34; DEPENDS = \u0026#34;recipe-b (\u0026gt;= 1.2)\u0026#34; RDEPENDS\nåœ¨åŸ·è¡Œæ™‚æœŸçš„ç›¸ä¾å¥—ä»¶/Packageã€‚\n1 2 RDEPENDS_${PN} = \u0026#34;recipe-b\u0026#34; RDEPENDS_${PN} = \u0026#34;recipe-b (\u0026gt; 1.2)\u0026#34; å¸¸è¦‹çš„è®Šæ•¸ PN\nè¡¨ç¤º Package Name BPN\nç§»é™¤ PN çš„å‰ç¶´èˆ‡å¾Œç¶´ã€‚ä¾‹: nativesdk- æˆ–æ˜¯ -nativeã€‚ PV\nè¡¨ç¤º Package Version PR\nè¡¨ç¤º Package Revisionã€‚é è¨­æ˜¯: r0 BP\nè¡¨ç¤º ${BPN}-${PV} WORKDIR\nè¡¨ç¤º Recipe å·¥ä½œæ™‚æœŸçš„ç›®éŒ„ D\nè¡¨ç¤ºå®‰è£æ™‚çš„ç›®æ¨™ç›®éŒ„ 1 2 3 4 do_install() { install -d ${D}${bindir} install -m 0755 hello ${D}${bindir} } Task åœ¨ Recipe ä¸­æœ‰è¨±çš„é è¨­çš„ taskï¼Œæˆ‘å€‘å¯ä»¥è‡ªè¨‚ã€ä¿®æ”¹å®ƒå€‘ä¾†æ»¿è¶³æˆ‘å€‘çš„éœ€æ±‚ã€‚\ndo_fetch do_unpack do_patch do_configure do_compile do_install do_package do_rootfs æˆ‘å€‘å¯ä»¥ä½¿ç”¨ä¸‹åˆ—æŒ‡ä»¤ä¾†é¡¯ç¤ºè©² Recipe æœ‰å“ªäº› Task\nbitbake \u0026lt;recipe\u0026gt; -c listtasks åŠ å…¥è‡ªè¨‚çš„ Task 1 2 3 4 do_mkimage() { uboot-mkimage ... } addtask do_mkimage after do_compile before do_install Example Recipe ä¸‹åˆ—æ˜¯ä¸€å€‹ Recipe çš„ç¯„ä¾‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 DESCRIPTION = \u0026#34;Hello world program\u0026#34; HOMEPAGE = \u0026#34;http://example.net/hello/\u0026#34; PRIORITY = \u0026#34;optional\u0026#34; SECTION = \u0026#34;examples\u0026#34; LICENSE = \u0026#34;CLOSED\u0026#34; LIC_FILES_CHKSUM = \u0026#34;\u0026#34; FILESOVERRIDES_prepend := \u0026#34;${THISDIR}/${PN}_${PV}:\u0026#34; SRC_URI = \u0026#34; \\ file://main.c \\ file://Makefile \\ \u0026#34; S = \u0026#34;${WORKDIR}\u0026#34; do_configure () { } do_compile () { oe_runmake } do_install () { oe_runmake install \u0026#39;DESTDIR=${D}\u0026#39; } æˆ‘å€‘å¯ä»¥é€éä¸‹åˆ—æŒ‡ä»¤ä¾†çœ‹åˆ°ç·¨è­¯æ™‚æœŸ pacakge çš„é…ç½®ã€‚\n1 bitbake -e `\u0026lt;package\u0026gt;` æˆ‘å€‘ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹åˆ—æŒ‡ä»¤ä¾†å–šå‡ºç·¨è­¯ç’°å¢ƒé€²è¡Œæ“ä½œã€‚\n1 bitbake -c devshell `\u0026lt;package\u0026gt;` æ“´å±• Recipe é€šå¸¸ä¸å»ºè­°ç›´æ¥ä¿®æ”¹ä¸Šæ¸¸çš„é…ç½®ï¼Œä½†å¸¸å¸¸æˆ‘å€‘åˆæœƒé‡åˆ°éœ€è¦èª¿æ•´ç¨‹å¼çš„éœ€æ±‚ã€‚é€™æ™‚å€™æˆ‘å€‘å¯ä»¥ä½¿ç”¨ Recipe Extension (.bbappend)ã€‚\nå®ƒçš„å‘½åæ–¹å¼ç‚º \u0026lt;appliction\u0026gt;_\u0026lt;version\u0026gt;.bbappend\nrecipe-b_%.bbappend:\né€™è¦çš„ % ç‚ºè¬ç”¨å­—å…ƒï¼Œåœ¨æ­¤ä»£è¡¨ä»»æ„ç‰ˆæœ¬ã€‚\n1 2 3 4 FILESEXTRAPATHS_prepend := \u0026#34;${THISDIR}/files:\u0026#34; SRC_URI += \u0026#34;file://custom-modification-0.patch \\ file://custom-modification-1.patch \\ \u0026#34; è‡ªè¨‚ Virtual Packages æˆ‘å€‘å¯ä»¥é€é PROVIDES = \u0026quot;virtual/\u0026lt;package\u0026gt;\u0026quot; ä¾†è¡¨ç¤ºã€‚\nClass æˆ‘å€‘å¯ä»¥æå‡ºå…±åŒçš„é…ç½®ï¼Œæ’°å¯«æˆ .bbclass ã€‚åœ¨ä¸åŒçš„ Recipe è¦ä½¿ç”¨æ™‚ï¼Œå°±å¯ä»¥ä»¥ inherit \u0026lt;class\u0026gt; ä¾†ä½¿ç”¨å®ƒã€‚\nå¸¸è¦‹åˆ°åœ°æ–¹æœ‰ Build Systemã€‚ä¾‹: cmake, make, autotools, \u0026hellip;ã€‚æ›´å¤šæˆ‘å€‘å¯ä»¥åœ¨ meta/classes ä¸­æ‰¾åˆ°\nBase Class å·²åŒ…å«äº† fetch, unpack, compile, \u0026hellip; ç­‰ Taskã€‚å¯ä»¥ä½¿ç”¨ oe_runmake ä¸¦é€é EXTRA_OEMAKE ä¾†æŒ‡å®šåƒæ•¸ã€‚\nKernel Class ç”¨ä¾†å»ºç½® Linux Kernel çš„ Classã€‚å®ƒå·²é…ç½®äº† PROVIDEï¼Œä¸¦ä¸”å¯ä»¥ä½¿ç”¨ä¸‹åˆ—å¹¾å€‹è®Šæ•¸:\nKERNEL_IMAGETYPE KERNEL_EXTRA_ARGS INITRAMFS_IMAGE Useradd Class ç”¨ä¾†æ–°å¢ç³»çµ±çš„ä½¿ç”¨è€…ã€‚åœ¨ä½¿ç”¨çš„æ™‚å€™å¿…é ˆæŒ‡å®š USERADD_PACKAGESï¼Œè©³æƒ…å¯åƒè€ƒ useradd-example.bbã€‚\næˆ‘å€‘å¯ä»¥é€é USERADD_PARAM èˆ‡ GROUPADD_PARAM ä¾†å‚³éåƒæ•¸çµ¦ useradd åŠ groupadd\nä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12 DESCRIPTION = \u0026#34;useradd class usage example\u0026#34; PRIORITY = \u0026#34;optional\u0026#34; SECTION = \u0026#34;examples\u0026#34; LICENSE = \u0026#34;MIT\u0026#34; SRC_URI = \u0026#34;file://file0\u0026#34; LIC_FILES_CHKSUM = \u0026#34;file://${COREBASE}/meta/files/common-licenses/MIT;md5=0835ade698e0bc...\u0026#34; inherit useradd USERADD_PACKAGES = \u0026#34;${PN}\u0026#34; USERADD_PARAM = \u0026#34;-u 1000 -d /home/user0 -s /bin/bash user0\u0026#34; do_install() { install -m 644 file0 ${D}/home/user0/ chown user0:user0 ${D}/home/user0/file0 } Layer Layer æ˜¯ä»¥ meta-\u0026lt;LAYER_NAME\u0026gt; çš„æ–¹å¼å‘½åã€‚è£¡é¢æœƒåŒ…å«é€™å€‹ä¸€å€‹æˆ–æ•¸å€‹ Recipeã€‚\nBitbake æœƒç²å– ${BUILDDIR}/conf/bblayers.conf ä¸­æ¯å€‹ Layer çš„é…ç½®ï¼Œé€²è€Œé–‹å§‹å»ºç½®ç³»çµ±ã€‚\næ‰€ä»¥ï¼Œå¦‚æœæˆ‘å€‘æƒ³è¦åŠ å…¥ Layer æ™‚ï¼Œå¿…é ˆå°‡å…¶åŠ å…¥è‡³ BBLAYERS è®Šæ•¸ä¸­ã€‚\nmeta-bootlinlabs å»ºç«‹ meta-bootlinlabs ä¸¦åŠ å…¥ BBLAYERS ä¸­ã€‚\n1 2 3 cd ${BUILDDIR} bitbake-layers create-layer -p 7 ../meta-bootlinlabs bitbake-layers add-layer ../meta-bootlinlabs/ åŠ å…¥ recipe-ninvaders 1 2 3 4 5 pushd ../meta-bootlinlabs mkdir -p recipes-ninvaders/ninvaders recipetool create -o recipes-ninvaders/ninvaders/ninvaders_git.bb https://github.com/TheZ3ro/ninvaders popd bitbake ninvaders ç­†è€…åœ¨ç·¨è­¯æ™‚é‡åˆ°äº†ä¸‹åˆ—éŒ¯èª¤ï¼Œå¦‚æœæœ‰åŒå­¸ä¹Ÿé‡åˆ°ç›¸åŒçš„å•é¡Œï¼Œå¯ä»¥é€²è¡Œä¸‹åˆ—æåˆ°çš„ä¿®æ”¹ã€‚\nERROR: ninvaders-1.0+gitAUTOINC+c6ab4117ba-r0 do_compile: oe_runmake failed\nERROR: ninvaders-1.0+gitAUTOINC+c6ab4117ba-r0 do_compile: Execution of \u0026lsquo;/home/yuan/workspace/yocto-stm32-labs/build/tmp/work/cortexa7t2hf-neon-vfpv4-poky-linux-gnueabi/ninvaders/1.0+gitAUTOINC+c6ab4117ba-r0/temp/run.do_compile.2732811\u0026rsquo; failed with exit code 1:\nmake: *** No rule to make target \u0026lsquo;globals.o\u0026rsquo;, needed by \u0026rsquo;nInvaders\u0026rsquo;. Stop.\nWARNING: exit code 1 from a shell command.\nninvaders_git.bb:\n1 2 - inherit autotools + inherit autotools-brokensep The problem is most likely that you\u0026rsquo;re not using automake but the\ngenerated recipe (would have been useful to include that) is using the\nautotools class, which assumes correct use of both autoconf and\nautomake. Specifically, your hand-written Makefile doesn\u0026rsquo;t handle\nout-of-tree builds.\nSource: [yocto] Adding nInvaders game package recipe\nå°‡ ninvaders åŠ å…¥ root filesystem ä¸­ é‡æ–°ç·¨è­¯å¾Œï¼Œè¨˜å¾—è¦æ›´æ–° NFS åˆ†äº«ç›®éŒ„\n1 2 echo \u0026#39;IMAGE_INSTALL_append = \u0026#34; ninvaders\u0026#34;\u0026#39; bitbake core-image-miminal æ¥è‘—é‡æ–°å•Ÿå‹• STM32MP1 ä¹‹å¾Œï¼ŒåŸ·è¡Œ nInvaders\nnInvaders åŸ·è¡Œçµæœ\nå°çµ å› ç‚ºç­†è€…æ‰‹é‚Šæ²’æœ‰ Nunchuk ï¼Œæ‰€ä»¥ä¹Ÿå°±æ²’æœ‰é€²è¡Œ Lab 5 äº†ã€‚\næœ‰èˆˆè¶£çš„åŒå­¸ï¼Œå†è‡ªå·±ç©ç©çœ‹å›‰!\nåƒè€ƒé€£çµ OpenEmbedded Layer Index TheZ3ro/ninvaders Bootlin/Yocto with STM32 Bootlin/Yocto with STM32 Lab ","description":"","id":21,"section":"posts","tags":["stm32mp1","yocto","linux"],"title":"åœ¨ STM32MP1 ä¸Šä½¿ç”¨ Yocto å»ºç½® Linux ç³»çµ± 2","uri":"https://e61983.github.io/2021-08-12-stm32mp-with-yocto-2/"},{"content":"å‰è¨€ æ‰‹é‚Šæœ‰ä¸€ç‰‡å¾ˆä¹…æ²’æœ‰å‹•éçš„ STM32MP157ã€‚å‰›å¥½æœ€è¿‘å·¥ä½œä¸Šéœ€è¦åœ¨ imx8 é€²è¡Œé–‹ç™¼ã€‚æœ¬æ–‡æœƒç…§è‘— Bootlin çš„èª²ç¨‹é€²è¡Œå¯¦ä½œ [2],ä¸€æ–¹é¢äº†è§£ Yocto è¦å¦‚ä½•ä½¿ç”¨ï¼Œå¦ä¸€æ–¹é¢é †ä¾¿è—‰æ­¤å…ˆç·´ç·´æ‰‹ã€‚\nä¸»è¦å…§å®¹ ç’°å¢ƒ æœ¬æ–‡çš„å¯¦ä½œç’°å¢ƒæ˜¯ä½¿ç”¨ Ubuntu 20.04.2 LTS åšç‚º Hostï¼Œä½¿ç”¨çš„ç¶²æ®µæ˜¯åœ¨ 10.1.100.0/24 å…§ã€‚\næº–å‚™ Bootlin çš„èª²ç¨‹è³‡æ–™ ä¸‹è¼‰ bootlin èª²ç¨‹ä¹‹ Lab è³‡æ–™\n1 2 3 4 5 6 7 cd ${HOME} # ä¸‹è¼‰ Lab è³‡æ–™ wget https://bootlin.com/doc/training/yocto-stm32/yocto-stm32-labs.tar.xz # è§£å£“ç¸® tar xvf yocto-stm32-labs.tar.xz å®‰è£ Yocto çš„ç›¸ä¾å¥—ä»¶ 1 sudo apt install -y bc build-essential chrpath cpio diffstat gawk git python texinfo wget gdisk ç­†è€…åœ¨ç·¨è­¯æ˜ åƒæª”æ™‚ï¼Œé‡åˆ°äº† openssl/ssl.h' file not found çš„å•é¡Œï¼Œæ‰€ä»¥è¼¸å…¥ä¸‹åˆ—æŒ‡ä»¤é€²è¡Œå®‰è£ã€‚\n1 sudo apt install -y libssl-dev å»ºç½® Yocto ç’°å¢ƒ 1 2 3 4 5 6 pushd ${HOME}/yocto-stm32-labs git clone -b dunfell-23.0.7 git://git.yoctoproject.org/poky.git popd git clone -b dunfell git://git.openembedded.org/meta-openembedded git clone -b dunfell https://github.com/STMicroelectronics/meta-st-stm32mp.git # cd meta-st-stm32mp \u0026amp;\u0026amp; git checkout a95cc1ec39b60a1dc50d0902c91675935959e6d2 åˆå§‹åŒ– Yocto ç’°å¢ƒ\n1 2 cd ${HOME}/yocto-stm32-labs source poky/oe-init-build-env åŠ å…¥ STM32MP1 çš„ BSP\n1 2 3 4 5 6 7 # pwd # ${HOME}/yocto-stm32-labs/poky/oe-init-build-env/build # åŠ å…¥ stm32mp ç›¸é—œçš„å±¤ bitbake-layers add-layer ../meta-openembedded/meta-oe bitbake-layers add-layer ../meta-openembedded/meta-python bitbake-layers add-layer ../meta-st-stm32mp ä¿®æ”¹ Yocto çš„é…ç½®æª” 1 2 # ä¿®æ”¹ç›®æ¨™æ©Ÿå™¨ sed -i \u0026#39;s/^MACHINE.*/MACHINE ?= \u0026#34;stm32mp1\u0026#34;/g\u0026#39; conf/local.conf å»ºç½®æ˜ åƒæª” 1 bitbake core-image-minimal ä¸‹åˆ—æ˜¯ conf/local.conf å¸¸æœƒé…ç½®çš„å¹¾å€‹é…ç½®é …\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 # ä¸‹è¼‰è·¯å¾‘ DL_DIR # ç·¨è­¯çµæœå¿«å– SSTATE_DIR # Bitbake åŒæ™‚è·‘å¤šå°‘å€‹ Task BB_NUMBER_THREADS # ç·¨è­¯æ™‚è·‘å¤šå°‘å€‹åŸ·è¡Œç·’ PARALLEL_MAKE # ç›®æ¨™æ©Ÿå™¨ MACHINE å»ºç½®ç”¨æ–¼ SD Card çš„æ˜ åƒæª” 1 2 3 ${BUILDDIR}/tmp/deploy/images/stm32mp1/scripts/create_sdcard_from_flashlayout.sh ../flashlayout_core-image-minimal/trusted/FlashLayout_sdcard_stm32mp157f-dk2-trusted.tsv # ç”¢ç”Ÿ *.raw æ–¼ ${BUILDDIR}/tmp/deploy/images/stm32mp1 å°‡æ˜ åƒæª”å¯«å…¥ SD Card ä¸­ 1 2 3 4 # æ’å…¥ SD Card åˆ°é›»è…¦ä¸­ sudo dd if=FlashLayout_sdcard_stm32mp157f-dk2-trusted.raw of=/dev/mmcblk0 bs=8M status=progress conv=fdatasync # or #sudo dd if=FlashLayout_sdcard_stm32mp157f-dk2-trusted.raw | pv -s ${IMAGE_SIZE} | dd of=/dev/mmcblk0 bs=4096 \u0026amp;\u0026amp; sync æ¸¬è©¦ æ¥ä¸Š ST-LINK ä¹‹å¾Œï¼Œåœ¨é›»è…¦é–‹å•Ÿçµ‚ç«¯æ©Ÿ\næ¥ä¸Š ST-Link\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 # åƒè€ƒè‡ªå·±é›»è…¦å¯¦éš›èªåˆ°çš„è£ç½®è™Ÿ screen /dev/${SERIAL_PORT} 115200 # ä½¿ç”¨ root ç™»å…¥ Poky (Yocto Project Reference Distro) 3.1.7 stm32mp1 /dev/ttySTM0 # çµæœ # stm32mp1 login: root # root@stm32mp1:~# uname -a # Linux stm32mp1 5.4.56 #1 SMP PREEMPT Wed Aug 5 07:59:52 UTC 2020 armv7l GNU/Linux # root@stm32mp1:~# # ä½¿ç”¨ C-a C-k é›¢é–‹ åœ¨STM32MP1 ç¬¬ä¸€å€‹ Linux ç³»çµ±\nå¾ NFS è¼‰å…¥ Root Filesystem ç‚ºäº†åœ¨å¾ŒçºŒçš„é–‹ç™¼ä¸­ï¼Œå¯ä»¥ä¸ç”¨ä¸€ç›´æ‹”æ‹”æ’æ’ SD Cardã€‚æˆ‘å€‘è¦è®“ç³»çµ±åœ¨é–‹æ©Ÿå¾Œï¼Œå¾ NFS Server ä¸‹è¼‰ root filesystemã€‚\nå»ºç½® NFS ç’°å¢ƒ åœ¨æˆ‘å€‘çš„å·¥ä½œæ©Ÿä¸Šï¼Œå®‰è£ NFS Server\n1 2 3 4 5 6 7 8 9 10 11 # å®‰è£ NFS Server sudo apt install -y nfs-kernel-server # å»ºç«‹ NFS åˆ†äº«è·¯å¾‘ sudo mkdir /nfs_shared # é…ç½® NFS Server è¨­å®šæª” echo \u0026#34;/nfs_shared *(insecure,rw,sync,no_root_squash,subtree_check)\u0026#34; \u0026gt;\u0026gt; /etc/exports # å•Ÿå‹• NFS Server sudo systemctl enable nfs-kernel-server \u0026amp;\u0026amp; sudo systemctl restart nfs-kernel-server è§£å£“ç¸®æˆ‘å€‘å…ˆå‰å»ºç«‹å¥½çš„ root filesystem åˆ° NFS åˆ†äº«ç›®éŒ„ä¸­ã€‚\n1 2 # å°‡å…ˆå‰æˆ‘å€‘å»ºç½®å¥½çš„ root filesystem è§£å£“ç¸®è‡³æˆ‘è‡ªå»ºç«‹çš„ /nfs_shared ä¸­ sudo tar xpf ${BUILDDIR}/tmp/deploy/images/stm32mp1/core-image-minimal-stm32mp1.tar.xz -C /nfs_shared/ ä¿®æ”¹ U-boot çš„é–‹æ©Ÿé¸é … ä¿®æ”¹ SD Card å…§ bootfs åˆ†å‰²å€ä¸­çš„ mmc0_extlinux/stm32mp157f-dk2_extlinux.confï¼Œåœ¨é–‹æ©Ÿçš„éç¨‹ä¸­u-boot æœƒå°‡åƒæ•¸å‚³éçµ¦ kernelã€‚æœ‰èˆˆè¶£çš„åŒå­¸å¯ä»¥åƒè€ƒ nfs/nfsroot.txt\n1 APPEND root=/dev/nfs rw console=ttySTM0,115200 nfsroot=${serverip}:/nfs_shared,vers=3,tcp ip=dhcp:${serverip}:${gateway}:${netmask}:${hostname}:eth0 ç‚ºä»€éº¼æ˜¯ mmc0_extlinux/stm32mp157f-dk2_extlinux.conf é€™å€‹æª”æ¡ˆå‘¢ ?\nç­†è€…ç¾éšæ®µä¸¦æ²’æœ‰æ·±ç©¶ï¼Œç›¸ä¿¡éš¨è‘—èª²ç¨‹çš„é€²è¡Œã€‚\næˆ‘å€‘æœƒçŸ¥é“çš„ã€‚\né‡æ–°é–‹æ©Ÿä¹‹å¾Œï¼Œç³»çµ±å°±æœƒå¾ NFS è¼‰å…¥ root filesystem äº†ã€‚\nå¾ NFS è¼‰å…¥ rootfilesystem\nä½¿ç”¨ SSH ç™»å…¥ åŠ å…¥ SSH Server è‡³ç³»çµ±ä¸­ ä¿®æ”¹ conf/local.conf ï¼Œåœ¨è£¡é¢åŠ ä¸Š dropbear Package\n1 echo \u0026#39;IMAGE_INSTALL_append = \u0026#34; dropbear\u0026#34;\u0026#39; \u0026gt;\u0026gt; ${BUILDDIR}/conf/local.conf é‡æ–°ç·¨è­¯\n1 bitbake core-image-minimal ä¾ç…§å…ˆå‰çš„æ­¥é©Ÿï¼Œé‡æ–°è§£å£“ç¸®å‰›å»ºç«‹å¥½çš„ root filesystem åˆ° NFS åˆ†äº«ç›®éŒ„ä¸­ã€‚\næ¸¬è©¦ STM32MP1 é‡æ–°é–‹æ©Ÿå¾Œï¼Œåœ¨ Host ç«¯ä½¿ç”¨ ssh æŒ‡ä»¤é€²è¡Œé€£æ¥ã€‚\n1 2 3 4 5 6 7 8 ssh root@${IP} # çµæœ # ssh root@10.1.100.104 # The authenticity of host \u0026#39;10.1.100.104 (10.1.100.104)\u0026#39; can\u0026#39;t be established. # RSA key fingerprint is SHA256:cDpQ47v01ZUkm6GpUG29F+RPOHVV7EzfDA5z/A4bDv4. # Are you sure you want to continue connecting (yes/no/[fingerprint])? yes # Warning: Permanently added \u0026#39;10.1.100.104\u0026#39; (RSA) to the list of known hosts. æ›´å¤šé—œæ–¼ conf/local.conf é€šå¸¸æœƒæ˜¯ä»¥å¤§å¯«è¡¨ç¤ºï¼Œå¦‚: CONF_VERSION _append:\nåœ¨åŸæœ¬è¨­å®šçš„ å¾Œæ–¹ å¢åŠ æ–°çš„è¨­å®šå€¼ï¼Œå¦‚: IMAGE_INSTALL_append = \u0026quot; dropbear\u0026quot; _prepend:\nåœ¨åŸæœ¬è¨­å®šçš„ å‰æ–¹ å¢åŠ æ–°çš„è¨­å®šå€¼ï¼Œå¦‚: FILESEXTRAPATHS_prepend := \u0026ldquo;${THISDIR}/${PN}\u0026rdquo; _remove:\nç”¨ä¾†ç§»é™¤ç•¶ä¸‹è¨­å®šå€¼ä¸­çš„å€¼ï¼Œå¦‚: IMAGE_INSTALL_remove = \u0026ldquo;i2c-tools\u0026rdquo; _${MACHINE}:\nç”¨ä¾†è¡¨ç¤ºï¼Œå¦‚æœç•¶æ™‚çš„ MACHINE èˆ‡ _${MACHINE} ç›¸ç¬¦æ™‚ï¼Œä½¿ç”¨é€™å€‹è¨­å®šå€¼ã€‚\nå¦‚: IMAGE_INSTALL_append_beaglebone = \u0026quot; i2c-tools\u0026quot;ï¼Œç•¶æˆ‘å€‘çš„ MACHINE æ˜¯ beaglebone æ™‚ï¼Œæ‰æœƒç”Ÿæ•ˆã€‚\nå¦‚: IMAGE_INSTALL_beaglebone = \u0026ldquo;busybox i2c-tools\u0026rdquo;ï¼Œç•¶æˆ‘å€‘çš„ MACHINE æ˜¯ beaglebone æ™‚ï¼Œæ‰æœƒç”Ÿæ•ˆã€‚ ä¸Šè¿°çš„æ“ä½œä¹Ÿå¯ä»¥ä½¿ç”¨ç¬¦è™Ÿè¡¨ç¤º\n=\nä½¿ç”¨é€™å€‹è®Šæ•¸æ™‚ï¼Œæœƒå°‡å…¶å±•é–‹ã€‚ :=\nç«‹å³å€¼ã€‚ +=\nèˆ‡ _append ç›¸åŒ (è¦åŠ ä¸Šç©ºç™½)ã€‚ (ç›¡é‡é¿å…åœ¨ conf/local.conf ä¸­ä½¿ç”¨) =+\nèˆ‡ _prepend ç›¸åŒ (è¦åŠ ä¸Šç©ºç™½)ã€‚(ç›¡é‡é¿å…åœ¨ conf/local.conf ä¸­ä½¿ç”¨) .=\nèˆ‡ _append ç›¸åŒ (ä¸ç”¨åŠ ä¸Šç©ºç™½)ã€‚ (ç›¡é‡é¿å…åœ¨ conf/local.conf ä¸­ä½¿ç”¨) =.\nèˆ‡ _prepend ç›¸åŒ (ä¸ç”¨åŠ ä¸Šç©ºç™½)ã€‚ (ç›¡é‡é¿å…åœ¨ conf/local.conf ä¸­ä½¿ç”¨) ?=\nå¦‚æœå…ˆå‰çµ¦éå€¼çš„è©±ï¼Œä½¿ç”¨å…ˆå‰çš„å€¼ã€‚ ??=\nèˆ‡ ?= ç›¸åŒï¼Œä½†å„ªå…ˆæ¬Šæ›´ä½ã€‚ è™›æ“¬ Package Virtual Package æœƒä»¥ vitual/å‘½åï¼Œä½†å®ƒæ˜¯ä¸æ˜¯çœŸçš„ Package ã€‚\nå‡çš„\nå¸¸è¦‹çš„ virtual pacakge æœ‰\nvirtual/bootloader: u-boot, u-boot-ti-staging, \u0026hellip; virtual/kernel: linux-yocto, linux-yocto-tiny, linux-ti-staging, \u0026hellip; virtual/libc: glibc, musl, newlib virtual/xserver: xserver-xorg é¸æ“‡ æˆ‘å€‘å¯ä»¥ä½¿ç”¨ PREFERRED_PROVIDER ä¾†æŒ‡å®šæˆ‘å€‘æƒ³è¦ç”¨çš„ Packageã€‚\nå¦‚: PREFERRED_PROVIDER_vritual/kernel ?= \u0026ldquo;linux-ti-staging\u0026rdquo;\næˆ‘å€‘å¯ä»¥ä½¿ç”¨ PREFERRED_VERSION ä¾†æŒ‡å®šæƒ³ä½¿ç”¨çš„ Package ç‰ˆæœ¬ã€‚\nå¦‚: PREFERRED_VERSION_python = \u0026ldquo;2.7.3\u0026rdquo; æˆ–æ˜¯ PREFERRED_VERSION_linux-yocto = \u0026ldquo;5.4.%\u0026rdquo;\nRoot Filesystem æˆ‘å€‘å¯ä»¥ä½¿ç”¨ IMAGE_INSTALL ä¾†æŒ‡å®šå“ªäº› Packages è¦åŠ å…¥ root filesystem ä¸­ï¼Œä¸¦å¯ä»¥ä½¿ç”¨ RDEPENDS ä¾†æŒ‡å®šå…¶ç›¸ä¾ Packages. æˆ‘å€‘ä¹Ÿå¯ä»¥ä½¿ç”¨ PACKAGE_EXCLUDE ä¾†éæ…®æˆ‘å€‘ä¸æƒ³è¦çš„ Packagesã€‚\nå°çµ æˆ‘å€‘å·²ç¶“å»ºç«‹äº†åŸºæœ¬çš„ STM32MP1 Linux ç³»çµ±é–‹ç™¼ç’°å¢ƒï¼Œæ¥ä¸‹ä¾†å°±è¦ä¸€é‚Šç© Yocto ä¸€é‚Šæ¢ç´¢ STM32MP1 çš„é€±é‚Šäº†ã€‚\nåƒè€ƒé€£çµ STM32MP157F-DK2 Bootlin/Yocto with STM32 Bootlin/Yocto with STM32 Lab Wiki - STM32MP1 Distribution Package Kernel Document - nfsroot ","description":"","id":22,"section":"posts","tags":["stm32mp1","yocto","linux"],"title":"åœ¨ STM32MP1 ä¸Šä½¿ç”¨ Yocto å»ºç½® Linux ç³»çµ±","uri":"https://e61983.github.io/2021-08-11-stm32mp-with-yocto/"},{"content":"å‰è¨€ æœ€è¿‘å‰›å¥½è¦æ›´æ–°åœ°åœ–æ‡‰ç”¨ã€‚å…ˆå‰æ˜¯ç›´æ¥ä½¿ç”¨ Mapbox ï¼Œä½†è¦ºå¾—å®ƒçš„ Marker æ“ä½œèµ·ä¾†ä¸æ˜¯å¾ˆå½ˆæ€§ã€‚å› ç·£éš›æœƒä¸‹è½èªªäº† Leaflet ï¼Œå°±ä¾†è©¦çœ‹çœ‹å§ã€‚\nç¶­åŸºç™¾ç§‘æ˜¯é€™æ¨£èªªçš„ã€‚\nLeafletæ˜¯ä¸€å€‹é–‹æºçš„JavaScriptåº«ï¼Œç”¨æ–¼æ§‹å»ºWebåœ°åœ–æ‡‰ç”¨ã€‚é¦–æ¬¡ç™¼å¸ƒæ–¼2011å¹´ï¼Œ2å®ƒæ”¯æŒå¤§å¤šæ•¸ç§»å‹•å’Œæ¡Œé¢å¹³å°ï¼Œæ”¯æŒHTML5å’ŒCSS3ã€‚\nä¸»è¦å…§å®¹ å®‰è£æ–¹å¼ æœ¬æ–‡æ’°å¯«æ™‚æœƒä»¥ CDN çš„æ–¹å¼å¼•å…¥ Leaflet.jsï¼Œå¯¦éš›ä½¿ç”¨æ™‚ç­†è€…æ˜¯æœƒä½¿ç”¨å¥—ä»¶ç®¡ç†å·¥å…·é€²è¡Œå®‰è£ã€‚\nå®‰è£æ–¹å¼:\n1 yarn add leaflet ä½¿ç”¨ CDN çš„æ–¹å¼:\n1 2 3 4 5 6 7 8 \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;https://unpkg.com/leaflet@1.7.1/dist/leaflet.css\u0026#34; integrity=\u0026#34;sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==\u0026#34; crossorigin=\u0026#34;\u0026#34;/\u0026gt; \u0026lt;!-- Make sure you put this AFTER Leaflet\u0026#39;s CSS --\u0026gt; \u0026lt;script src=\u0026#34;https://unpkg.com/leaflet@1.7.1/dist/leaflet.js\u0026#34; integrity=\u0026#34;sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==\u0026#34; crossorigin=\u0026#34;\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; èµ·æ‰‹å¼ åœ¨ç¶²é ä¸­åŠ å…¥\n1 \u0026lt;div id=\u0026#34;map\u0026#34; style=\u0026#34;width:95vw;height:95vh\u0026#34; /\u0026gt; åˆå§‹åŒ–åœ°åœ–\n1 2 3 4 5 6 var map = L.map(\u0026#39;map\u0026#39;).setView([34.985851028839406, 135.75788488621308], 10); L.tileLayer(\u0026#39;https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png?{foo}\u0026#39;, { foo: \u0026#39;bar\u0026#39;, attribution: \u0026#39;\u0026amp;copy; \u0026lt;a href=\u0026#34;https://www.openstreetmap.org/copyright\u0026#34;\u0026gt;OpenStreetMap\u0026lt;/a\u0026gt; contributors\u0026#39;, }).addTo(map); æˆ‘å€‘çš„ç¬¬ä¸€å¼µåœ°åœ–\nå¦‚æœæˆ‘å€‘æƒ³è¦ä½¿ç”¨ Mapbox çš„åœ–è³‡ï¼Œåœ¨å·²å–å¾—å­˜å–é‡‘é‘°ä¹‹å¾Œ(Access Toekn)ï¼Œå¯åœ¨å»ºç«‹ titleLayer æ™‚æ”¹ç”¨ä¸‹åˆ—æ–¹å¼åˆå§‹åŒ–ã€‚\n1 2 3 4 5 6 7 8 9 10 var map = L.map(\u0026#39;map\u0026#39;).setView([34.985851028839406, 135.75788488621308], 10); L.tileLayer(\u0026#39;\u0026#39;https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}\u0026#39;, { attribution: \u0026#39;\u0026amp;copy; \u0026lt;a href=\u0026#34;https://www.mapbox.com/about/maps/\u0026#34;\u0026gt;Mapbox\u0026lt;/a\u0026gt; contributors\u0026#39; maxZoom: 18, zoomOffset: -1, tileSize: 512, id: \u0026#39;mapbox/streets-v11\u0026#39;, accessToken: token }).addTo(map); ä½¿ç”¨ Mapbox åœ–è³‡\nå¦‚æœæƒ³è¦ç§»é™¤é è¨­çš„ zoom controller å¯ä»¥åœ¨åˆå§‹åŒ–çš„æ™‚å€™åŠ ä¸Š zoomControl: false\n1 var map = L.map(\u0026#39;map\u0026#39;, {zoomControl: false}).setView([34.985851028839406, 135.75788488621308], 10); åŠ ä¸Š Marker åœ¨ Leaflet ä¸­åŠ ä¸Š marker å°±è·Ÿå‘¼å¸ä¸€æ¨£è‡ªç„¶ã€‚\n1 2 3 L.marker([35.04074994371372, 135.72932367775914]).addTo(map); L.marker([34.97374817523019, 135.77195253085293]).addTo(map); L.marker([34.99936852552379, 135.7854861479551]).addTo(map); åŠ ä¸Š marker\nå¦‚æœæƒ³è¦æ”¹è®Šæ¨£å¼ï¼Œå¯ä»¥é€é icon æˆ–æ˜¯ iconDiv ä¾†æ›´æ”¹ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 var myIcon = L.icon({ iconUrl: \u0026#39;marker.png\u0026#39;, iconSize: [100, 95], iconAnchor: [22, 94], popupAnchor: [-3, -76], shadowUrl: \u0026#39;my-icon-shadow.png\u0026#39;, shadowSize: [68, 95], shadowAnchor: [22, 94] }); L.marker([34.70432671595862, 135.50096236284378], { icon: myIcon }).addTo(map); 1 2 3 4 5 6 7 var myDivIcon = L.divIcon({ className:\u0026#39;my-div-icon-wrapper\u0026#39;, html:`\u0026lt;div\u0026gt;é€™æ˜¯ Div Icon \u0026lt;/div\u0026gt;` }); L.marker([34.68985107822455, 135.5253549268327], { icon: myDivIcon }).addTo(map); 1 2 3 4 5 6 .my-div-icon-wrapper div{ width: 100px; background-color: #060390; color: #eee; text-align: center; } åŠ ä¸Š marker\nä¾†ç•«ç·šå§ 1 2 3 4 5 6 7 8 9 var latlngs = [ [35.02537491062854, 135.7438607946139], [34.88948810597932, 135.8076289149232], [34.961035819215525, 135.65613226663768], [34.976863645786004, 135.82695459531024], [34.88036360232042, 135.7002729085305], [35.02537491062854, 135.7438607946139], ]; L.polyline(latlngs, {color: \u0026#39;red\u0026#39;}).addTo(map); ä¾†å€‹å°å°é™£å§!\nç¾¤çµ„åŒ–ä¸¦åŠ ä¸Šæ§åˆ¶é … æˆ‘å€‘å¯ä»¥æŠŠæƒ³è¦æ­¸åœ¨ä¸€èµ·çš„æ±è¥¿æ”¾åˆ°åŒä¸€å€‹ç¾¤çµ„ï¼Œé€™æ¨£åœ¨æ¥ä¸‹ä¾†è¦åˆ†å±¤é¡¯ç¤ºçš„æ™‚å€™ï¼Œæœƒæ›´ç°¡ä¾¿ä¸€äº›ã€‚\nè®“æˆ‘å€‘ç¨å¾®èª¿æ•´ä¸€ä¸‹ç¨‹å¼ç¢¼ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ... let layer1 = L.layerGroup([ L.marker([35.04074994371372, 135.72932367775914]), L.marker([34.97374817523019, 135.77195253085293]), L.marker([34.99936852552379, 135.7854861479551]) ]).addTo(map); ... let layer2 = L.layerGroup([ L.marker([34.70432671595862, 135.50096236284378], { icon: myIcon }), L.marker([34.68985107822455, 135.5253549268327], { icon: myDivIcon }) ]).addTo(map); ... let layer3= L.layerGroup([ L.polyline(latlngs, {color: \u0026#39;red\u0026#39;}) ]).addTo(map); å°‡æˆ‘å€‘ç¾¤çµ„åŒ–å¾Œçš„ Layer åŠ å…¥æ§åˆ¶é …ä¸­ã€‚\n1 2 3 4 5 let controller = L.control.layers().addTo(map); controller.addOverlay(layer1,\u0026#34;Marker\u0026#34;); controller.addOverlay(layer2,\u0026#34;è‡ªå®šçš„Marker\u0026#34;); controller.addOverlay(layer3,\u0026#34;å°å°é™£\u0026#34;); controller.expand(); åŠ å…¥æ§åˆ¶é …\nè£œå……ä¸€ä¸‹ï¼Œå¦‚æœæƒ³ç§»é™¤å„å€‹ Layer çš„è©±å¯ä»¥é€éä¸‹åˆ—æ–¹å¼ï¼Œç§»é™¤\n1 2 3 4 5 6 7 8 9 10 map.value.eachLayer((layer) =\u0026gt; { if (layer instanceof L.Marker) { map.value.removeLayer(layer); } }); // or layer1.remove(); 20210808 æ–°å¢ - geoJSON Layer æ¸¬è©¦è³‡æ–™å¯ä»¥åˆ°æ”¿åºœé–‹æ”¾è³‡æ–™å¹³å°å–å¾—ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 let data = {\u0026#34;type\u0026#34;:\u0026#34;FeatureCollection\u0026#34;, \u0026#34;features\u0026#34;: [ \u0026#34;type\u0026#34;:\u0026#34;Feature\u0026#34;,\u0026#34;geometry\u0026#34;:{\u0026#34;type\u0026#34;:\u0026#34;Polygon\u0026#34;,\u0026#34;coordinates\u0026#34;:[[[121.543841724,25.0449066970000,...................... ]]] ]} function onEachFeature(feature, layer) { if (feature.properties \u0026amp;\u0026amp; feature.properties.TOWNNAME) { layer.bindPopup(feature.properties.TOWNNAME); } } L.geoJSON(data, { onEachFeature: onEachFeature, filter: function(feature, layer) { return feature.properties.TOWNNAME == \u0026#39;å¤§å®‰å€\u0026#39;; }, style: function(feature) { switch (feature.properties.TOWNNAME) { case \u0026#39;å¤§å®‰å€\u0026#39;: return {color: \u0026#34;#00ff00\u0026#34;,weight:1}; default: return {color: \u0026#34;#333333\u0026#34;,weight:1,opacity:0.5 }; } } }).addTo(map); ä½¿ç”¨ geolayer\næˆæœ å°çµ ä½¿ç”¨ Leaflet ä¹‹å¾Œï¼Œä¸ç®¡æ˜¯åœ¨æ“ä½œ Marker é‚„æ˜¯è¦å»ºç«‹ Path éƒ½è®Šå¾—æ›´åŠ å®¹æ˜“äº†ã€‚åªèƒ½èªªæ˜¯ç›¸è¦‹æ¨æ™š!\nåƒè€ƒé€£çµ Leafletjs Migrate Mapbox Static Title API Leaflet-providers preview ","description":"","id":23,"section":"posts","tags":["map","leaflet","geojson"],"title":"ä½¿ç”¨ Leaflet åœ°åœ–","uri":"https://e61983.github.io/2021-08-04-using-leaflet-map/"},{"content":"å‰è¨€ ä»Šå¹´çš„ COSCUP å› æ‡‰ COVID-19 ç–«æƒ…ï¼Œæ‰€ä»¥ä»¥ç·šä¸Šç›´æ’­çš„æ–¹å¼é€²è¡Œã€‚æœ¬ç¯‡ä¸»è¦æ˜¯è¨˜éŒ„å¤§æœƒç¬¬äºŒå¤©æœ‰èˆˆè¶£çš„è­°ç¨‹ä»¥åŠé—œéµå­—ã€‚\nä¸»è¦å…§å®¹ ç´°è«‡ MySQL Replication å¼·é … References: MySQL Replication ä¸»å¾å¼æ¶æ§‹è¨­å®šæ•™å­¸ MySQL ä¸»å¾è¤‡è£½åŸç† è³‡æ–™åº«ä¹Ÿå¯ä»¥å…¨å¹´ç„¡ä¼‘å•¦! ç¥å¥‡çš„MySQL HAæ¶æ§‹æ‹¯æ•‘ä½ çš„è³‡æ–™åº«! MySQL Cluster\nSQL Node è®€è³‡æ–™ Data Node å­˜è³‡æ–™ Management Node - ç”¨ä¾†ç®¡ç† NDB Cluster MGM:\nconfig.ini ndb_mgm Data/ SQL Node\n/etc/my.conf ndbd SQL\nsystemd start mysqld Node Group\nä¸€èˆ¬æ˜¯ç•°æ­¥\nndb æ˜¯åŒæ­¥çš„\nMaster æœƒå‚³ Log çµ¦ Slave ï¼Œç¢ºèªå¾ŒæœƒåŸ·è¡Œå‹•ä½œä¾†é€²è¡ŒåŒæ­¥ã€‚ References MySQL Clusterå­¸ç¿’ç­†è¨˜ SignalR æ•´åˆ LINEï¼Œåœ¨LIFFè£¡å»ºç«‹ä¸€å°ä¸€èŠå¤©ç®¡é“ LIFF ( Line Front-end Framework ) SignalR Group References: SignalR MySQL 8 é‚£éº¼ä¹…äº†ï¼Œé‚„æ²’é–‹å§‹ç”¨ window function å—ï¼Ÿ ä»€éº¼æ˜¯ Wndow Function ä¿ç•™æ¯ä¸€åˆ—çš„ Query çµæœï¼Œä½†åˆæœ‰èšåˆçš„æ“ä½œçµæœã€‚ OVER (PARTITION BY contry)\n{ OVER (window_spec) | OVER window_name }\nQuery Rewrite\nä½¿ç”¨ Qemu + Debian Linux ä¾†é€²è¡ŒåµŒå…¥å¼ç³»çµ±å…¥é–€æ•™å­¸ Den U-Boot Linux Kernel Root File System References: å…±ç­† MySQLç©¶æ¥µé˜²ç¦¦å·¥äº‹(å…¨è‡ªå‹•åŒ–MHAæ©Ÿåˆ¶) Proxy SQL Orchestrator äº†è§£ Master - Slave æ¶æ§‹ã€åŒæ­¥æ©Ÿåˆ¶ References: Slide å…±ç­† åˆè©¦ Casbin - å¿«é€Ÿæ­å»ºç¬¦åˆ 99% ç”¢å“éƒ½éœ€è¦çš„é«˜å½ˆæ€§å¯ç¶­è­·ä¹‹æˆæ¬Šæ§åˆ¶ç³»çµ± Authen \u0026amp; Authorization Authen - ä½ æ˜¯èª° Authorization - ä½ å¯ä»¥åšä»€éº¼ æ¬Šé™ç®¡ç†æ–¹å¼ ACL (Accuess Control List) RBAC (Role-Base Access Control) Attribute-based access control Casbin PML Policy Storage References: casbin/casbin ory ory/oathkeeper MySQL 8.0çš„æ–°SQLç‚ºé–‹ç™¼è€…é–‹å•Ÿä¸€ç‰‡å¤© Window Function History 4.1 B-Tree, R-Tree, Subquery, Prepaed Statement 5.0 Stored Routines, Views, XTranstion 5.1 Event, Row-Based replicatoion, Plugin API 5.5 Support Unicode 5.6 InnoDB Buffer Pool Instance, Memmcached API, GTID 5.7 JSON data type, CJK æª¢ç´¢, online DDL, JSON Function 8.0 \u0026hellip; å¸¶æ‚¨è£½ä½œæ–°æ½®ã€å¯¦ç”¨ä¸”é–‹æºçš„ LINE é›»å­åç‰‡èˆ‡å»£å‘Šå‚³å–® Flex Message LIFF References: ä¸ç”¨å¯«ç¨‹å¼ä¹Ÿèƒ½åš LINE æ•¸ä½ç‰ˆåç‰‡\ntaichunmin/liff-businesscard ","description":"","id":24,"section":"posts","tags":["mysql","acl","chatbot","liff","coscup"],"title":"COSCUP 2021 Day 2","uri":"https://e61983.github.io/2021-08-01-coscup-2021-day-2/"},{"content":"å‰è¨€ ä»Šå¹´çš„ COSCUP å› æ‡‰ COVID-19 ç–«æƒ…ï¼Œæ‰€ä»¥ä»¥ç·šä¸Šç›´æ’­çš„æ–¹å¼é€²è¡Œã€‚æœ¬ç¯‡ä¸»è¦æ˜¯è¨˜éŒ„å¤§æœƒç¬¬ä¸€å¤©æœ‰èˆˆè¶£çš„è­°ç¨‹ä»¥åŠé—œéµå­—ã€‚\nCOSCUP2021\nä¸»è¦å…§å®¹ Introduction to Transactional Memory and Its Implementation GCC Example:\n1 2 3 4 5 6 7 8 #include \u0026lt;stdio.h\u0026gt; int main() { int i = 0; __transaction_atomic { i++; } return 0; } åœ¨ç·¨è­¯çš„æ™‚å€™è¦åŠ ä¸Š -fgnu-tm\n1 gcc -fgnu-tm Reference Slide reborn2266/STM-Toy Learning go error handling design from open source â€œValues can be programmed, and since errors are values, errors can be programmed.â€ \u0026ndash;Rob Pike\nReferences: Donâ€™t just check errors, handle them gracefully Errors are values A trip about how I contribute to LLVM - Douglas Chen References: Slide å¾ Go çš„ runtime æºç¢¼ç™¼æ˜ç˜‹ç‹‚çš„ slice ç”¨æ³• References Slide Select, Manage, and Backport the Long-Term Stable Kernels Linux CIP\nReferences: å…±ç­† Slide Automotive Linux Cuju - è™›æ“¬æ©Ÿå®¹éŒ¯åŠŸèƒ½å¯¦ä½œ References Cuju User authentication in Go Web Server Rainbow table attack è®“å¯†ç¢¼å®‰å…¨æ€§æ›´é«˜çš„æ–¹å¼ salt (å»ºè­°32bit) pepper (secret salt) åŠ é¹½çš„æ–¹å¼\npassword length: 10 ~ 64 OTP (Once Time Password) Time OTP SMS OTP Resources: \u0026ndash;have i been pwned? Let\u0026rsquo;s Publish a Collaborative e-Book for Linux Kernel References: å…±ç­† The Linux Kernel Module Programming Guide Original Guide è—‰ç”±å¯¦ä½œå¤šä»»å‹™æ ¸å¿ƒä¾†é«”é©—ä½œæ¥­ç³»çµ±æ¦‚å¿µ Raspbootcom:\nraspbootcom\nEnable UART0 FIFO References: Slide DavidSpickett/ARMMultiTasking Raspbootcom åƒè€ƒé€£çµ TransactionalMemory Rpi-JTAG\n","description":"","id":25,"section":"posts","tags":["gcc","go","linux","coscup"],"title":"COSCUP 2021 Day 1","uri":"https://e61983.github.io/2021-07-31-coscup-2021-day-1/"},{"content":"å‰è¨€ ä¸€èˆ¬ä¾†èªªï¼Œå¦‚æœæƒ³è¦èª¿æ•´ Linux Kernel åªè¦åœ¨çµ‚ç«¯æ©Ÿè¼¸å…¥ make menuconfig é€™é¡çš„æŒ‡ä»¤å°±å¯ä»¥äº†ã€‚ä½†å¦‚æœåœ¨ä¸åŒçš„é–‹ç™¼æµç¨‹ä¸­ï¼Œå°±ä¸æ˜¯é€™éº¼å–®ç´”äº†ã€‚\næœ¬æ–‡ä¸»è¦æ˜¯é‡å° Yocto é–‹ç™¼æµé€²è¡Œè¨˜éŒ„ï¼Œæœªä¾†æœ‰æ©Ÿæœƒçš„è©±ï¼Œæœƒå†è£œå…… buildroot çš„é–‹ç™¼æ–¹å¼ã€‚\nä¸»è¦å…§å®¹ ä¸‹åœ–å–è‡ª Yocto å®˜ç¶²ã€‚åœ–ä¸­ç¤ºè¡¨äº†ï¼Œåœ¨ Yocto ç’°å¢ƒä¸­é–‹ç™¼ Kernel æ™‚çš„æµç¨‹\nhttps://docs.yoctoproject.org/current/kernel-dev/intro.html\næ¥ä¸‹ä¾†çš„å…§å®¹ï¼Œç­†è€…å·²åˆå§‹åŒ–å®Œ Yocto ç›¸é—œçš„ç’°å¢ƒè®Šæ•¸ã€‚æ­¤æ­¥é©Ÿè‹¥ä¸æ¸…æ¥šï¼Œå¯åƒè€ƒ é€™è£¡\næ‰¾åˆ° Kernel ä¾†æº Kernel çš„é…ç½®ä¸€èˆ¬ä¾†èªªï¼Œéƒ½æœƒæ”¾åœ¨ conf/machine/ ä¸­ï¼Œä¸¦ä¸”æœƒé…ç½® PREFERRED_PROVIDER_virtual/kernel ä¾†æŒ‡å®šä½¿ç”¨çš„ kernelã€‚æ‰€ä»¥æˆ‘å€‘å¯ä»¥ç›´æ¥ä»¥ */conf/machine/*.conf ä¾†é€²è¡Œæœå°‹ã€‚\n1 find . -wholename \u0026#34;*/conf/machine/*.conf\u0026#34; æ‰¾å°‹ machine é…ç½®æª”\nä»¥ qemuarm.conf ç‚ºä¾‹:\nåœ¨é€™ä»½æª”æ¡ˆä¸­æˆ‘å€‘ä¸¦æ²’æœ‰çœ‹åˆ° PREFERRED_PROVIDER_virtual/kernel çš„è¨­å®šã€‚æ‰€ä»¥æˆ‘å€‘è¦å»æŸ¥çœ‹å®ƒå¼•å…¥çš„æ–‡ä»¶ã€‚\nqemuarm.conf\nåœ¨ qemuarm.inc:22 ï¼Œæˆ‘å€‘çœ‹åˆ°å®ƒæ˜¯é…ç½®ç‚º linux-yocto\nqemuarm.inc\næ¥ä¸‹ä¾†å°±æ˜¯è¦å»æ‰¾åˆ° linux-yocto å®ƒçš„é…ç½®æª”åœ¨å“ªè£¡äº†ã€‚\né€šå¸¸å®ƒæœƒè¢«æ”¾åœ¨ recipes-kernel/linux ä¸­ï¼Œä½†æˆ‘å€‘é‚„æ˜¯å¯ä»¥ç›´æ¥ä»¥æœå°‹çš„æ–¹å¼æ‰¾åˆ°å®ƒã€‚\n1 find . -iname \u0026#34;linux-yocto*\u0026#34; æœ€å¾Œæˆ‘å€‘å¯ä»¥çœ‹ SRC_URL æ‰€æŒ‡å®šçš„ä½ç½®ï¼Œå³æ˜¯ Kernel çš„ä¾†æºã€‚\nå‘¼å–šå‡ºç†Ÿæ‚‰çš„ç•«é¢ 1 bitbake virtual/kernel -c menuconfig è£½ä½œ Configuration Fragment åŸ·è¡Œä¸‹åˆ—æŒ‡ä»¤ä¾†ç”¢ç”Ÿ configuration fragmentã€‚ç”¢ç”Ÿçš„æª”æ¡ˆæœƒæ”¾ç½®åœ¨ ${WORKDIR}/fragment.cfgã€‚\nè€Œ ${WORKDIR} çš„ä½ç½®å¯åƒè€ƒæ‰‹å†Šä¸­è¨»æ˜çš„ä½ç½®: ${TMPDIR}/work/${MULTIMACH_TARGET_SYS}/${PN}/${EXTENDPE}${PV}-${PR}ã€‚\n1 2 3 4 bitbake virtual/kernel -c diffconfig # æŠŠé€é diffconfig ç”¢ç”Ÿçš„ fragment.cfg ç§»éä¾† \u0008mv tmp/work/qemuarm-poky-linux-gnueabi/linux-yocto/5.4.129+gitAUTOINC+c5e5dc4e13_dfb9647332-r0/fragment.cfg my-local-version.cfg å¾å…§å®¹æ‡‰è©²å¯ä»¥çœ‹å‡ºä¾†ï¼Œç­†è€…åªæœ‰ä¿®æ”¹äº† local version è€Œå·²ã€‚\n1 CONFIG_LOCALVERSION=\u0026#34;-yuan\u0026#34; æ¥ä¸‹ä¾†æˆ‘å€‘å¯ä»¥é€é recipetool å¹«æˆ‘å€‘å°‡ my-local-version.cfg åŠ å…¥æˆ‘å€‘çš„ Layerä¸­ã€‚\n1 recipetool appendsrcfile meta-first-layer linux-yocto my-local-version.cfg é‡æ–°ç·¨è­¯ kernel\n1 2 3 4 bitbake virtual/kernel # é‡æ–°ç·¨è­¯ Image bitbake core-image-minimal ä½¿ç”¨ qemu é€²è¡Œé©—è­‰\n1 runqemu qemuarm core-image-minimal nographic slirp ä¿®æ”¹ LOCALVERSION ä¹‹å¾Œçš„çµæœ\nå¯«åœ¨æœ€å¾Œ ç­†è€…åœ¨é©—è­‰ä¿®æ”¹ LOCALVERSION æ˜¯å¦æœ‰ä¿®æ”¹æˆåŠŸæ™‚ï¼Œè¿”è¦†çš„ä½¿ç”¨ä¸‹åˆ—æŒ‡ä»¤é€²è¡Œç¢ºèªã€‚\nä½†æ™‚å¸¸æœƒæ²’æœ‰ä¿®æ”¹æˆåŠŸã€‚\n1 2 bitbake linux-yocto -c kernel_configme -f bitbake linux-yocto -c kernel_configcheck -f è‹¥æœ‰ç™¼ç¾åŸå› ï¼Œæœƒå†é€²è¡Œè£œå……ã€‚\nè£œå……èªªæ˜ å¦‚æœåœ¨åŸ·è¡Œ bitbake virtual/kernel -c menuconfig é‡åˆ°äº†ä¸‹åˆ—éŒ¯èª¤ï¼Œå¯ä»¥å®‰è£ screen æˆ–æ˜¯ tmux ä¾†è§£æ±ºæ­¤å•é¡Œã€‚\nTried the following commands:\ntmux split-window -c \u0026ldquo;{cwd}\u0026rdquo; \u0026ldquo;do_terminal\u0026rdquo;\ntmux new-window -c \u0026ldquo;{cwd}\u0026rdquo; -n \u0026ldquo;linux-imx Configuration\u0026rdquo; \u0026ldquo;do_terminal\u0026rdquo;\nxfce4-terminal -T \u0026ldquo;linux-imx Configuration\u0026rdquo; -e \u0026ldquo;do_terminal\u0026rdquo;\nterminology -T=\u0026ldquo;linux-imx Configuration\u0026rdquo; -e do_terminal mate-terminal \u0026ndash;disable-factory -t \u0026ldquo;linux-imx Configuration\u0026rdquo; -x do_terminal\nkonsole \u0026ndash;separate \u0026ndash;workdir . -p tabtitle=\u0026ldquo;linux-imx Configuration\u0026rdquo; -e do_terminal\ngnome-terminal -t \u0026ldquo;linux-imx Configuration\u0026rdquo; \u0026ndash; do_terminal\nxterm -T \u0026ldquo;linux-imx Configuration\u0026rdquo; -e do_terminal\nrxvt -T \u0026ldquo;linux-imx Configuration\u0026rdquo; -e do_terminal\ntmux new -c \u0026ldquo;{cwd}\u0026rdquo; -d -s devshell -n devshell \u0026ldquo;do_terminal\u0026rdquo;\nscreen -D -m -t \u0026ldquo;linux-imx Configuration\u0026rdquo; -S devshell do_terminal å®‰è£æ–¹å¼:\n1 sudo apt install -y tmux å°çµ åœ¨ Yocto ç’°å¢ƒä¸­èª¿æ•´ Kernel å…¶å¯¦æ˜¯æœ‰è¨±å¤šæ–¹æ³•çš„ï¼Œä¾‹: ä½¿ç”¨è‡ªå·±æŒ‡å®šçš„ Kernel Sourceã€ä½¿ç”¨æˆ‘å€‘çµ¦å®šçš„ defconfigï¼Œæˆ–æ˜¯ä½¿ç”¨ patch ç­‰ã€‚\nè€Œæˆ‘å€‘æ­¤æ¬¡æ˜¯é€éçµ¦äºˆ Configuration Fragments çš„æ–¹å¼é€²è¡Œã€‚\næœªä¾†è‹¥æœ‰ä½¿ç”¨åˆ°å…¶ä»–æ–¹å¼ï¼Œæœƒå†é¡å¤–æ’°å¯«è¨˜éŒ„ã€‚\nåƒè€ƒé€£çµ Yocto Project Linux - Kernel Development Manual Yocto How to config image through layer Bitbake append file to reconfigure kernel ","description":"","id":26,"section":"posts","tags":["yocto","linux","kernel"],"title":"åœ¨ Yocto ç’°å¢ƒä¸­èª¿æ•´ Linux Kernel","uri":"https://e61983.github.io/2021-07-30-yocto-kernel-menuconfig/"},{"content":" å‰è¨€ çªç„¶å¥½å¥‡ï¼Œè¦å¦‚ä½•åœ¨ Hugo ä¸­ä½¿ç”¨å¤–éƒ¨è³‡æºã€‚æœ¬æ–‡å°±å…ˆä»¥æœ€ç°¡å–®çš„æ–¹å¼ï¼Œä½¿ç”¨ CDN å¼•å…¥ Bootstrapã€‚\nä¸»è¦å…§å®¹ åœ¨æ–‡ä¸­è²¼ä¸Š Bootstrap å®˜ç¶²çš„ CDN å³å¯ã€‚\n1 2 3 \u0026lt;link href=\u0026#34;https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css\u0026#34; rel=\u0026#34;stylesheet\u0026#34; integrity=\u0026#34;sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC\u0026#34; crossorigin=\u0026#34;anonymous\u0026#34;\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js\u0026#34; integrity=\u0026#34;sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM\u0026#34; crossorigin=\u0026#34;anonymous\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; æ¥è‘—å°±å¯ä»¥é–‹å§‹ä½¿ç”¨äº†ã€‚\nä¸‹åˆ—ä»¥å¹»ç‡ˆç‰‡ä½œç‚ºç¯„ä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 \u0026lt;div id=\u0026#34;carouselExampleIndicators\u0026#34; class=\u0026#34;carousel slide\u0026#34; data-bs-ride=\u0026#34;carousel\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;carousel-indicators\u0026#34;\u0026gt; \u0026lt;button type=\u0026#34;button\u0026#34; data-bs-target=\u0026#34;#carouselExampleIndicators\u0026#34; data-bs-slide-to=\u0026#34;0\u0026#34; class=\u0026#34;active\u0026#34; aria-current=\u0026#34;true\u0026#34; aria-label=\u0026#34;Slide 1\u0026#34;\u0026gt;\u0026lt;/button\u0026gt; \u0026lt;button type=\u0026#34;button\u0026#34; data-bs-target=\u0026#34;#carouselExampleIndicators\u0026#34; data-bs-slide-to=\u0026#34;1\u0026#34; aria-label=\u0026#34;Slide 2\u0026#34;\u0026gt;\u0026lt;/button\u0026gt; \u0026lt;button type=\u0026#34;button\u0026#34; data-bs-target=\u0026#34;#carouselExampleIndicators\u0026#34; data-bs-slide-to=\u0026#34;2\u0026#34; aria-label=\u0026#34;Slide 3\u0026#34;\u0026gt;\u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;carousel-inner\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;carousel-item active\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;https://picsum.photos/1024/800?random=1\u0026#34; class=\u0026#34;d-block w-100\u0026#34; alt=\u0026#34;demo image 1\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;carousel-item\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;https://picsum.photos/1024/800?random=2\u0026#34; class=\u0026#34;d-block w-100\u0026#34; alt=\u0026#34;demo image 2\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;carousel-item\u0026#34;\u0026gt; \u0026lt;img src=\u0026#34;https://picsum.photos/1024/800?random=3\u0026#34; class=\u0026#34;d-block w-100\u0026#34; alt=\u0026#34;demo image 3\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;button class=\u0026#34;carousel-control-prev\u0026#34; type=\u0026#34;button\u0026#34; data-bs-target=\u0026#34;#carouselExampleIndicators\u0026#34; data-bs-slide=\u0026#34;prev\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;carousel-control-prev-icon\u0026#34; aria-hidden=\u0026#34;true\u0026#34;\u0026gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026#34;visually-hidden\u0026#34;\u0026gt;Previous\u0026lt;/span\u0026gt; \u0026lt;/button\u0026gt; \u0026lt;button class=\u0026#34;carousel-control-next\u0026#34; type=\u0026#34;button\u0026#34; data-bs-target=\u0026#34;#carouselExampleIndicators\u0026#34; data-bs-slide=\u0026#34;next\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;carousel-control-next-icon\u0026#34; aria-hidden=\u0026#34;true\u0026#34;\u0026gt;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026#34;visually-hidden\u0026#34;\u0026gt;Next\u0026lt;/span\u0026gt; \u0026lt;/button\u0026gt; \u0026lt;/div\u0026gt; Previous Next å°çµ ä½¿ç”¨ CDN å°±æ˜¯å¦‚æ­¤çš„æ¨¸å¯¦ç„¡è¯å¥½ä¸Šæ‰‹å‘€~\nåƒè€ƒé€£çµ Bootstrap 5 Offical ","description":"","id":27,"section":"posts","tags":["bootstrap","web"],"title":"è¦å¦‚ä½•åœ¨Hugo ä¸­ä½¿ç”¨Bootstrap ?","uri":"https://e61983.github.io/2021-07-28-using-bootstrap-with-hugo/"},{"content":"å‰è¨€ åœ¨æº–å‚™å®Œé–‹ç™¼ç’°å¢ƒä¹‹å¾Œï¼Œæ¥ä¸‹ä¾†å°±è¦é–‹å§‹åŠ ä¸Šæˆ‘å€‘çš„è¨­å®šã€æœå‹™æˆ–æ˜¯æ‡‰ç”¨äº†ã€‚\nä¸»è¦å…§å®¹ åœ¨é€²è¡Œä¸‹åˆ—æ“ä½œå‰ï¼Œæˆ‘å€‘éœ€è¦å…ˆåˆå§‹åŒ– Yocto ç’°å¢ƒï¼Œå¦‚æœé‚„ä¸çŸ¥é“è¦å¦‚ä½•é€²è¡Œçš„åŒå­¸ï¼Œå¯ä»¥åƒè€ƒé€™é‚Šã€‚\nå»ºç«‹æˆ‘å€‘çš„ \u0026ldquo;å±¤\u0026rdquo; å»ºè­°æ˜¯å°‡æˆ‘å€‘çš„ Layer æ”¾åœ¨å»ºç½®è³‡æ–™å¤¾( first-build )çš„å¤–é¢ã€‚æ‰€ä»¥æˆ‘å€‘å°‡åœ¨å®ƒçš„ä¸Šä¸€å±¤ç›®éŒ„å»ºç«‹æˆ‘å€‘çš„ Layer meta-first-layerã€‚\n1 2 3 4 cd .. ls # first-build poky bitbake-layers create-layer meta-first-layer ls # first-build meta-first-layer poky åŠ å…¥æˆ‘å€‘çš„ \u0026ldquo;å±¤\u0026rdquo; åœ¨å»ºç½®è³‡æ–™å¤¾( first-build ) ä¸­åŸ·è¡Œä¸‹åˆ—æŒ‡ä»¤ï¼Œå®ƒæœƒå¹«æˆ‘å€‘æ›´æ–° conf/bblayer.bb çš„å…§å®¹ã€‚\n1 2 cd first-build bitbake-layers add-layer ../meta-first-layer Recipes-example æˆ‘å€‘åœ¨å»ºç«‹ meta-first-layer æ™‚ï¼Œbitbake-layers æœƒé †ä¾¿å¹«æˆ‘å€‘å»ºç«‹ recipes-exampleã€‚\næˆ‘å€‘å¯ä»¥é€éä¸‹åˆ—æŒ‡ä»¤ï¼Œçœ‹åˆ°å®ƒçš„è¼¸å‡ºçµæœã€‚\n1 bitbake example åŸ·è¡Œçµæœ:\nåŸ·è¡Œçµæœ\nå»ºç«‹æˆ‘å€‘çš„ Recipes-Hello Yocto å°ˆæ¡ˆæä¾›äº†è¨±å¤šä¾¿æ·çš„å·¥å…·ï¼Œå…¶ä¸­ recipetool èˆ‡ devtool ä¾¿æ˜¯èˆ‡ Recipes è¼ƒç‚ºç›¸é—œã€‚\næ¥ä¸‹ä¾†æˆ‘å€‘å°‡æœƒä½¿ç”¨ recipetool ä¾†å»ºç«‹æˆ‘å€‘çš„ Recipesã€‚\nå»ºç«‹ recipes-hello è³‡æ–™å¤¾ï¼Œä¸¦åœ¨ files ä¸­æ”¾å…¥æˆ‘å€‘çš„æºå§‹ç¢¼ã€‚\n1 2 mkdir -p recipes-hello/hello/files cd recipes-hello/hello main.c:\n1 2 3 4 5 6 #include \u0026lt;stdio.h\u0026gt; int main(int argc, char *argv[]) { printf(\u0026#34;Hello\\n\u0026#34;); return 0; } Makefile:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 SRCS := main.c OBJS := $(SRCS:.c=.o) bindir ?= /usr/bin TARGET := hello all: $(TARGET) %.o : %.c $(CC) -c $\u0026lt; -o $@ ${LDFLAGS} $(TARGET) : $(OBJS) $(CC) $^ -o $@ ${LDFLAGS} install: install -d $(DESTDIR)$(bindir) install -m 755 $(TARGET) $(DESTDIR)$(bindir)/ ä½¿ç”¨ recipetool å»ºç«‹ recipe\n1 recipetool create -o hello_0.1.bb files ä¿®æ”¹ç”¢ç”Ÿå‡ºçš„ hello_0.1.bb\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 LICENSE = \u0026#34;CLOSED\u0026#34; LIC_FILES_CHKSUM = \u0026#34;\u0026#34; SRC_URI = \u0026#34; \\ file://main.c \\ file://Makefile \\ \u0026#34; S = \u0026#34;${WORKDIR}\u0026#34; do_configure () { } do_compile () { oe_runmake } do_install () { oe_runmake install \u0026#39;DESTDIR=${D}\u0026#39; } å›åˆ° first-build é€²è¡Œæ¸¬è©¦\n1 bitbake hello å¯ä»¥æ­£å¸¸çš„é€²è¡Œç·¨è­¯ï¼Œä½†åœ¨æœ€å¾Œå‡ºç¾äº†å•é¡Œã€‚\nERROR: hello-0.1-r0 do_package_qa: QA Issue: File /usr/bin/hello in package hello doesn\u0026rsquo;t have GNU_HASH (didn\u0026rsquo;t pass LDFLAGS?) [ldflags]\nERROR: hello-0.1-r0 do_package_qa: QA run found fatal errors. Please consider fixing them.\nERROR: Logfile of failure stored in: /home/yuan/first-build/tmp/work/cortexa7t2hf-neon-vfpv4-poky-linux-gnueabi/hello/0.1-r0/temp/log.do_package_qa.2726283\nERROR: Task (/home/yuan/meta-first-layer/recipes-hello/hello/hello_0.1.bb:do_package_qa) failed with exit code \u0026lsquo;1\u0026rsquo; åƒè€ƒé€™ç¯‡æ–‡ç« \u0008ä¿®æ”¹ hello_0.1.bb\n1 2 3 4 5 6 do_install () { oe_runmake install \u0026#39;DESTDIR=${D}\u0026#39; } + + INSANE_SKIP_${PN} = \u0026#34;ldflags\u0026#34; + INSANE_SKIP_${PN}-dev = \u0026#34;ldflags\u0026#34; å»ºç«‹æˆ‘å€‘çš„ image åœ¨ recipes-hello ä¸­å»ºç«‹ images è³‡æ–™å¤¾ã€‚\n1 2 3 mkdir -p recipes-hello/images cd recipes-hello/images cp ../../../poky/meta/recipes-core/images/core-image-minimal.bb hello-image.bb hello-image.bb:\n1 2 3 4 5 6 7 8 9 10 SUMMARY = \u0026#34;A hello image that just for testing our layer\u0026#34; LICENSE = \u0026#34;MIT\u0026#34; IMAGE_INSTALL = \u0026#34;packagegroup-core-boot ${CORE_IMAGE_EXTRA_INSTALL} hello\u0026#34; inherit core-image IMAGE_ROOTFS_SIZE ?= \u0026#34;8192\u0026#34; IMAGE_ROOTFS_EXTRA_SPACE_append = \u0026#34;${@bb.utils.contains(\u0026#34;DISTRO_FEATURES\u0026#34;, \u0026#34;systemd\u0026#34;, \u0026#34; + 4096\u0026#34;, \u0026#34;\u0026#34; ,d)}\u0026#34; å›åˆ° first-build é€²è¡Œæ¸¬è©¦\n1 2 bitbake hello-image runqemu hello-image nographic slirp å¦ä¸€å€‹å»ºç«‹ Recipes-hello çš„æ–¹æ³• åœ¨å·¥ä½œç›®éŒ„ ( first-build ) ä½¿ç”¨ devtool åŠ å…¥æˆ‘å€‘å¯«å¥½çš„ hello è‡³ å·¥ä½œç›®éŒ„ä¸­ã€‚\n1 devtool add hello ../hello é€™å€‹å‹•ä½œæœƒå¹«æˆ‘å€‘åœ¨ conf/bblayer.bb ä¸­åŠ å…¥ workspace å±¤ï¼Œä¸¦å»ºç«‹ workspace/recipes/hello è³‡æ–™å¤¾ã€‚\nä½¿ç”¨ä¸‹åˆ—æŒ‡ä»¤ç·¨è­¯ hello\n1 2 devtool build hello ls å¯ä»¥ç™¼ç¾å®ƒç¢ºå¯¦å¤šäº† Workspace Layer\nä½¿ç”¨ devtool å»ºç«‹è‡¨æ™‚æ¸¬è©¦ç”¨çš„ imageï¼Œä¸¦ä½¿ç”¨ qemu é€²è¡Œé©—è­‰ã€‚\n1 2 devtool build-image core-image-minimal runqemu core-image-minimal nographic slirp åœ¨æ¸¬è©¦æ²’æœ‰å•é¡Œä¹‹å¾Œï¼Œå†ä½¿ç”¨ devtool å°‡ hello åŠ å…¥æˆ‘å€‘çš„ Layer\n1 devtool finish hello ../meta-first-layer å°çµ æˆ‘å€‘å·²ç¶“å»ºç«‹äº†è‡ªå·±çš„ Layerã€Recipe ä»¥åŠ Imageã€‚ æ¥ä¸‹ä¾†æˆ‘å€‘å°±å¯ä»¥è©¦è‘—å»ºç«‹å±¬æ–¼æˆ‘å€‘çš„ Distribution å’Œ Machine äº†ã€‚\nåƒè€ƒé€£çµ Building your own recipes from first principles How to fix : ERROR: do_package_qa: QA Issue: No GNU_HASH in the elf binary Devtool Reference Yocto Manual ","description":"","id":28,"section":"posts","tags":["yocto"],"title":"Yocto First Layer","uri":"https://e61983.github.io/2021-07-28-yocto-first-layer/"},{"content":"å‰è¨€ å…ˆå‰æœ‰æ¥è§¸é buildroot é€™é¡çš„ Linux Distribution å·¥å…·ï¼Œä½†ä¸€ç›´æ²’æœ‰å¥½å¥½çš„æ•´ç†èµ·ä¾†ã€‚\næœ€è¿‘å‰›å¥½æœ‰æ©Ÿæœƒæ¥è§¸ Yoctoï¼Œæ‰“ç®—åœ¨æ‘¸ç´¢çš„éç¨‹ä¸­ä¸€ä¸¦è¨˜éŒ„èµ·ä¾†ã€‚\nä¸»è¦å…§å®¹ Yocto å°ˆæ¡ˆ æœ‰é—œæ–¼ Yocto å°ˆæ¡ˆçš„æ­´å²å°±ä¸å¤šåšä»‹ç´¹äº†ï¼Œæœ‰èˆˆè¶£çš„åŒå­¸å¯ä»¥åˆ°å®ƒçš„å®˜ç¶²çœ‹çœ‹ã€‚\nYocto å®˜ç¶²ç•«é¢\nåŸºæœ¬è§€å¿µ Yocto é–‹ç™¼æµç¨‹\nMachine ç›¸é—œçš„é…ç½®æœƒæ”¾åœ¨ conf/machine/ ä¸­ã€‚å®ƒç”¨ä¾†æè¿°èˆ‡ç¡¬é«”æœ‰é—œçš„é…ç½®ã€‚é€šå¸¸åŒ…å«: Kernelã€Devices Treeã€Bootloaderã€‚\nDistrobution ç›¸é—œçš„é…ç½®æœƒæ”¾åœ¨ conf/distro/ ä¸­ã€‚å®ƒä½œç‚ºæ•´å€‹é…ç½®ä¸­æœ€åº•å±¤çš„éƒ¨ä»½ã€‚æ¥ä¸‹ä¾†çš„ Layer éƒ½æœƒä»¥æ­¤ç‚ºåŸºç¤å¾€ä¸Šç–ŠåŠ ã€‚é€šå¸¸å®ƒä¹Ÿè¨‚å®šäº†æ­¤ç³»çµ±çš„ ABI ã€‚\nImage ç›¸é—œçš„é…ç½®æœƒæ”¾åœ¨ recipes-*/images/ ä¸­ã€‚å®ƒå°±æ˜¯ rootfsã€‚\nLayer æ˜¯ç”± Recipe æ‰€çµ„æˆï¼Œæ ¹æ“šä¸åŒç”¨é€”å¯ä»¥å®šç¾©å‡ºBSP Layer, General Layerã€‚\nä¸€èˆ¬ä¾†èªªæˆ‘å€‘æœƒä»¥ meta- é–‹é ­ä½œç‚º Layer çš„å‘½åã€‚\nRecipe æ˜¯ç”±ä¸€ç³»åˆ—å»ºæ§‹ Package çš„æŒ‡ä»¤æ‰€çµ„æˆã€‚æè¿°äº† Package è©²å¦‚ä½•å–å¾—æºå§‹ç¢¼ã€å¦‚ä½•é€²è¡Œé…ç½®ã€å¦‚ä½•é€²è¡Œç·¨è­¯ä»¥åŠå®‰è£çš„æ­¥é©Ÿã€‚\nPackage åœ¨ Yocto ä¸­ Package æ˜¯ä»£è¡¨ Recipe çš„åŸ·è¡Œçµæœã€‚\nå»ºç«‹ Yocto ç’°å¢ƒ ä¸‹è¼‰ Pokyã€‚\nç­‰ä¸€ä¸‹\u0026hellip; æ€éº¼çªç„¶å°±å†’ä¸€å€‹ poky å‡ºä¾†\né€™å€‹å°±å…ˆè«‹åŒå­¸è‡ªè¡Œå» Yocto çš„å®˜ç¶²çœ‹äº†\n1 2 mkdir yocto \u0026amp;\u0026amp; cd yocto git clone git://git.yoctoproject.org/poky.git è¼¸å…¥ä¸‹åˆ—æŒ‡ä»¤åˆå§‹åŒ–ç’°å¢ƒï¼Œå®ƒæœƒå¹«æˆ‘å€‘å»ºç«‹ first-build è³‡æ–™å¤¾ã€‚ä¸¦è¨­ç½®å¥½ç›¸é—œçš„ç’°å¢ƒè®Šæ•¸ã€‚\n1 source poky/oe-init-build-env first-build é–‹å§‹ç¬¬ä¸€å€‹å°ˆæ¡ˆ è¼¸å…¥ä¸‹åˆ—æŒ‡ä»¤ï¼Œå°±æœƒé–‹å§‹é€²è¡Œç·¨è­¯äº†ã€‚\n1 \u0008bitbake core-image-miminal ä¾ç…§ç¶²è·¯ç’°å¢ƒã€ç·¨è­¯ä¸»æ©Ÿçš„ä¸åŒï¼ŒåŸ·è¡Œçš„æ™‚é–“æœƒæœ‰æ‰€ä¸åŒã€‚ä½†ç¬¬ä¸€æ¬¡éƒ½è¦è »ä¹…çš„å°±æ˜¯äº†ã€‚ åœ¨ç·¨è­¯å®Œæˆä¹‹å¾Œï¼Œä½¿ç”¨ qemu ä¾†çœ‹çœ‹æˆæœã€‚\n1 runqemu qemuarm core-image-miminal nographic slirp ä½¿ç”¨ root ç™»å…¥\nç™»å…¥ç•«é¢\nå°çµ æœ¬æ–‡è¨˜éŒ„äº† Yocto é–‹ç™¼æ™‚æœƒéœ€è¦çŸ¥é“çš„åŸºæ¥šè³‡è¨Šï¼Œæœªä¾†åœ¨é–‹ç™¼æ™‚ï¼Œæœ‰ç™¼ç¾ä¸è¶³çš„éƒ¨ä»½æœƒå†æŒçºŒçš„è£œå……ã€‚\nåƒè€ƒé€£çµ Yocto Official Bootlin - Introduction to Yocto project ","description":"","id":29,"section":"posts","tags":["yocto","linux"],"title":"Yocto åŸºç¤ä»‹ç´¹","uri":"https://e61983.github.io/2021-07-27-yocto-introduction/"},{"content":"å‰è¨€ æ‰‹é‚Šæœ‰ä¸€ç‰‡å¾ˆä¹…æ²’æœ‰å‹•éçš„ Raspberry Pi 3 B+ã€‚å‰›å¥½æœ€è¿‘å·¥ä½œä¸Šéœ€è¦åœ¨ imx8 é€²è¡Œé–‹ç™¼ã€‚è—‰æ­¤é †ä¾¿å…ˆç·´ç·´æ‰‹ã€‚\nä¸»è¦å…§å®¹ æº–å‚™ Yocto ç’°å¢ƒ å»ºç«‹æˆ‘å€‘è¦é–‹ç™¼çš„è³‡æ–™å¤¾ my-rpiï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘éƒ½æœƒåœ¨é€™å€‹è³‡æ–™å¤¾ä¸­é€²è¡Œæ“ä½œã€‚ ä¸‹è¼‰ poky ã€‚ 1 2 mkdir my-rpi \u0026amp;\u0026amp; cd my-rpi git clone -b hardknott git://git.yoctoproject.org/poky.git æº–å‚™ meta-raspberrypi å±¤\n1 git clone -b hardknott git://git.yoctoproject.org/meta-raspberrypi åˆå§‹åŒ–é–‹ç™¼ç’°å¢ƒ\n1 source poky/oe-init-build-env build-rpi åŠ å…¥ meta-raspibary å±¤\n1 bitbake-layers add-layer ../meta-raspberrypi ä¿®æ”¹é…ç½® 1 2 3 4 5 6 sed -i \u0026#39;s/^MACHINE.*/MACHINE ?= \u0026#34;raspberrypi3\u0026#34;/g\u0026#39; conf/local.conf sed -i \u0026#39;/^#DL_DIR ?= \u0026#34;${TOPDIR}\\/downloads\u0026#34;/ a DL_DIR ?= \\\u0026#34;${HOME}/yocto/downloads\u0026#34;\u0026#39; conf/local.conf sed -i \u0026#39;s/^PACKAGE_CLASSES.*/PACKAGE_CLASSES ?= \u0026#34;package_ipk\u0026#34;/g\u0026#39; conf/local.conf echo \u0026#39;RPI_USE_U_BOOT = \u0026#34;1\u0026#34;\u0026#39; \u0026gt;\u0026gt; conf/local.conf echo \u0026#39;ENABLE_UART = \u0026#34;1\u0026#34;\u0026#39; \u0026gt;\u0026gt; conf/local.conf é–‹å§‹ç·¨è­¯ 1 bitbake core-image-minimal å¯«å…¥ SD Card 1 2 bzip -Dk core-image-minimal-raspberrypi3.wic.bz2 sudo dd if=core-image-minimal-raspberrypi3.wic of=${SD_CARD} bs=40960 å°çµ ç·¨è­¯å‡ºä¾†çš„ç³»çµ±å·²å¯ä»¥é–‹å§‹ï¼Œä¸¦åœ¨UART çµ‚ç«¯æ©Ÿçœ‹åˆ°é–‹å§‹æ™‚çš„è¼¸å‡ºï¼Œä»¥åŠå¯ä»¥ä½¿ç”¨root é€²å…¥ç³»çµ±ã€‚\nåƒè€ƒé€£çµ Yocto official meta-raspberrypi Building Raspberry Pi Systems with Yocto ","description":"","id":30,"section":"posts","tags":["linux","yocto"],"title":"ä½¿ç”¨ Yocto æ‰“é€ ä½ çš„ Raspberry Pi ç³»çµ±","uri":"https://e61983.github.io/2021-07-26-building-raspberry-pi-systems-with-yocto/"},{"content":"å‰è¨€ ä»¥å‰æœ‰ä½¿ç”¨é hexo å»ºç«‹Blogï¼Œä½†ä¸€ç›´æ²’æœ‰å¥½å¥½çš„ç¶“ç‡Ÿã€‚æœ€è¿‘åˆæœ‰æƒ³è¦é–‹å§‹å¯« Blog çš„å¿µé ­ã€‚\nå¸Œæœ›é€™ä¸€æ¬¡ï¼Œå¯ä»¥æŒçºŒæ’°å¯«ä¸‹å»ã€‚\nä¸»è¦å…§å®¹ ç”±æ–¼ç­†è€…æ˜¯ä½¿ç”¨ MacBook ä½œç‚ºæ—¥å¸¸ä½¿ç”¨çš„å·¥å…·ï¼Œæ‰€ä»¥æœ¬æ–‡å°‡ä»¥ Mac ç’°å¢ƒé€²è¡Œç­†è¨˜ã€‚\nå®‰è£ Hugo 1 brew install hugo å»ºç«‹ç¶²ç«™ 1 hugo new ${SITE_NAME} æ’°å¯«æ–‡ç«  1 2 cd ${SITE_NAME} hugo new posts/my-first-post.md è¨­å®šä½ˆæ™¯ä¸»é¡Œ 1 2 git submodule add https://github.com/upagge/uBlogger.git themes/uBlogger echo \u0026#39;theme = \u0026#34;uBlogger\u0026#34;\u0026#39; \u0026gt;\u0026gt; config.toml ä¿®æ”¹æ¨£å¼ å»ºç«‹ç›¸é—œè³‡æ–™å¤¾\n1 mkdir -p assets/css/ åŠ å…¥è‡ªè¨‚æ¨£å¼\n1 2 3 4 code[class*=\u0026#34;language-\u0026#34;] { color: white; text-shadow: none; } å°çµ é€™æ¬¡åªæœ‰é€²è¡Œç°¡æ˜“çš„è¨­å®šï¼Œé‚„æœ‰è¨±å¤šåŠŸèƒ½é‚„æœªæ¢ç´¢ã€‚ç›®å‰æ‰“ç®—å…ˆç”¨ä¸€é™£å­ï¼Œå†çœ‹çœ‹é‚„æœ‰ä»€éº¼æœ‰è¶£çš„æ±è¥¿ã€‚\nåƒè€ƒé€£çµ uBlogger offical website ç¬¬ 12 å±† iT é‚¦å¹«å¿™éµäººè³½ - Hugo è²¼èº«æ‰“é€ å€‹äººéƒ¨è½æ ¼ ç³»åˆ— ","description":"","id":31,"section":"posts","tags":["go","web","markdown"],"title":"æ‰“é€ è‡ªå·±çš„Blog","uri":"https://e61983.github.io/2021-07-26-first-hugo-website/"},{"content":"å‰è¨€ ä½¿ GNU LD è¼¸å‡ºç¸½å…±ä½¿ç”¨çš„è¨˜æ†¶é«”å¤§å°èˆ‡ç¨‹å¼å¤§å°ã€‚\nä¸»è¦å…§å®¹ Makefile:\nLDFLAGS += -Wl,--print-memory-usage åƒè€ƒé€£çµ GNU LD - command options ","description":"","id":32,"section":"posts","tags":["linker"],"title":"GNU LD print memory usage","uri":"https://e61983.github.io/2018-02-06-ld-print-memory-usage/"},{"content":"å‰è¨€ Generic åœ¨C11ä¸Šå‡ºç¾ï¼Œæˆ‘å€‘å¯ä»¥é€éå¯¦ä½œå‡ºç‰©ä»¶å°å‘ä¸­çš„å¤šå‹ã€‚è¦æ³¨æ„çš„æ˜¯ Generic æ˜¯åœ¨ç·¨è­¯æ™‚æœŸé‹ä½œçš„ã€‚\nä¸»è¦å…§å®¹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 #include \u0026lt;stdio.h\u0026gt; void funci(int x) { printf(\u0026#34;func value = %d\\n\u0026#34;, x); } void funcc(char c) { printf(\u0026#34;func char = %c\\n\u0026#34;, c); } void funcdef(double v) { printf(\u0026#34;Def func\u0026#39;s value = %lf\\n\u0026#34;, v); } #define func(X) \\ _Generic((X), \\ int: funci, char: funcc, default: funcdef \\ )(X) int main() { func(1); func(\u0026#39;a\u0026#39;); func(1.3); return 0; } åœ¨å¤šå€‹åƒæ•¸çš„ä½¿ç”¨ä¸Šæ¯”è¼ƒç¹ç‘£ï¼Œéœ€è¦è‡ªè¡Œä½œæ¯å€‹åƒæ•¸çš„çµ„åˆã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 #define format2(x,y) _Generic((x), \\ char: _Generic((y), \\ char:\u0026#34;%c - %c\\n\u0026#34;, \\ char*:\u0026#34;%c - %s\\n\u0026#34;, \\ int:\u0026#34;%c - %d\\n\u0026#34;, \\ default:\u0026#34;error\\n\u0026#34; \\ ), \\ char*: _Generic((y), \\ char:\u0026#34;%s - %c\\n\u0026#34;, \\ char*:\u0026#34;%s - %s\\n\u0026#34;, \\ int:\u0026#34;%s - %d\\n\u0026#34;, \\ default:\u0026#34;error\\n\u0026#34; \\ ), \\ int: _Generic((y), \\ char:\u0026#34;%d - %c\\n\u0026#34;, \\ char*:\u0026#34;%d - %s\\n\u0026#34;, \\ int:\u0026#34;%d - %d\\n\u0026#34;, \\ default:\u0026#34;error\\n\u0026#34; \\ ), \\ default:\u0026#34;error\\n\u0026#34; \\ ) #define print2(x, y) printf(format2(x,y),x,y) int main(int argc, char **argv) { printf(\u0026#34;test 2 parameters\\n\u0026#34;); print2(3, \u0026#39;c\u0026#39;); return 0; } ","description":"","id":33,"section":"posts","tags":["c11"],"title":"C11 Generic Selections","uri":"https://e61983.github.io/2017-10-18-c11-generic-selections/"}]